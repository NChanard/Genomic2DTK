[{"path":"/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2022 Genomic2DTK authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":[]},{"path":"/articles/Genomic2DTK.html","id":"installation","dir":"Articles","previous_headings":"Firsts Steps","what":"Installation","title":"Introduction to Genomic2DTK","text":"","code":"devtools::install_github(\"Nchanard/Genomic2DTK\")"},{"path":"/articles/Genomic2DTK.html","id":"dependencies","dir":"Articles","previous_headings":"Firsts Steps","what":"Dependencies","title":"Introduction to Genomic2DTK","text":"BiocGenerics, DataTK, DevTK, doParallel, dplyr, GenomeInfoDb, GenomicRanges, GenomicTK, InteractionSet, IRanges, magrittr, Matrix, methods, parallel, plyr, S4Vectors, stats, stringr, tibble, tidyr, tidyselect","code":""},{"path":[]},{"path":"/articles/Genomic2DTK.html","id":"library","dir":"Articles","previous_headings":"Loads","what":"Library","title":"Introduction to Genomic2DTK","text":"","code":"library(Genomic2DTK) library(GenomicED)"},{"path":"/articles/Genomic2DTK.html","id":"data","dir":"Articles","previous_headings":"Loads","what":"Data","title":"Introduction to Genomic2DTK","text":"load testing data sequencing Drosophila Melanogaster chromosomes 2L 2R.","code":""},{"path":"/articles/Genomic2DTK.html","id":"hic_ctrl-gnp","dir":"Articles","previous_headings":"Loads > Data","what":"HiC_ctrl.gnp","title":"Introduction to Genomic2DTK","text":"HiC data control condition (depletion Luc protein) Pairs GRanges (bedpe) format 1KBp resolution.","code":"data(\"HiC_ctrl.gnp\")"},{"path":"/articles/Genomic2DTK.html","id":"hic-gnp","dir":"Articles","previous_headings":"Loads > Data","what":"HiC.gnp","title":"Introduction to Genomic2DTK","text":"HiC data Beaf-32 depletion condition Pairs GRanges (bedpe) format 1Kbp resolution.","code":"data(\"HiC.gnp\")"},{"path":"/articles/Genomic2DTK.html","id":"granges-gnr","dir":"Articles","previous_headings":"Loads > Data","what":"GRanges.gnr","title":"Introduction to Genomic2DTK","text":"ChIPseq data Beaf-32 protein wild type condition GRanges format (bed).","code":"data(\"GRanges.gnr\")"},{"path":"/articles/Genomic2DTK.html","id":"tad-gnr","dir":"Articles","previous_headings":"Loads > Data","what":"Tad.gnr","title":"Introduction to Genomic2DTK","text":"Data TAD calling HIC data wild type (F. Ramirez, 2018).","code":"data(\"Tad.gnr\")"},{"path":"/articles/Genomic2DTK.html","id":"tss-gnr","dir":"Articles","previous_headings":"Loads > Data","what":"Tss.gnr","title":"Introduction to Genomic2DTK","text":"Data UCSC data base.","code":"data(\"Tss.gnr\")"},{"path":"/articles/Genomic2DTK.html","id":"genomic-informations","dir":"Articles","previous_headings":"Loads","what":"Genomic Informations","title":"Introduction to Genomic2DTK","text":"complete data 2L 2R chromosome sizes HiC map resolution.","code":"seqlengths.num <- c('2L'=23513712, '2R'=25286936) chromSize.dtf <- data.frame(   seqnames=names(seqlengths.num ),    seqlengths=seqlengths.num   ) binSize.num <- 1000"},{"path":[]},{"path":"/articles/Genomic2DTK.html","id":"hic-control","dir":"Articles","previous_headings":"Convert HiC bedpe","what":"HiC Control","title":"Introduction to Genomic2DTK","text":"","code":"HiC_ctrl.cmx_lst <- GnpToCm(   hic.gnp       = HiC_ctrl.gnp,   res.num       = binSize.num,   chromSize.dtf = chromSize.dtf,   cores.num     = 1,   verbose.bln   = FALSE   )"},{"path":"/articles/Genomic2DTK.html","id":"hic-under-beaf-depletion","dir":"Articles","previous_headings":"Convert HiC bedpe","what":"HiC under Beaf depletion","title":"Introduction to Genomic2DTK","text":"","code":"HiC.cmx_lst  <- GnpToCm(   hic.gnp       = HiC.gnp,   res.num       = binSize.num,   chromSize.dtf = chromSize.dtf,   cores.num     = 1,   verbose.bln   = FALSE   )"},{"path":"/articles/Genomic2DTK.html","id":"understand-results","dir":"Articles","previous_headings":"Convert HiC bedpe","what":"Understand results","title":"Introduction to Genomic2DTK","text":"result named list Contactmatrix object matrix dgCMatrix object (sparse matrix). element list corresponds interaction two sequences (chromosomes). name element corresponds names two sequences. exemple, element named 2L_2R correspond interaction 2L 2R sequences. See InteractionSet package details ContactMatrix objects see Matrix package details sparse matrices formats. element name 2L_2R , Bin make 2L 2R sequences represented contact map (sparse matrix) lines columns respectively. list attributes. element metadata. resolution : resolution HiC map. seqnames : sequence name (chromosome name). seqlengths : sequence length base pairs. dimension : sequence length base bins name : matrix name. type : interaction kind. “Cis” interactions sequence “Trans” interactions different sequences. kind : matrix kind. U upper triangle matrices, L lower triangle matrices, NA rectangular square matrices. See symmetric : boolean indicates whether matrix symmetric (lower triangle identical upper triangle).","code":"HiC_ctrl.cmx_lst[1:2] #> $`2L_2L` #> class: ContactMatrix  #> dim: 23514 23514  #> type: dgCMatrix  #> rownames: NULL #> colnames: NULL #> metadata(5): name type kind symmetric resolution #> regions: 23514 #>  #> $`2R_2R` #> class: ContactMatrix  #> dim: 25287 25287  #> type: dgCMatrix  #> rownames: NULL #> colnames: NULL #> metadata(5): name type kind symmetric resolution #> regions: 25287 #> class(HiC_ctrl.cmx_lst[[\"2L_2L\"]]@matrix) #> [1] \"dgCMatrix\" #> attr(,\"package\") #> [1] \"Matrix\" #> HiC_ctrl.cmx_lst[[\"2L_2L\"]]@matrix %>% str #> Formal class 'dgCMatrix' [package \"Matrix\"] with 6 slots #>   ..@ i       : int [1:617185] 73 74 75 75 74 77 78 78 79 73 ... #>   ..@ p       : int [1:23515] 0 0 0 0 0 0 0 0 0 0 ... #>   ..@ Dim     : int [1:2] 23514 23514 #>   ..@ Dimnames:List of 2 #>   .. ..$ : NULL #>   .. ..$ : NULL #>   ..@ x       : num [1:617185] 0.899 1.772 1.729 2.185 2.752 ... #>   ..@ factors : list() #> HiC_ctrl.cmx_lst$[[\"2L_2L\"]]@matrix[6:15,6:15] attributes(HiC_ctrl.cmx_lst) #> $names #> [1] \"2L_2L\" \"2R_2R\" #>  #> $resolution #> [1] 1000 #>  #> $chromSize #> # A tibble: 2 × 3 #>   seqnames seqlengths dimension #>   <chr>         <dbl>     <dbl> #> 1 2L         23513712     23514 #> 2 2R         25286936     25287 #>  #> $matricesKind #> # A tibble: 2 × 4 #>   name  type  kind  symmetric #>   <chr> <chr> <chr> <lgl>     #> 1 2L_2L cis   U     TRUE      #> 2 2R_2R cis   U     TRUE #> S4Vectors::metadata(HiC_ctrl.cmx_lst[[\"2L_2L\"]]) #> $name #> [1] \"2L_2L\" #>  #> $type #> [1] \"cis\" #>  #> $kind #> [1] \"U\" #>  #> $symmetric #> [1] TRUE #>  #> $resolution #> [1] 1000 #>"},{"path":[]},{"path":"/articles/Genomic2DTK.html","id":"tips","dir":"Articles","previous_headings":"Genomic Features Indexing","what":"Tips","title":"Introduction to Genomic2DTK","text":"Put GRanges list allow name features. name feature “Beaf”. regions constraint used, chromosomes used constraints. multiples ranges bin can choose variables (variablesName.chr_vec) summary function (method.chr).","code":""},{"path":[]},{"path":"/articles/Genomic2DTK.html","id":"beaf","dir":"Articles","previous_headings":"Genomic Features Indexing > Indexing","what":"Beaf","title":"Introduction to Genomic2DTK","text":"","code":"Beaf.gnr_ndx <- IndexFeatures(   gRange.gnr_lst        = list(Beaf=GRanges.gnr),    constraint.gnr        = Tad.gnr,                   chromSize.dtf         = chromSize.dtf,   binSize.int           = binSize.num,   method.chr            = \"max\",   variablesName.chr_vec = \"score\",   cores.num             = 1,   verbose.bln           = FALSE   )"},{"path":"/articles/Genomic2DTK.html","id":"tss-transcription-starting-sites","dir":"Articles","previous_headings":"Genomic Features Indexing > Indexing","what":"TSS (Transcription Starting Sites)","title":"Introduction to Genomic2DTK","text":"","code":"Tss.gnr_ndx <- IndexFeatures(   gRange.gnr_lst        = list(Tss=Tss.gnr),   constraint.gnr        = Tad.gnr,   chromSize.dtf         = chromSize.dtf,   binSize.int           = binSize.num,   method.chr            = \"max\",   variablesName.chr_vec = \"score\",   cores.num             = 1,   verbose.bln           = FALSE    ) TssNoBeaf.ndx <- DevTK::NotIn(Tss.gnr_ndx$bin,Beaf.gnr_ndx$bin) TssNoBeaf.gnr_ndx <- Tss.gnr_ndx[TssNoBeaf.ndx,]"},{"path":[]},{"path":"/articles/Genomic2DTK.html","id":"tips-1","dir":"Articles","previous_headings":"Search Pairs","what":"Tips","title":"Introduction to Genomic2DTK","text":"indexBait.gnr NULL function considers equal indexAnchor.gnr. search pairs feature certain distances. selection can also made resulting GInteraction object FilterInteraction function.","code":""},{"path":"/articles/Genomic2DTK.html","id":"pairing","dir":"Articles","previous_headings":"Search Pairs","what":"Pairing","title":"Introduction to Genomic2DTK","text":"Now two genomic features indexed genome want search putative Beaf-TSS pairs share constraint (.e: Tad). first element pair (beaf) called Anchors second one (TSS) called Bait. pair always order Anchors-Bait (B).","code":"Beaf_VS_TssNoBeaf.gni <- SearchPairs(     indexAnchor.gnr = Beaf.gnr_ndx,     indexBait.gnr   = TssNoBeaf.gnr_ndx,     minDist.num     = NULL,      maxDist.num     = NULL,     cores.num       = 1,     verbose.bln     = FALSE     )"},{"path":[]},{"path":"/articles/Genomic2DTK.html","id":"tips-2","dir":"Articles","previous_headings":"Extractions","what":"Tips","title":"Introduction to Genomic2DTK","text":"res.num null, function find resolution attribute hic.cmx_lst. feature.gn ranges overlap just one Bin, .e start end GRanges first second element GInteraction (GRanges Pairs) bin, reference point automatically \"pf\".","code":""},{"path":"/articles/Genomic2DTK.html","id":"genomic-regions-or-domains","dir":"Articles","previous_headings":"Extractions","what":"Genomic Regions or Domains","title":"Introduction to Genomic2DTK","text":"HiC map, genomic region defined square (triangle matrice triangular) along diagonal Map, resulting extraction square matrices diagonal diagonal HiC map. regions length, extracted matrices dimensions. extracted matrices therefore resized function.","code":""},{"path":"/articles/Genomic2DTK.html","id":"regions-defined-with-ginteraction-object-or-pairs-granges","dir":"Articles","previous_headings":"Extractions > Genomic Regions or Domains","what":"Regions defined with GInteraction object or Pairs GRanges","title":"Introduction to Genomic2DTK","text":"region’s start defined center first element region’s end center second element.","code":"Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst  <- ExtractSubmatrix(   feature.gn         = Beaf_VS_TssNoBeaf.gni,   hic.cmx_lst        = HiC_ctrl.cmx_lst,   res.num            = NULL,    referencePoint.chr = \"rf\",   matriceDim.num     = 101,   cores.num          = 1,   verbose.bln        = FALSE   )"},{"path":"/articles/Genomic2DTK.html","id":"regions-defined-with-granges","dir":"Articles","previous_headings":"Extractions > Genomic Regions or Domains","what":"Regions defined with GRanges","title":"Introduction to Genomic2DTK","text":"regions directly defined ranges GRanges object.","code":"Regions_Tad_ctrl.mtx_lst <- ExtractSubmatrix(   feature.gn         = Tad.gnr,   hic.cmx_lst        = HiC_ctrl.cmx_lst,   referencePoint.chr = \"rf\",   matriceDim.num     = 101,   cores.num          = 1,   verbose.bln        = FALSE   )"},{"path":"/articles/Genomic2DTK.html","id":"long-range-interactions","dir":"Articles","previous_headings":"Extractions","what":"Long range interactions","title":"Introduction to Genomic2DTK","text":"move away diagonal HiC map access long range interactions can extract less distant surrounding interactions resulting extraction square matrices centred long range interactions.","code":""},{"path":"/articles/Genomic2DTK.html","id":"interactions-defined-with-ginteraction-or-pairs-granges-","dir":"Articles","previous_headings":"Extractions > Long range interactions","what":"Interactions defined with GInteraction or Pairs GRanges.","title":"Introduction to Genomic2DTK","text":"extracted matrices, middle Y axis correspond center first element interact center second element middle X axis.","code":"Points_Beaf_VS_TssNoBeaf_ctrl.mtx_lst <- ExtractSubmatrix(   feature.gn         = Beaf_VS_TssNoBeaf.gni,   hic.cmx_lst        = HiC_ctrl.cmx_lst,   referencePoint.chr = \"pf\",   matriceDim.num     = 41,   cores.num          = 1,   verbose.bln        = FALSE   )"},{"path":"/articles/Genomic2DTK.html","id":"interactions-defined-with-granges-","dir":"Articles","previous_headings":"Extractions > Long range interactions","what":"Interactions defined with GRanges.","title":"Introduction to Genomic2DTK","text":"middle Y axis correspond start range interact middle X axis correspond ends ranges.","code":"Points_Tad_ctrl.mtx_lst <- ExtractSubmatrix(   feature.gn         = Tad.gnr,   hic.cmx_lst        = HiC_ctrl.cmx_lst,   referencePoint.chr = \"pf\",   matriceDim.num     = 41,   cores.num          = 1,   verbose.bln        = FALSE   )"},{"path":"/articles/Genomic2DTK.html","id":"ponctual-interactions-along-diagonal-","dir":"Articles","previous_headings":"Extractions","what":"Ponctual interactions along diagonal.","title":"Introduction to Genomic2DTK","text":"want extract fixed windows along diagonal center points (Bins).","code":""},{"path":"/articles/Genomic2DTK.html","id":"define-ponctual-interactions-","dir":"Articles","previous_headings":"Extractions > Ponctual interactions along diagonal.","what":"Define ponctual interactions.","title":"Introduction to Genomic2DTK","text":"First, want create objects points interaction along diagonal. exemple achieve take TAD borders. width ranges put 1 force start end ranges bin. Probably end TADs found next beginning TADs. words, genomic locations found bin.       see conserve metadata Bin 2L:95 Tad_1 Tad_2.    addition, Tad_1 Bin 2L:74 2L:95, need put unique name ranges (=bin) keep Tad names new variables.","code":"tad_Border.gnr <- c(     GenomicRanges::resize(Tad.gnr, 1, \"start\"),     GenomicRanges::resize(Tad.gnr, 1,  \"end\" ) ) %>% sort(.) tad_Border.gnr GenomicRanges::reduce(tad_Border.gnr) tad_Border_Binnned.gnr <- GenomicTK::BinGRanges(   gRange.gnr  = tad_Border.gnr,   binSize.int = binSize.num,   verbose.bln = FALSE   ) tad_Border_Binnned.gnr tad_Border_Binnned.gnr$subname <- tad_Border_Binnned.gnr$name tad_Border_Binnned.gnr$name    <- tad_Border_Binnned.gnr$bin tad_Border_Binnned.gni <- InteractionSet::GInteractions(tad_Border_Binnned.gnr,tad_Border_Binnned.gnr)"},{"path":"/articles/Genomic2DTK.html","id":"ponctual-interactions-defined-with-granges","dir":"Articles","previous_headings":"Extractions > Ponctual interactions along diagonal.","what":"Ponctual interactions defined with GRanges","title":"Introduction to Genomic2DTK","text":"start end ranges bin.","code":"Points_Tad_Border_ctrl.mtx_lst <- ExtractSubmatrix(   feature.gn         = tad_Border_Binnned.gnr,   hic.cmx_lst        = HiC_ctrl.cmx_lst,   referencePoint.chr = \"pf\",   matriceDim.num     = 101,   verbose.bln        = FALSE )"},{"path":"/articles/Genomic2DTK.html","id":"ponctual-interactions-defined-with-ginteractions","dir":"Articles","previous_headings":"Extractions > Ponctual interactions along diagonal.","what":"Ponctual interactions defined with GInteractions","title":"Introduction to Genomic2DTK","text":"first element bin second.","code":"Points_Tad_Border_ctrl_2.mtx_lst <- ExtractSubmatrix(   feature.gn         = tad_Border_Binnned.gni,   hic.cmx_lst        = HiC_ctrl.cmx_lst,   referencePoint.chr = \"pf\",   matriceDim.num     = 101,   verbose.bln        = FALSE )"},{"path":"/articles/Genomic2DTK.html","id":"filtrations","dir":"Articles","previous_headings":"","what":"Filtrations","title":"Introduction to Genomic2DTK","text":"section see select interactions GInteraction object matrices extracted Matrices list.","code":""},{"path":"/articles/Genomic2DTK.html","id":"tips-3","dir":"Articles","previous_headings":"Filtrations","what":"Tips","title":"Introduction to Genomic2DTK","text":"Filter GInterction object allow cross selection indices want. Filter matrices list without selection better filter interaction attributes matrices list","code":""},{"path":"/articles/Genomic2DTK.html","id":"target-list","dir":"Articles","previous_headings":"Filtrations","what":"Target list","title":"Introduction to Genomic2DTK","text":"Target list must particular structure. First named list. name element must name column GInteraction want filter (attributes “interactions” matrices list want filter. element must character list match column function test row column return bolean. First, let’s look GInteractions columns names (metadata interactions attributes matrices list) look Now lets create target : “Beaf32_8” “Beaf32_15” anchor.Beaf.name “FBgn0031214” “FBgn0005278” bait.Tss.name “2L:74_2L:77” name distance exactly equal 14000 3000","code":"structureTarget.lst <- list(   first_colname_of_GInteraction  = c(\"value\"),   second_colname_of_GInteraction = function(eachElement){min_th<value && value<max_th}   ) names(mcols(attributes(Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst)$interactions)) attributes(Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst)$interactions target.lst <- list(   anchor.Beaf.name = c(\"Beaf32_8\",\"Beaf32_15\"),   bait.Tss.name    = c(\"FBgn0031214\",\"FBgn0005278\"),   name             = c(\"2L:74_2L:77\"),   distance         = function(columnElement){     return(14000==columnElement || columnElement == 3000)     }   )"},{"path":"/articles/Genomic2DTK.html","id":"filtration-without-selection","dir":"Articles","previous_headings":"Filtrations","what":"Filtration without selection","title":"Introduction to Genomic2DTK","text":"don’t specify selection ways function return indices target list. allow cross indices select want want second step.","code":""},{"path":"/articles/Genomic2DTK.html","id":"ginteraction-filtration","dir":"Articles","previous_headings":"Filtrations > Filtration without selection","what":"GInteraction filtration","title":"Introduction to Genomic2DTK","text":"","code":"FilterInteractions(   interarctions.gni = attributes(Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst)$interactions,   target.lst        = target.lst,   selection.fun     = NULL   ) %>% str #> List of 4 #>  $ anchor.Beaf.name: int [1:3] 1 3 4 #>  $ bait.Tss.name   : int [1:3] 1 2 3 #>  $ name            : int 1 #>  $ distance        : int [1:25] 1 3 8 24 38 49 63 65 80 102 ..."},{"path":"/articles/Genomic2DTK.html","id":"matrices-list-filtration","dir":"Articles","previous_headings":"Filtrations > Filtration without selection","what":"Matrices list filtration","title":"Introduction to Genomic2DTK","text":"","code":"FilterInteractions(   matrices.lst      = Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst,   target.lst        = target.lst,   selection.fun     = NULL   ) %>% str #> List of 4 #>  $ anchor.Beaf.name: int [1:3] 1 3 4 #>  $ bait.Tss.name   : int [1:3] 1 2 3 #>  $ name            : int 1 #>  $ distance        : int [1:25] 1 3 8 24 38 49 63 65 80 102 ..."},{"path":"/articles/Genomic2DTK.html","id":"selection-function","dir":"Articles","previous_headings":"Filtrations","what":"Selection Function","title":"Introduction to Genomic2DTK","text":"Now create function cross target indices select precisely want. order perform need set theory basis.","code":""},{"path":"/articles/Genomic2DTK.html","id":"set-theory-functions","dir":"Articles","previous_headings":"Filtrations > Selection Function","what":"Set theory functions","title":"Introduction to Genomic2DTK","text":"common , B C /B /C common B, C common B, plus present C common C elements present B Everything present B C present ","code":"a = c(\"A\",\"B\",\"D\",\"G\") b = c(\"E\",\"B\",\"C\",\"G\") c = c(\"A\",\"F\",\"C\",\"G\") Reduce(intersect, list(a,b,c)) %>% sort  #> [1] \"G\" intersect(a,b) %>% intersect(.,c) %>% sort #> [1] \"G\" Reduce(union, list(a,b,c)) %>% sort  #> [1] \"A\" \"B\" \"C\" \"D\" \"E\" \"F\" \"G\" union(a,b) %>% union(.,c) %>% sort #> [1] \"A\" \"B\" \"C\" \"D\" \"E\" \"F\" \"G\" Reduce(setdiff,list(a,b,c)) %>% sort  #> [1] \"D\" setdiff(a,b) %>% setdiff(.,c) %>% sort #> [1] \"D\" intersect(a,b) %>% setdiff(.,c) %>% sort #> [1] \"B\" intersect(a,b) %>% union(.,c) %>% sort #> [1] \"A\" \"B\" \"C\" \"F\" \"G\" union(a,b) %>% intersect(.,c) %>% sort #> [1] \"A\" \"C\" \"G\" union(a,b) %>% setdiff(.,c) %>% sort #> [1] \"B\" \"D\" \"E\" c(a,b,c) %>% setdiff(.,.[duplicated(.)]) %>% sort #> [1] \"D\" \"E\" \"F\""},{"path":"/articles/Genomic2DTK.html","id":"exemple-according-to-the-above-target","dir":"Articles","previous_headings":"Filtrations > Selection Function","what":"Exemple according to the above target","title":"Introduction to Genomic2DTK","text":"select anchor.Beaf.name, bait.Tss.name distance, name","code":"selection.fun = function(){   Reduce(intersect, list(anchor.Beaf.name, bait.Tss.name ,distance) )%>%   setdiff(name)   }"},{"path":"/articles/Genomic2DTK.html","id":"filtration-with-selection","dir":"Articles","previous_headings":"Filtrations","what":"Filtration with selection","title":"Introduction to Genomic2DTK","text":"specify selection way function return: indices according selection select interarctions.gni (allow construct vector apply multiple matrices list interaction attributes). filtred matrices list select matrices list directly update attributes.","code":""},{"path":"/articles/Genomic2DTK.html","id":"ginteraction-filtration-1","dir":"Articles","previous_headings":"Filtrations > Filtration with selection","what":"GInteraction filtration","title":"Introduction to Genomic2DTK","text":"want select wich anchor.Beaf.name, bait.Tss.name distance criterion name. , indices common anchor.Beaf.name, bait.Tss.name distance criterions 1 4. indice 1 name criterion, select 4th element names 4th interaction :","code":"FilterInteractions(   interarctions.gni = attributes(Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst)$interactions,   target.lst        = target.lst,   selection.fun     = selection.fun   ) %>% str #>  int 3 attributes(Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst)$interactions$name[4] #> [1] \"2L:121_2L:117\""},{"path":"/articles/Genomic2DTK.html","id":"matrices-list-filtration-1","dir":"Articles","previous_headings":"Filtrations > Filtration with selection","what":"Matrices list filtration","title":"Introduction to Genomic2DTK","text":"names filtred matrice 4th interaction:","code":"Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst_filtred <- FilterInteractions(   matrices.lst  = Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst,   target.lst    = target.lst,   selection.fun = selection.fun   ) attributes(Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst_filtred)$names #> [1] \"2L:107_2L:121\""},{"path":"/articles/Genomic2DTK.html","id":"particular-case-only-one-target-and-no-selection","dir":"Articles","previous_headings":"Filtrations","what":"Particular case: Only one target and no selection","title":"Introduction to Genomic2DTK","text":"exemple, want filter 10th first elements, target 10 first names","code":"first10_target.lst = list(   submatrix.name = names(Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst)[1:10]   )"},{"path":"/articles/Genomic2DTK.html","id":"ginteraction-filtration-2","dir":"Articles","previous_headings":"Filtrations > Particular case: Only one target and no selection","what":"GInteraction filtration","title":"Introduction to Genomic2DTK","text":"","code":"FilterInteractions(   interarctions.gni = attributes(Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst)$interactions,   target.lst        = first10_target.lst,   selection.fun     = NULL   ) %>% str #>  Named int [1:10] 1 2 3 4 5 6 7 8 9 10 #>  - attr(*, \"names\")= chr [1:10] \"submatrix.name1\" \"submatrix.name2\" \"submatrix.name3\" \"submatrix.name4\" ..."},{"path":"/articles/Genomic2DTK.html","id":"matrices-list-filtration-2","dir":"Articles","previous_headings":"Filtrations > Particular case: Only one target and no selection","what":"Matrices list filtration","title":"Introduction to Genomic2DTK","text":"selection matrices remove attributes.","code":"first10_Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst <- FilterInteractions(   matrices.lst  = Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst,   target.lst    = first10_target.lst,   selection.fun = NULL   ) attributes(first10_Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst)$interactions #> GInteractions object with 10 interactions and 15 metadata columns: #>                 seqnames1       ranges1     seqnames2       ranges2 | #>                     <Rle>     <IRanges>         <Rle>     <IRanges> | #>     2L:74_2L:77        2L   73001-74000 ---        2L   76001-77000 | #>   2L:115_2L:107        2L 114001-115000 ---        2L 106001-107000 | #>   2L:121_2L:107        2L 120001-121000 ---        2L 106001-107000 | #>   2L:121_2L:117        2L 120001-121000 ---        2L 116001-117000 | #>   2L:274_2L:268        2L 273001-274000 ---        2L 267001-268000 | #>   2L:278_2L:268        2L 277001-278000 ---        2L 267001-268000 | #>   2L:274_2L:279        2L 273001-274000 ---        2L 278001-279000 | #>   2L:306_2L:320        2L 305001-306000 ---        2L 319001-320000 | #>   2L:471_2L:422        2L 470001-471000 ---        2L 421001-422000 | #>   2L:472_2L:422        2L 471001-472000 ---        2L 421001-422000 | #>                          name  constraint  distance orientation submatrix.name #>                   <character> <character> <integer>   <logical>    <character> #>     2L:74_2L:77   2L:74_2L:77       Tad_1      3000        TRUE    2L:74_2L:77 #>   2L:115_2L:107 2L:115_2L:107       Tad_3      8000       FALSE  2L:107_2L:115 #>   2L:121_2L:107 2L:121_2L:107       Tad_3     14000       FALSE  2L:107_2L:121 #>   2L:121_2L:117 2L:121_2L:117       Tad_3      4000       FALSE  2L:117_2L:121 #>   2L:274_2L:268 2L:274_2L:268      Tad_10      6000       FALSE  2L:268_2L:274 #>   2L:278_2L:268 2L:278_2L:268      Tad_10     10000       FALSE  2L:268_2L:278 #>   2L:274_2L:279 2L:274_2L:279      Tad_10      5000        TRUE  2L:274_2L:279 #>   2L:306_2L:320 2L:306_2L:320      Tad_13     14000        TRUE  2L:306_2L:320 #>   2L:471_2L:422 2L:471_2L:422      Tad_17     49000       FALSE  2L:422_2L:471 #>   2L:472_2L:422 2L:472_2L:422      Tad_17     50000       FALSE  2L:422_2L:472 #>                  anchor.bin   anchor.name    bait.bin     bait.name #>                 <character>   <character> <character>   <character> #>     2L:74_2L:77       2L:74   2L:74:Tad_1       2L:77   2L:77:Tad_1 #>   2L:115_2L:107      2L:115  2L:115:Tad_3      2L:107  2L:107:Tad_3 #>   2L:121_2L:107      2L:121  2L:121:Tad_3      2L:107  2L:107:Tad_3 #>   2L:121_2L:117      2L:121  2L:121:Tad_3      2L:117  2L:117:Tad_3 #>   2L:274_2L:268      2L:274 2L:274:Tad_10      2L:268 2L:268:Tad_10 #>   2L:278_2L:268      2L:278 2L:278:Tad_10      2L:268 2L:268:Tad_10 #>   2L:274_2L:279      2L:274 2L:274:Tad_10      2L:279 2L:279:Tad_10 #>   2L:306_2L:320      2L:306 2L:306:Tad_13      2L:320 2L:320:Tad_13 #>   2L:471_2L:422      2L:471 2L:471:Tad_17      2L:422 2L:422:Tad_17 #>   2L:472_2L:422      2L:472 2L:472:Tad_17      2L:422 2L:422:Tad_17 #>                 anchor.Beaf.score anchor.Beaf.name anchor.Beaf.bln #>                         <numeric>           <list>       <numeric> #>     2L:74_2L:77               205         Beaf32_8               1 #>   2L:115_2L:107              1707        Beaf32_14               1 #>   2L:121_2L:107               484        Beaf32_15               1 #>   2L:121_2L:117               484        Beaf32_15               1 #>   2L:274_2L:268               210        Beaf32_39               1 #>   2L:278_2L:268              1641        Beaf32_41               1 #>   2L:274_2L:279               210        Beaf32_39               1 #>   2L:306_2L:320                52        Beaf32_48               1 #>   2L:471_2L:422                37        Beaf32_62               1 #>   2L:472_2L:422                37        Beaf32_62               1 #>                 bait.Tss.class           bait.Tss.name bait.Tss.bln #>                    <character>                  <list>    <numeric> #>     2L:74_2L:77       inactive             FBgn0031214            1 #>   2L:115_2L:107         active FBgn0026787,FBgn0005278            1 #>   2L:121_2L:107         active FBgn0026787,FBgn0005278            1 #>   2L:121_2L:117         active             FBgn0031219            1 #>   2L:274_2L:268       inactive             FBgn0031239            1 #>   2L:278_2L:268       inactive             FBgn0031239            1 #>   2L:274_2L:279         active             FBgn0086855            1 #>   2L:306_2L:320       inactive             FBgn0031248            1 #>   2L:471_2L:422         active             FBgn0031253            1 #>   2L:472_2L:422         active             FBgn0031253            1 #>   ------- #>   regions: 429 ranges and 0 metadata columns #>   seqinfo: 2 sequences from an unspecified genome attributes(Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst[1:10])$interactions #> NULL"},{"path":"/articles/Genomic2DTK.html","id":"particular-case-sampling","dir":"Articles","previous_headings":"Filtrations","what":"Particular case: Sampling","title":"Introduction to Genomic2DTK","text":"","code":"nSample.num = 3 set.seed(123) target.lst = list(name=sample(attributes(Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst)$interactions$name,nSample.num))"},{"path":"/articles/Genomic2DTK.html","id":"ginteraction-sampling","dir":"Articles","previous_headings":"Filtrations > Particular case: Sampling","what":"GInteraction sampling","title":"Introduction to Genomic2DTK","text":"","code":"FilterInteractions(   interarctions.gni = attributes(Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst)$interactions,   target.lst        = target.lst,   selection.fun     = NULL   ) %>% str #>  Named int [1:3] 14 179 195 #>  - attr(*, \"names\")= chr [1:3] \"name1\" \"name2\" \"name3\""},{"path":"/articles/Genomic2DTK.html","id":"matrices-list-sampling","dir":"Articles","previous_headings":"Filtrations > Particular case: Sampling","what":"Matrices list sampling","title":"Introduction to Genomic2DTK","text":"","code":"sampled_Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst <- FilterInteractions(   matrices.lst  = Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst,   target.lst    = target.lst,   selection.fun = NULL   ) attributes(sampled_Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst)$interactions #> GInteractions object with 3 interactions and 15 metadata columns: #>                     seqnames1           ranges1     seqnames2           ranges2 #>                         <Rle>         <IRanges>         <Rle>         <IRanges> #>     2L:1178_2L:1174        2L   1177001-1178000 ---        2L   1173001-1174000 #>   2L:21574_2L:21492        2L 21573001-21574000 ---        2L 21491001-21492000 #>     2R:5672_2R:5653        2R   5671001-5672000 ---        2R   5652001-5653000 #>                     |              name  constraint  distance orientation #>                     |       <character> <character> <integer>   <logical> #>     2L:1178_2L:1174 |   2L:1178_2L:1174      Tad_35      4000       FALSE #>   2L:21574_2L:21492 | 2L:21574_2L:21492     Tad_486     82000       FALSE #>     2R:5672_2R:5653 |   2R:5672_2R:5653     Tad_513     19000       FALSE #>                        submatrix.name  anchor.bin      anchor.name    bait.bin #>                           <character> <character>      <character> <character> #>     2L:1178_2L:1174   2L:1174_2L:1178     2L:1178   2L:1178:Tad_35     2L:1174 #>   2L:21574_2L:21492 2L:21492_2L:21574    2L:21574 2L:21574:Tad_486    2L:21492 #>     2R:5672_2R:5653   2R:5653_2R:5672     2R:5672  2R:5672:Tad_513     2R:5653 #>                            bait.name anchor.Beaf.score anchor.Beaf.name #>                          <character>         <numeric>           <list> #>     2L:1178_2L:1174   2L:1174:Tad_35               921       Beaf32_130 #>   2L:21574_2L:21492 2L:21492:Tad_486               529      Beaf32_1349 #>     2R:5672_2R:5653  2R:5653:Tad_513                99      Beaf32_1462 #>                     anchor.Beaf.bln bait.Tss.class bait.Tss.name bait.Tss.bln #>                           <numeric>    <character>        <list>    <numeric> #>     2L:1178_2L:1174               1         active   FBgn0031318            1 #>   2L:21574_2L:21492               1       inactive   FBgn0053837            1 #>     2R:5672_2R:5653               1         active   FBgn0033028            1 #>   ------- #>   regions: 429 ranges and 0 metadata columns #>   seqinfo: 2 sequences from an unspecified genome"},{"path":[]},{"path":"/articles/Genomic2DTK.html","id":"tips-4","dir":"Articles","previous_headings":"Orientation","what":"Tips","title":"Introduction to Genomic2DTK","text":"Use function oriente matrices list one matrix. want force orientation matrix use orientation , list.","code":""},{"path":"/articles/Genomic2DTK.html","id":"understand-orientation","dir":"Articles","previous_headings":"Orientation","what":"Understand orientation","title":"Introduction to Genomic2DTK","text":"First, lets look two first matrices oriented (column orientation metadata interactions attribute). can see first matrix correctly oriented (value TRUE) second one. matrix correctly oriented anchor bait (see SearchPairs anchor-bait order), matrix oriented anchor bait. mean : first matrice, anchor Beaf Y axis bait TSS X axis second matrice, bait TSS Y axis anchor Beaf X axis  oriente second matrix put anchor Y axis bait X axis see happens.","code":"attributes(first10_Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst)$interactions$orientation[1:2]  #> [1]  TRUE FALSE"},{"path":"/articles/Genomic2DTK.html","id":"orientation-on-matrices-list","dir":"Articles","previous_headings":"Orientation","what":"Orientation on matrices list","title":"Introduction to Genomic2DTK","text":"expected values upper left corner (green scheme) end lower right corner orientation, let’s oriente matrices list according orientation metadata.","code":"oriented_first10_Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst <- OrienteMatrix(first10_Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst)"},{"path":"/articles/Genomic2DTK.html","id":"first-matrice-dont-need-orientation","dir":"Articles","previous_headings":"Orientation > Orientation on matrices list","what":"First matrice (don’t need orientation)","title":"Introduction to Genomic2DTK","text":"upper left corner orientation. upper left corner orientation change.","code":"first10_Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst[[1]][1:2,1:2] oriented_first10_Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst[[1]][1:2,1:2]"},{"path":"/articles/Genomic2DTK.html","id":"second-matrice-need-orientation","dir":"Articles","previous_headings":"Orientation > Orientation on matrices list","what":"Second matrice (need orientation)","title":"Introduction to Genomic2DTK","text":"upper left corner orientation lower right corner orientation correspond upper left corner orientation","code":"first10_Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst[[2]][1:2,1:2] oriented_first10_Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst[[2]][100:101,100:101]"},{"path":"/articles/Genomic2DTK.html","id":"orientation-on-only-one-matrice-","dir":"Articles","previous_headings":"Orientation","what":"Orientation on only one matrice.","title":"Introduction to Genomic2DTK","text":"function also oriente one matrix case attribute verification can oriente matrix don’t need orentation.","code":""},{"path":"/articles/Genomic2DTK.html","id":"first-matrix","dir":"Articles","previous_headings":"Orientation > Orientation on only one matrice.","what":"First matrix","title":"Introduction to Genomic2DTK","text":"Lower right corner orientation correspond upper left corner orientation.","code":"OrienteMatrix(first10_Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst[[1]])[100:101,100:101]"},{"path":"/articles/Genomic2DTK.html","id":"second-matrix","dir":"Articles","previous_headings":"Orientation > Orientation on only one matrice.","what":"Second matrix","title":"Introduction to Genomic2DTK","text":"find orientation second matrix.","code":"OrienteMatrix(first10_Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst[[2]])[100:101,100:101]"},{"path":[]},{"path":"/articles/Genomic2DTK.html","id":"tips-5","dir":"Articles","previous_headings":"Quantifications","what":"Tips","title":"Introduction to Genomic2DTK","text":"print quantifications use c function avoid attributes printing. select area null operation.fun return values selected area without NA.","code":""},{"path":"/articles/Genomic2DTK.html","id":"preregistred-area-and-functions","dir":"Articles","previous_headings":"Quantifications","what":"Preregistred area and functions","title":"Introduction to Genomic2DTK","text":"GetQuantif function preregistred area function (see Genomic2DTK::GetQuantif). extract centrals values. interactions values square 3x3 centred interactions anchor bait. extracted value perform average removing zeros. can see values attributes numerical vector value matrices. attributes matrices list two news: area function extract area values matrices. operation correspond numerical operatiion perform values selected area. order print quantifications use c function avoid attributes printing. reduce printing use unlist function.","code":"center.num <- GetQuantif(   matrices.lst  = oriented_first10_Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst,   area.fun      = \"center\",   operation.fun = \"mean_rm0\"   ) center.num #> $`2L:74_2L:77` #> [1] 0.01238601 #>  #> $`2L:115_2L:107` #> [1] 0.04313207 #>  #> $`2L:121_2L:107` #> [1] 1.01102 #>  #> $`2L:121_2L:117` #> [1] 0.03643152 #>  #> $`2L:274_2L:268` #> [1] 1.69169 #>  #> $`2L:278_2L:268` #> [1] 1.483054 #>  #> $`2L:274_2L:279` #> [1] 1.699314 #>  #> $`2L:306_2L:320` #> [1] 0.6724637 #>  #> $`2L:471_2L:422` #> [1] 0.4478968 #>  #> $`2L:472_2L:422` #> [1] 0.6564072 #>  #> attr(,\"interactions\") #> GInteractions object with 10 interactions and 15 metadata columns: #>                 seqnames1       ranges1     seqnames2       ranges2 | #>                     <Rle>     <IRanges>         <Rle>     <IRanges> | #>     2L:74_2L:77        2L   73001-74000 ---        2L   76001-77000 | #>   2L:115_2L:107        2L 114001-115000 ---        2L 106001-107000 | #>   2L:121_2L:107        2L 120001-121000 ---        2L 106001-107000 | #>   2L:121_2L:117        2L 120001-121000 ---        2L 116001-117000 | #>   2L:274_2L:268        2L 273001-274000 ---        2L 267001-268000 | #>   2L:278_2L:268        2L 277001-278000 ---        2L 267001-268000 | #>   2L:274_2L:279        2L 273001-274000 ---        2L 278001-279000 | #>   2L:306_2L:320        2L 305001-306000 ---        2L 319001-320000 | #>   2L:471_2L:422        2L 470001-471000 ---        2L 421001-422000 | #>   2L:472_2L:422        2L 471001-472000 ---        2L 421001-422000 | #>                          name  constraint  distance orientation submatrix.name #>                   <character> <character> <integer>   <logical>    <character> #>     2L:74_2L:77   2L:74_2L:77       Tad_1      3000        TRUE    2L:74_2L:77 #>   2L:115_2L:107 2L:115_2L:107       Tad_3      8000        TRUE  2L:115_2L:107 #>   2L:121_2L:107 2L:121_2L:107       Tad_3     14000        TRUE  2L:121_2L:107 #>   2L:121_2L:117 2L:121_2L:117       Tad_3      4000        TRUE  2L:121_2L:117 #>   2L:274_2L:268 2L:274_2L:268      Tad_10      6000        TRUE  2L:274_2L:268 #>   2L:278_2L:268 2L:278_2L:268      Tad_10     10000        TRUE  2L:278_2L:268 #>   2L:274_2L:279 2L:274_2L:279      Tad_10      5000        TRUE  2L:274_2L:279 #>   2L:306_2L:320 2L:306_2L:320      Tad_13     14000        TRUE  2L:306_2L:320 #>   2L:471_2L:422 2L:471_2L:422      Tad_17     49000        TRUE  2L:471_2L:422 #>   2L:472_2L:422 2L:472_2L:422      Tad_17     50000        TRUE  2L:472_2L:422 #>                  anchor.bin   anchor.name    bait.bin     bait.name #>                 <character>   <character> <character>   <character> #>     2L:74_2L:77       2L:74   2L:74:Tad_1       2L:77   2L:77:Tad_1 #>   2L:115_2L:107      2L:115  2L:115:Tad_3      2L:107  2L:107:Tad_3 #>   2L:121_2L:107      2L:121  2L:121:Tad_3      2L:107  2L:107:Tad_3 #>   2L:121_2L:117      2L:121  2L:121:Tad_3      2L:117  2L:117:Tad_3 #>   2L:274_2L:268      2L:274 2L:274:Tad_10      2L:268 2L:268:Tad_10 #>   2L:278_2L:268      2L:278 2L:278:Tad_10      2L:268 2L:268:Tad_10 #>   2L:274_2L:279      2L:274 2L:274:Tad_10      2L:279 2L:279:Tad_10 #>   2L:306_2L:320      2L:306 2L:306:Tad_13      2L:320 2L:320:Tad_13 #>   2L:471_2L:422      2L:471 2L:471:Tad_17      2L:422 2L:422:Tad_17 #>   2L:472_2L:422      2L:472 2L:472:Tad_17      2L:422 2L:422:Tad_17 #>                 anchor.Beaf.score anchor.Beaf.name anchor.Beaf.bln #>                         <numeric>           <list>       <numeric> #>     2L:74_2L:77               205         Beaf32_8               1 #>   2L:115_2L:107              1707        Beaf32_14               1 #>   2L:121_2L:107               484        Beaf32_15               1 #>   2L:121_2L:117               484        Beaf32_15               1 #>   2L:274_2L:268               210        Beaf32_39               1 #>   2L:278_2L:268              1641        Beaf32_41               1 #>   2L:274_2L:279               210        Beaf32_39               1 #>   2L:306_2L:320                52        Beaf32_48               1 #>   2L:471_2L:422                37        Beaf32_62               1 #>   2L:472_2L:422                37        Beaf32_62               1 #>                 bait.Tss.class           bait.Tss.name bait.Tss.bln #>                    <character>                  <list>    <numeric> #>     2L:74_2L:77       inactive             FBgn0031214            1 #>   2L:115_2L:107         active FBgn0026787,FBgn0005278            1 #>   2L:121_2L:107         active FBgn0026787,FBgn0005278            1 #>   2L:121_2L:117         active             FBgn0031219            1 #>   2L:274_2L:268       inactive             FBgn0031239            1 #>   2L:278_2L:268       inactive             FBgn0031239            1 #>   2L:274_2L:279         active             FBgn0086855            1 #>   2L:306_2L:320       inactive             FBgn0031248            1 #>   2L:471_2L:422         active             FBgn0031253            1 #>   2L:472_2L:422         active             FBgn0031253            1 #>   ------- #>   regions: 429 ranges and 0 metadata columns #>   seqinfo: 2 sequences from an unspecified genome #> attr(,\"target\") #> attr(,\"target\")$submatrix.name #>  [1] \"2L:74_2L:77\"   \"2L:107_2L:115\" \"2L:107_2L:121\" \"2L:117_2L:121\" #>  [5] \"2L:268_2L:274\" \"2L:268_2L:278\" \"2L:274_2L:279\" \"2L:306_2L:320\" #>  [9] \"2L:422_2L:471\" \"2L:422_2L:472\" #>  #> attr(,\"resolution\") #> [1] 1000 #> attr(,\"referencePoint\") #> [1] \"rf\" #> attr(,\"matriceDim\") #> [1] 101 #> attr(,\"shiftFactor\") #> [1] 1 #> attr(,\"operation\") #> function (x)  #> { #>     x[which(x == 0)] <- NA #>     mean(x, na.rm = TRUE) #> } #> <environment: 0x55e488a05040> #> attr(,\"area\") #> function (matrice.mtx)  #> { #>     matrice.mtx[33:35, 67:69] #> } #> <environment: 0x55e48b599020> c(center.num) #> $`2L:74_2L:77` #> [1] 0.01238601 #>  #> $`2L:115_2L:107` #> [1] 0.04313207 #>  #> $`2L:121_2L:107` #> [1] 1.01102 #>  #> $`2L:121_2L:117` #> [1] 0.03643152 #>  #> $`2L:274_2L:268` #> [1] 1.69169 #>  #> $`2L:278_2L:268` #> [1] 1.483054 #>  #> $`2L:274_2L:279` #> [1] 1.699314 #>  #> $`2L:306_2L:320` #> [1] 0.6724637 #>  #> $`2L:471_2L:422` #> [1] 0.4478968 #>  #> $`2L:472_2L:422` #> [1] 0.6564072 c(center.num) %>% unlist(.) #>   2L:74_2L:77 2L:115_2L:107 2L:121_2L:107 2L:121_2L:117 2L:274_2L:268  #>    0.01238601    0.04313207    1.01102006    0.03643152    1.69168994  #> 2L:278_2L:268 2L:274_2L:279 2L:306_2L:320 2L:471_2L:422 2L:472_2L:422  #>    1.48305411    1.69931399    0.67246369    0.44789676    0.65640723"},{"path":"/articles/Genomic2DTK.html","id":"values-naming","dir":"Articles","previous_headings":"Quantifications","what":"Values naming","title":"Introduction to Genomic2DTK","text":"function also named values according metadata interactions attributes. exemple take quantification now want use “anchor.Beaf.name” metadata name. first value center.num repeted namedCenter.num attributes add know wich values duplicate. second value","code":"namedCenter.num <- GetQuantif(   matrices.lst  = oriented_first10_Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst,   area.fun      = \"center\",   operation.fun = \"mean_rm0\",   name.chr      = \"anchor.Beaf.name\"   ) c(center.num) %>% unlist(.) #>   2L:74_2L:77 2L:115_2L:107 2L:121_2L:107 2L:121_2L:117 2L:274_2L:268  #>    0.01238601    0.04313207    1.01102006    0.03643152    1.69168994  #> 2L:278_2L:268 2L:274_2L:279 2L:306_2L:320 2L:471_2L:422 2L:472_2L:422  #>    1.48305411    1.69931399    0.67246369    0.44789676    0.65640723 c(namedCenter.num) %>% unlist(.) #>   Beaf32_8  Beaf32_14  Beaf32_15  Beaf32_15  Beaf32_39  Beaf32_41  Beaf32_39  #> 0.01238601 0.04313207 1.01102006 0.03643152 1.69168994 1.48305411 1.69931399  #>  Beaf32_48  Beaf32_62  Beaf32_62  #> 0.67246369 0.44789676 0.65640723 attributes(center.num)$duplicated #> NULL attributes(namedCenter.num)$duplicated #> NULL"},{"path":"/articles/Genomic2DTK.html","id":"custom-functions","dir":"Articles","previous_headings":"Quantifications","what":"Custom functions","title":"Introduction to Genomic2DTK","text":"GetQuantif function also take custom area selection operation parameter. exemple use functions see attributes area operation center.num vector. obtain result custom function parameter.","code":"GetQuantif(   matrices.lst  = oriented_first10_Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst,   area.fun      = function(matrice.mtx){matrice.mtx[33:35,67:69]},   operation.fun = function(area.mtx){     area.mtx[which(area.mtx==0)]<-NA;     return(mean(area.mtx,na.rm=TRUE))     }   ) %>% c(.) %>% unlist(.) #>   2L:74_2L:77 2L:115_2L:107 2L:121_2L:107 2L:121_2L:117 2L:274_2L:268  #>    0.01238601    0.04313207    1.01102006    0.03643152    1.69168994  #> 2L:278_2L:268 2L:274_2L:279 2L:306_2L:320 2L:471_2L:422 2L:472_2L:422  #>    1.48305411    1.69931399    0.67246369    0.44789676    0.65640723"},{"path":"/articles/Genomic2DTK.html","id":"particular-cases-extraction-of-values","dir":"Articles","previous_headings":"Quantifications","what":"Particular cases: Extraction of values","title":"Introduction to Genomic2DTK","text":"Operation.fun parameter custom function just return area selected. allow extract values matrices. ### One value extraction","code":"GetQuantif(   matrices.lst  = oriented_first10_Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst,   area.fun      = function(matrice.mtx){matrice.mtx[5,5]},   operation.fun = function(area.mtx){area.mtx}   ) %>% c(.) %>% unlist(.) #>   2L:74_2L:77 2L:115_2L:107 2L:121_2L:107 2L:121_2L:117 2L:274_2L:268  #>    0.00000000    0.00000000    0.34039825    0.43514634    0.00000000  #> 2L:278_2L:268 2L:274_2L:279 2L:306_2L:320 2L:471_2L:422 2L:472_2L:422  #>    0.18062805    0.00000000    0.00000000    0.01182124    0.00000000"},{"path":"/articles/Genomic2DTK.html","id":"area-extraction","dir":"Articles","previous_headings":"Quantifications > Particular cases: Extraction of values","what":"Area extraction","title":"Introduction to Genomic2DTK","text":"Operation.fun parameter custom function just return area selected. allow extract values matrices. null operation.fun return values selected area without NA.","code":"GetQuantif(   matrices.lst  = oriented_first10_Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst,   area.fun      = function(matrice.mtx){matrice.mtx[4:6,4:6]},   operation.fun = function(area){area}   ) %>% c(.) #> $`2L:74_2L:77` #>      [,1] [,2] [,3] #> [1,]    0    0    0 #> [2,]   NA    0    0 #> [3,]   NA   NA    0 #>  #> $`2L:115_2L:107` #>      [,1] [,2]      [,3] #> [1,]    0    0 0.1671591 #> [2,]   NA    0 0.2228788 #> [3,]   NA   NA 0.1857323 #>  #> $`2L:121_2L:107` #>           [,1]      [,2]      [,3] #> [1,] 0.3009771 0.7871710 1.2376943 #> [2,]        NA 0.3403983 0.5352191 #> [3,]        NA        NA 0.0000000 #>  #> $`2L:121_2L:117` #>           [,1]      [,2]      [,3] #> [1,] 0.6591566 0.5355647 0.4119729 #> [2,]        NA 0.4351463 0.3347280 #> [3,]        NA        NA 0.2574830 #>  #> $`2L:274_2L:268` #>      [,1] [,2] [,3] #> [1,]    0    0    0 #> [2,]   NA    0    0 #> [3,]   NA   NA    0 #>  #> $`2L:278_2L:268` #>      [,1]      [,2]      [,3] #> [1,]    0 0.2032066 0.5080164 #> [2,]   NA 0.1806280 0.4515701 #> [3,]   NA        NA 0.2822313 #>  #> $`2L:274_2L:279` #>      [,1] [,2] [,3] #> [1,]    0    0    0 #> [2,]   NA    0    0 #> [3,]   NA   NA    0 #>  #> $`2L:306_2L:320` #>      [,1] [,2]       [,3] #> [1,]    0    0 0.03562731 #> [2,]   NA    0 0.09317913 #> [3,]   NA   NA 0.13872766 #>  #> $`2L:471_2L:422` #>           [,1]       [,2]      [,3] #> [1,] 0.1379966 0.04038924 0.6810285 #> [2,]        NA 0.01182124 0.2958302 #> [3,]        NA         NA 0.0000000 #>  #> $`2L:472_2L:422` #>           [,1] [,2]      [,3] #> [1,] 0.3027412    0 0.0000000 #> [2,]        NA    0 0.0000000 #> [3,]        NA   NA 0.2052299 GetQuantif(   matrices.lst  = oriented_first10_Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst,   area.fun      = function(matrice.mtx){matrice.mtx[4:6,4:6]},   operation.fun = NULL   ) %>% c(.) #> $`2L:74_2L:77` #> [1] 0 0 0 0 0 0 #>  #> $`2L:115_2L:107` #> [1] 0.0000000 0.0000000 0.0000000 0.1671591 0.2228788 0.1857323 #>  #> $`2L:121_2L:107` #> [1] 0.3009771 0.7871710 0.3403983 1.2376943 0.5352191 0.0000000 #>  #> $`2L:121_2L:117` #> [1] 0.6591566 0.5355647 0.4351463 0.4119729 0.3347280 0.2574830 #>  #> $`2L:274_2L:268` #> [1] 0 0 0 0 0 0 #>  #> $`2L:278_2L:268` #> [1] 0.0000000 0.2032066 0.1806280 0.5080164 0.4515701 0.2822313 #>  #> $`2L:274_2L:279` #> [1] 0 0 0 0 0 0 #>  #> $`2L:306_2L:320` #> [1] 0.00000000 0.00000000 0.00000000 0.03562731 0.09317913 0.13872766 #>  #> $`2L:471_2L:422` #> [1] 0.13799657 0.04038924 0.01182124 0.68102846 0.29583023 0.00000000 #>  #> $`2L:472_2L:422` #> [1] 0.3027412 0.0000000 0.0000000 0.0000000 0.0000000 0.2052299"},{"path":[]},{"path":"/articles/Genomic2DTK.html","id":"tips-6","dir":"Articles","previous_headings":"Aggregations","what":"Tips","title":"Introduction to Genomic2DTK","text":"perform classical aggregation, use matrices.lst ctrlMatrices.lst parameters rm0.bln TRUE zeros matrices list replace NA. Function keep attributes matrices list add news: totalMatrixNumber: total number matrices. filteredMatrixNumber: number matrices use aggregate (distance filtering). minimalDistance: minimal distance anchor bait need keep matrix aggregation. maximalDistance: maximal distance anchor bait need keep matrix aggregation. aggregationMethod: function apply pixel obtain aggregation. zeroRemoved: Boolean indicate zeros replaced NA. perfomr differential aggregation supplementary attributes. correctedFact: value add condition delete noise. ’s compute median difference condition control background area (e.g upper right corner matrices). agg: Aggregation condition. aggCtrl: Aggregation control. aggCorrected: Aggregation condition corrected correctedFact. aggDelta: difference aggregated matrix condition aggregated matrix control. aggCorrectedDelta: difference aggregated matrix condition corrected correctedFact aggregated matrix control.","code":""},{"path":[]},{"path":"/articles/Genomic2DTK.html","id":"preregistered-function","dir":"Articles","previous_headings":"Aggregations > Classic Aggregations","what":"Preregistered function","title":"Introduction to Genomic2DTK","text":"Like GetQuantif function, aggregation preregistred function like sum, mean median. See Genomic2DTK::Aggregation details. Verification extraction one value","code":"agg_sum.mtx <- Aggregation(   matrices.lst = oriented_first10_Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst,    agg.fun      = \"sum\",   rm0.bln      = FALSE   ) agg_sum.mtx[5,5] #> [1] 0.9679939 GetQuantif(   matrices.lst = oriented_first10_Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst,   area.fun     = function(matrice.mtx){matrice.mtx[5,5] }   ) %>% unlist(.) %>% sum(.) #> [1] NaN"},{"path":"/articles/Genomic2DTK.html","id":"custom-function","dir":"Articles","previous_headings":"Aggregations > Classic Aggregations","what":"Custom function","title":"Introduction to Genomic2DTK","text":"used custom function. function must return unique value pixels_ij matrices. Verification extraction one value","code":"agg_mean.mtx <- Aggregation(   matrices.lst = oriented_first10_Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst,   agg.fun      = function(x){mean(x,na.rm=TRUE)}   ) agg_mean.mtx[5,5] #> [1] 0.09679939 GetQuantif(   matrices.lst = oriented_first10_Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst,   area.fun     = function(matrice.mtx){matrice.mtx[5,5] }   ) %>% unlist(.) %>% mean(.) #> [1] NaN"},{"path":"/articles/Genomic2DTK.html","id":"distance-constraint","dir":"Articles","previous_headings":"Aggregations > Classic Aggregations","what":"Distance constraint","title":"Introduction to Genomic2DTK","text":"add distance constraint, case function agregate ce matrices distance anchor bait superior equal minDist parameter inferior equal maxDist parameter Verification extraction one value","code":"agg_dist.mtx <- Aggregation(   matrices.lst = oriented_first10_Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst,   minDist      = 9000,   maxDist      = 11000,   agg.fun      = \"sum\"   ) agg_dist.mtx[5,5] #>      V97  #> 0.180628 quantif.num <- GetQuantif(   matrices.lst = oriented_first10_Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst,   area.fun     = function(matrice.mtx){matrice.mtx[5,5] }   ) ndx <- which(   attributes(quantif.num)$interactions$distance >= 9000 &   attributes(quantif.num)$interactions$distance <= 11000   ) sum(unlist(quantif.num)[ndx]) #> [1] 0.180628"},{"path":"/articles/Genomic2DTK.html","id":"differential-aggregation","dir":"Articles","previous_headings":"Aggregations","what":"Differential Aggregation","title":"Introduction to Genomic2DTK","text":"Aggregation function also perform differential aggregation. two kind differential function perform: canonical differences difference perform matrix level, .e function perform difference matrices name two list aggregate differential matrices list. second kind differential aggregated level, .e function perform aggregation two condition step ’s possible perform correction avoid noise aggregated matrix adding correction factor calculated background area (e.g upper right corner matrices). function perform difference two aggregated possibly corrected matrices. second kind store attributes called DeltaAggregated. number matrices high (hundreds) may want perform statistical test (Warning ’s memmory conssuming).","code":""},{"path":"/articles/Genomic2DTK.html","id":"preparation-of-matrices-list","dir":"Articles","previous_headings":"Aggregations > Differential Aggregation","what":"Preparation of matrices list","title":"Introduction to Genomic2DTK","text":"Preparation Control matrices list conditionFiltration Orientation Quantifications Verification Preparation second matrices list Beaf depleted condition. Extraction Filtration Orientation Quantifications Verification","code":"first100_target.lst = list(   submatrix.name = names(Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst)[1:100]   ) first100_Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst <- FilterInteractions(   matrices.lst  = Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst,   target.lst    = first100_target.lst,   selection.fun = NULL   ) oriented_first100_Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst <- OrienteMatrix(first100_Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst) rawQuantif.num <- GetQuantif(   matrices.lst  = oriented_first100_Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst,   area.fun      = function(matrice.mtx){matrice.mtx[5,5]},   operation.fun = function(area){area}   ) Regions_Beaf_VS_TssNoBeaf.mtx_lst  <- ExtractSubmatrix(   feature.gn         = Beaf_VS_TssNoBeaf.gni,   hic.cmx_lst        = HiC.cmx_lst,   referencePoint.chr = \"rf\",   matriceDim.num     = 101,   verbose            = FALSE   ) first100_Regions_Beaf_VS_TssNoBeaf.mtx_lst <- FilterInteractions(   matrices.lst  = Regions_Beaf_VS_TssNoBeaf.mtx_lst,   target.lst    = first100_target.lst,   selection.fun = NULL   ) oriented_first100_Regions_Beaf_VS_TssNoBeaf.mtx_lst <- OrienteMatrix(first100_Regions_Beaf_VS_TssNoBeaf.mtx_lst) beafKdQuantif.num <- GetQuantif(   matrices.lst  = oriented_first100_Regions_Beaf_VS_TssNoBeaf.mtx_lst,   area.fun      = function(matrice.mtx){matrice.mtx[5,5]},   operation.fun = function(area){area}   )"},{"path":"/articles/Genomic2DTK.html","id":"aggregate","dir":"Articles","previous_headings":"Aggregations > Differential Aggregation","what":"Aggregate","title":"Introduction to Genomic2DTK","text":"","code":"diffAggreg <- Aggregation(   ctrlMatrices.lst    = oriented_first100_Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst,   matrices.lst        = oriented_first100_Regions_Beaf_VS_TssNoBeaf.mtx_lst,   minDist             = NULL,   maxDist             = NULL,   agg.fun             = \"median\",   rm0.bln             = FALSE,   diff.fun            = \"substraction\",   scaleCorrection.bln = TRUE,   correctionArea.lst  =  list(     i = c(1:30),     j = c(72:101)     ),   statCompare.bln = TRUE)"},{"path":"/articles/Genomic2DTK.html","id":"display-aggregation","dir":"Articles","previous_headings":"Aggregations > Differential Aggregation","what":"Display Aggregation","title":"Introduction to Genomic2DTK","text":"Print attributes Print matrice Differential submatrix level Aggregation Control Aggregation Beaf depleted Condition Differential Aggregated level ScaleFactor Aggregation Classic Scaled Differential Aggregated level Aggregation Classic Scaled Control","code":"diffAggreg prmatrix(diffAggreg) diffAggreg[1:101,1:101] diffAggreg[5,5] #> [1] 0 median(unlist(beafKdQuantif.num) - unlist(rawQuantif.num)) #> [1] 0 attributes(diffAggreg)$matrices$aggCtrl[5,5] #> [1] 0.02970222 median(unlist(rawQuantif.num)) #> [1] 0.02970222 attributes(diffAggreg)$matrices$agg[5,5] #> [1] 0.02025877 median(unlist(beafKdQuantif.num)) #> [1] 0.02025877 attributes(diffAggreg)$matrices$agg[5,5]-attributes(diffAggreg)$matrices$aggCtrl[5,5] #> [1] -0.009443444 attributes(diffAggreg)$matrices$aggDelta[5,5] #> [1] -0.009443444 median(unlist(beafKdQuantif.num)) - median(unlist(rawQuantif.num)) #> [1] -0.009443444 correctedFact.num = median(attributes(diffAggreg)$matrices$aggCtrl[1:30,72:101]) - median(attributes(diffAggreg)$matrices$agg[1:30,72:101]) attributes(diffAggreg)$correctedFact #> [1] 0 attributes(diffAggreg)$matrices$aggCorrected[5,5] #> [1] 0.02025877 attributes(diffAggreg)$matrices$agg[5,5] + correctedFact.num #> [1] 0.02025877 median(unlist(beafKdQuantif.num)) + correctedFact.num #> [1] 0.02025877 attributes(diffAggreg)$matrices$agg[5,5]-attributes(diffAggreg)$matrices$aggCtrl[5,5] + correctedFact.num #> [1] -0.009443444 attributes(diffAggreg)$matrices$aggCorrectedDelta[5,5] #> [1] -0.009443444 median(unlist(beafKdQuantif.num)) - median(unlist(rawQuantif.num)) + correctedFact.num #> [1] -0.009443444"},{"path":[]},{"path":"/articles/Genomic2DTK.html","id":"preparation-of-aggregated-matrices","dir":"Articles","previous_headings":"Aggregations plots","what":"Preparation of aggregated matrices","title":"Introduction to Genomic2DTK","text":"Control aggregation Differential aggregation","code":"oriented_Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst <- OrienteMatrix(Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst) aggreg.mtx <- Aggregation(     ctrlMatrices.lst=oriented_Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst,     agg.fun=\"mean\",     rm0.bln=FALSE ) row.names(aggreg.mtx) = c(rep(\"\",33),rep(\"*\",2),rep(\"\",31),rep(\"*\",2),rep(\"\",33)) colnames(aggreg.mtx) = c(rep(\"\",33),rep(\"*\",2),rep(\"\",31),rep(\"*\",2),rep(\"\",33)) oriented_Regions_Beaf_VS_TssNoBeaf.mtx_lst <- OrienteMatrix(Regions_Beaf_VS_TssNoBeaf.mtx_lst) diffAggreg.mtx <- Aggregation(     ctrlMatrices.lst    = oriented_Regions_Beaf_VS_TssNoBeaf_ctrl.mtx_lst,     matrices.lst        = oriented_Regions_Beaf_VS_TssNoBeaf.mtx_lst,     minDist             = NULL,     maxDist             = NULL,     agg.fun             = \"mean\",     rm0.bln             = FALSE,     diff.fun            = \"log2+1\",     scaleCorrection.bln = TRUE,     correctionArea.lst  = list( i=c(1:30) , j=c(72:101) ),     statCompare.bln     = TRUE ) row.names(diffAggreg.mtx) = c(rep(\"\",33),rep(\"*\",2),rep(\"\",31),rep(\"*\",2),rep(\"\",33)) colnames(diffAggreg.mtx) = c(rep(\"\",33),rep(\"*\",2),rep(\"\",31),rep(\"*\",2),rep(\"\",33))"},{"path":"/articles/Genomic2DTK.html","id":"plots","dir":"Articles","previous_headings":"Aggregations plots","what":"Plots","title":"Introduction to Genomic2DTK","text":"see ggAPA function create ggplot object (ggplot2::geom_raster)","code":"ggAPA(     apa.mtx   = aggreg.mtx,     title.chr = \"APA\" )"},{"path":"/articles/Genomic2DTK.html","id":"center","dir":"Articles","previous_headings":"Aggregations plots > Plots","what":"Center","title":"Introduction to Genomic2DTK","text":"center color scale.","code":"ggAPA(     apa.mtx    = aggreg.mtx,     title.chr  = \"APA center on 0.2\",     center.num = 0.2 )"},{"path":"/articles/Genomic2DTK.html","id":"trimming","dir":"Articles","previous_headings":"Aggregations plots > Plots","what":"Trimming","title":"Introduction to Genomic2DTK","text":"remove percentage value choose upper tail, lower tail tails distribution.","code":"ggAPA(     apa.mtx      = aggreg.mtx,     title.chr    = \"APA 30% trimmed on upper side\",     trimPrct.num = 30,     bounds.chr   = \"upper\" ) #> Warning in max(unlist(bounds.num_lst[1]), na.rm = TRUE): no non-missing #> arguments to max; returning -Inf ggAPA(     apa.mtx      = aggreg.mtx,     title.chr    = \"APA 30% trimmed on upper side\",     trimPrct.num = 30,     bounds.chr   = \"lower\" ) #> Warning in min(unlist(bounds.num_lst[2]), na.rm = TRUE): no non-missing #> arguments to min; returning Inf ggAPA(     apa.mtx      = aggreg.mtx,     title.chr    = \"APA 30% trimmed\",     trimPrct.num = 30,     bounds.chr   = \"both\" )"},{"path":"/articles/Genomic2DTK.html","id":"minmax","dir":"Articles","previous_headings":"Aggregations plots > Plots","what":"MinMax","title":"Introduction to Genomic2DTK","text":"also define minimal /maximal value color scale. use trimming options, function choose stringent options minimal maximal value.","code":"ggAPA(     apa.mtx         = aggreg.mtx,     title.chr       = \"APA [.15-.35]\",     minBoundary.num = 0.15,     maxBoundary.num = 0.35 )"},{"path":"/articles/Genomic2DTK.html","id":"colbreaks","dir":"Articles","previous_headings":"Aggregations plots > Plots","what":"ColBreaks","title":"Introduction to Genomic2DTK","text":"define color breaks","code":"ggAPA(     apa.mtx       = aggreg.mtx,     title.chr     = \"APA [.1, .2, .3, .4]\",     colBreaks.num = c(0.1,0.2,0.3,0.4) ) ggAPA(     apa.mtx       = aggreg.mtx,     title.chr     = \"APA [.10, .13, .16, .20, .30, .40]\",     colBreaks.num = c(0.1,0.13,0.16,0.2,0.3,0.4) ) ggAPA(     apa.mtx       = aggreg.mtx,     title.chr     = \"APA [.10, .20, .30, .33, .36, .40]\",     colBreaks.num = c(0.1,0.2,0.3,0.33,0.36,0.40) )"},{"path":"/articles/Genomic2DTK.html","id":"color-scale","dir":"Articles","previous_headings":"Aggregations plots > Plots","what":"Color Scale","title":"Introduction to Genomic2DTK","text":"show effect color scale biais.","code":"ggAPA(     apa.mtx    = aggreg.mtx,     title.chr  = \"APA\",     colorScale = \"density\" ) ggAPA(     apa.mtx     = aggreg.mtx,     title.chr   = \"APA\",     bias.num    = 2 ) ggAPA(     apa.mtx     = aggreg.mtx,     title.chr   = \"APA\",     bias.num    = 0.5 )"},{"path":"/articles/Genomic2DTK.html","id":"blurred","dir":"Articles","previous_headings":"Aggregations plots > Plots","what":"Blurred","title":"Introduction to Genomic2DTK","text":"option apply blurr heatmap remove noise.","code":"ggAPA(     apa.mtx           = aggreg.mtx,     title.chr         = \"APA\",     blurPass.num      = 1,     blurSd.num        = 0.5,     lowerTri.num = NA )"},{"path":"/articles/Genomic2DTK.html","id":"changed-color","dir":"Articles","previous_headings":"Aggregations plots > Plots","what":"Changed color","title":"Introduction to Genomic2DTK","text":"option change color heatmap color NA values.","code":"ggAPA(     apa.mtx     = aggreg.mtx,     title.chr   = \"APA\",     heatmap.col = ColorTK::viridis(6),     na.col      = \"black\" )"},{"path":"/articles/Genomic2DTK.html","id":"modifications","dir":"Articles","previous_headings":"Aggregations plots > Plots","what":"Modifications","title":"Introduction to Genomic2DTK","text":"function return ggplot object modify ggplot object ggplot2.","code":"ggAPA(     apa.mtx     = aggreg.mtx,     title.chr   = \"APA\", ) +  ggplot2::labs(     title    = \"New title\",     subtitle = \"and subtitle\" )"},{"path":"/articles/Genomic2DTK.html","id":"all-in-one-function","dir":"Articles","previous_headings":"Aggregations plots","what":"All in one function","title":"Introduction to Genomic2DTK","text":"one function plot matrix (matrices attributes ’s differential aggregation) different options put pdf.","code":"PlotAPA(     apa.mtx                  = diffAggreg.mtx,     out.dir                  = getwd(),     fileName.chr             = \"my_file_name\",     trimPrct.num             = 20,     minBoundary.num          = -2,     center.num               = 0,     maxBoundary.num          = 2,     minConditionBoundary.num = 0,     maxConditionBoundary.num = 2 )"},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Nicolas Chanard \\. Maintainer.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"\\<ff> NC (2022). Genomic2DTK: Set genomic interaction analysis tools. R package version 0.1.0.","code":"@Manual{,   title = {Genomic2DTK: Set of genomic interaction analysis tools},   author = {Nicolas Chanard \\},   year = {2022},   note = {R package version 0.1.0}, }"},{"path":"/index.html","id":"genomic2dtk-","dir":"","previous_headings":"","what":"Set of genomic interaction analysis tools","title":"Set of genomic interaction analysis tools","text":"Genomic2DTK set genomic interaction analysis tools.","code":""},{"path":"/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Set of genomic interaction analysis tools","text":"can install development version Genomic2DTK GitHub :","code":"devtools::install_github(\"NChanard/Genomic2DTK\")"},{"path":"/index.html","id":"documentation","dir":"","previous_headings":"","what":"Documentation","title":"Set of genomic interaction analysis tools","text":"Genomic2DTK","code":""},{"path":"/reference/Aggregation.html","id":null,"dir":"Reference","previous_headings":"","what":"Aggregation — Aggregation","title":"Aggregation — Aggregation","text":"aggregated matrices list. apply differential paired matrices two list aggregation.","code":""},{"path":"/reference/Aggregation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Aggregation — Aggregation","text":"","code":"Aggregation(   ctrlMatrices.lst = NULL,   matrices.lst = NULL,   minDist.num = NULL,   maxDist.num = NULL,   agg.fun = \"mean\",   rm0.bln = FALSE,   diff.fun = \"substraction\",   scaleCorrection.bln = TRUE,   correctionArea.lst = NULL,   statCompare.bln = FALSE )"},{"path":"/reference/Aggregation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Aggregation — Aggregation","text":"ctrlMatrices.lst <list[matrix]>: matrices list aggregate control. matrices.lst <list[matrix]>: matrices list aggregate. minDist.num <numeric>: minimal distance anchor bait. maxDist.num <numeric>: maximal distance anchor bait. agg.fun <chracter function>: function use aggregate pixel matrix. parameter character : \"50 \"+\" \"sum\" apply sum (Default) apply mean rm0.bln <logical>: TURE 0 replace NA. (Default FALSE) diff.fun <chracter function>: function use compute differential. parameter character : \"-\", \"substract\" \"substraction\" apply substraction \"/\" \"ratio\" apply ratio \"log2\",\"log2-\",\"log2/\" \"log2ratio\" apply log2 ratio (Default) apply log2 1+ratio scaleCorrection.bln <logical>: Whether correction done median value take ane noising area. (Default TRUE) correctionArea.lst <list>: Nested list indice define noising area fore correction. List muste contain first element \"\" (row indices) element called \"j\" (columns indices). NULL automatically take upper left part aggregated matrices. (Default NULL) statCompare.bln <logical>: Whether t.test must apply pxl differential aggregated matrix.","code":""},{"path":"/reference/Aggregation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Aggregation — Aggregation","text":"matrix","code":""},{"path":"/reference/ExtractSubmatrix.html","id":null,"dir":"Reference","previous_headings":"","what":"ExtractSubmatrix — ExtractSubmatrix","title":"ExtractSubmatrix — ExtractSubmatrix","text":"Extract matrices HiC maps list around genomic features.","code":""},{"path":"/reference/ExtractSubmatrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ExtractSubmatrix — ExtractSubmatrix","text":"","code":"ExtractSubmatrix(   feature.gn = NULL,   hic.cmx_lst = NULL,   referencePoint.chr = \"rf\",   res.num = NULL,   matriceDim.num = 21,   shiftFactor.num = 1,   cores.num = 1,   verbose.bln = TRUE )"},{"path":"/reference/ExtractSubmatrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ExtractSubmatrix — ExtractSubmatrix","text":"feature.gn <GRanges Pairs[GRanges] GInteractions>: genomic feature compute extraction HiC submatrix. hic.cmx_lst <List[contactMatrix]>: HiC maps list. referencePoint.chr <character>: character give kind extraction. \"rf\" extract regions \"pf\" extract points interactions. (Default \"rf\") res.num <numeric>: resoulution used hic.cmx_lst. NULL automatically find resolution attributes hic.cmx_lst. (Default NULL) matriceDim.num <numeric>: size matrices output. (Default 21). shiftFactor.num <numeric>: \"referencePoint.chr\" \"rf\". much distance anchor bait report region (Default 1). cores.num <integer> : integer specify number cores. (Default 1) verbose.bln <logical>: logical value. TRUE show progression console. (Default TRUE)","code":""},{"path":"/reference/ExtractSubmatrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ExtractSubmatrix — ExtractSubmatrix","text":"matrices list.","code":""},{"path":"/reference/FilterInteractions.html","id":null,"dir":"Reference","previous_headings":"","what":"FilterInteractions — FilterInteractions","title":"FilterInteractions — FilterInteractions","text":"Search GInteraction object interactions correspond ti target list return list index filter matrices list according target selection function.","code":""},{"path":"/reference/FilterInteractions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"FilterInteractions — FilterInteractions","text":"","code":"FilterInteractions(   matrices.lst = NULL,   interarctions.gni = NULL,   target.lst = NULL,   selection.fun = function() {      Reduce(intersect, interarctions.ndx_lst)  } )"},{"path":"/reference/FilterInteractions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"FilterInteractions — FilterInteractions","text":"matrices.lst <List[matrix]>: matrices list filter. NULL, function return filtred matrices list, else return list index. interarctions.gni <GInteractions>: GInteraction object compute filter. target.lst <List>: nammed list describe target. selection.fun <function>: function described target must cross. (Defaul intersection targets)","code":""},{"path":"/reference/FilterInteractions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"FilterInteractions — FilterInteractions","text":"list elements index filtred matrices list attributes updates.","code":""},{"path":"/reference/GetQuantif.html","id":null,"dir":"Reference","previous_headings":"","what":"GetQuantif — GetQuantif","title":"GetQuantif — GetQuantif","text":"Compute function matrix compose matrices list.","code":""},{"path":"/reference/GetQuantif.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"GetQuantif — GetQuantif","text":"","code":"GetQuantif(   matrices.lst,   area.fun = \"center\",   operation.fun = \"mean_rm0\",   name.chr = NULL )"},{"path":"/reference/GetQuantif.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"GetQuantif — GetQuantif","text":"matrices.lst <List[matrix]> : matrices list. area.fun <character function> : character function thaht alow extraction area matrix compose matrices lits (Default \"center\"). \"mean_rm0\" : apply mean replace 0 NA \"median_rm0\" : apply median replace 0 NA \"sum_rm0\" : apply sum replace 0 NA \"median\" : apply median \"sum\" : apply sum \"mean\" character :  apply mean operation.fun <character function> : character function applt  extracted area matrix compose matrices lits (Default \"mean_rm0\"). \"C\" \"CENTER\" : Take area interaction anchor bait. \"UL\" \"UPPER_LEFT\" : Take area interaction uppper left square \"UR\" \"UPPER_RIGHT\" : Take area interaction uppper right square \"BL\" \"BOTTOM_LEFT\" : Take area interaction bottom left square \"BR\" \"BOTTOM_RIGHT\" : Take area interaction bottom right square \"U\" \"UPPER\" : Take area interaction center area \"B\" \"BOTTOM\" : Take area interaction center area \"L\" \"LEFT\" : Take area interaction left center area \"R\" \"RIGHT\" : Take area interaction right center area \"D\" \"DONUT\" : Take area interaction surround center area name.chr <character> : name column GInteraction attributes matrices.lst used named output (Default NULL).","code":""},{"path":"/reference/GetQuantif.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"GetQuantif — GetQuantif","text":"GRange object.","code":""},{"path":"/reference/GnpToCm.html","id":null,"dir":"Reference","previous_headings":"","what":"GnpToCm — GnpToCm","title":"GnpToCm — GnpToCm","text":"Convert Pairs GRanges list ContactMatrix (matricies stored sparseMatrix format).","code":""},{"path":"/reference/GnpToCm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"GnpToCm — GnpToCm","text":"","code":"GnpToCm(   hic.gnp = NULL,   res.num = NULL,   chromSize.dtf = NULL,   verbose.bln = TRUE,   cores.num = 1 )"},{"path":"/reference/GnpToCm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"GnpToCm — GnpToCm","text":"hic.gnp <Pairs[GRanges]>: GRanges list GRanges GRangesList res.num <integer>: number resolution HiC. chromSize.dtf <data.frame>: data.frame genome first colum correspond chromosomes names, second column correspond chromosomes lengths base pairs. verbose.bln <logical>: logical value. TRUE show progression console. (Default TRUE) cores.num <integer> : integer specify number cores. (Default 1)","code":""},{"path":"/reference/GnpToCm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"GnpToCm — GnpToCm","text":"list ContactMatrix.","code":""},{"path":"/reference/IndexFeatures.html","id":null,"dir":"Reference","previous_headings":"","what":"IndexFeatures — IndexFeatures","title":"IndexFeatures — IndexFeatures","text":"Bin multiple GRanges summary one GRange. overlap ranges constraints regions","code":""},{"path":"/reference/IndexFeatures.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"IndexFeatures — IndexFeatures","text":"","code":"IndexFeatures(   gRange.gnr_lst = NULL,   constraint.gnr = NULL,   chromSize.dtf = NULL,   binSize.int = NULL,   method.chr = \"mean\",   variablesName.chr_vec = NULL,   cores.num = 1,   verbose.bln = TRUE )"},{"path":"/reference/IndexFeatures.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"IndexFeatures — IndexFeatures","text":"gRange.gnr_lst <GRanges GRangesList list[GRanges]>: GRanges list GRanges GRangesList constraint.gnr <GRanges>: GRange constraint regions. NULL chromosomes chromSize.dtf used (Default NULL) chromSize.dtf <data.frame>: data.frame genome first colum correspond chromosomes names, second column correspond chromosomes lengths base pairs. binSize.int <integer>: number specify width bins. method.chr <character>: string summary method name 'mean', 'median', 'sum', 'max, 'min'. (Default 'mean'') variablesName.chr_vec <character> : character vector specify metadata columns GRanges apply summary method. cores.num <integer> : integer specify number cores. (Default 1) verbose.bln <logical>: logical value. TRUE show progression console. (Default TRUE)","code":""},{"path":"/reference/IndexFeatures.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"IndexFeatures — IndexFeatures","text":"GRange object.","code":""},{"path":"/reference/OrienteMatrix.html","id":null,"dir":"Reference","previous_headings":"","what":"OrienteMatrix — OrienteMatrix","title":"OrienteMatrix — OrienteMatrix","text":"Apply 180° rotation follow transposation matrix matricies list according interactions attributes list.","code":""},{"path":"/reference/OrienteMatrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"OrienteMatrix — OrienteMatrix","text":"","code":"OrienteMatrix(matrice.mtx)"},{"path":"/reference/OrienteMatrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"OrienteMatrix — OrienteMatrix","text":"matrice.mtx <matrix List[matrix]>: matrix matricies list oriente","code":""},{"path":"/reference/OrienteMatrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"OrienteMatrix — OrienteMatrix","text":"Oriented matrix matricies list","code":""},{"path":"/reference/PlotAPA.html","id":null,"dir":"Reference","previous_headings":"","what":"DrawAPA — PlotAPA","title":"DrawAPA — PlotAPA","text":"Draw aggregation plot aggregation matrices.","code":""},{"path":"/reference/PlotAPA.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"DrawAPA — PlotAPA","text":"","code":"PlotAPA(   apa.mtx = NULL,   trimPrct.num = 0,   minBoundary.num = NULL,   center.num = NULL,   maxBoundary.num = NULL,   minConditionBoundary.num = NULL,   maxConditionBoundary.num = NULL )"},{"path":"/reference/PlotAPA.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"DrawAPA — PlotAPA","text":"apa.mtx <matrix>: aggregated matrix. trimPrct.num <numeric>: number 0 100 thaht give percentage triming matrices. minBoundary.num <matrix>: minimal value color scale. Null automaticaly find. center.num <matrix>: middle value color scale. Null automaticaly find. maxBoundary.num <matrix>: mximal value color scale. Null automaticaly find. minConditionBoundary.num <matrix>: Avalaible plotting differantial aggregation. minimal value color scale classsical aggregation plot. Null automaticaly find. maxConditionBoundary.num <matrix>: Avalaible plotting differantial aggregation. maxiaml value color scale classsical aggregation plot. Null automaticaly find.","code":""},{"path":"/reference/PlotAPA.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"DrawAPA — PlotAPA","text":"None","code":""},{"path":"/reference/SearchPairs.html","id":null,"dir":"Reference","previous_headings":"","what":"SearchPairs — SearchPairs","title":"SearchPairs — SearchPairs","text":"Compute pairs genomic features share range constraintes.","code":""},{"path":"/reference/SearchPairs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"SearchPairs — SearchPairs","text":"","code":"SearchPairs(   indexAnchor.gnr = NULL,   indexBait.gnr = NULL,   minDist.num = NULL,   maxDist.num = NULL,   verbose.bln = TRUE,   cores.num = 1 )"},{"path":"/reference/SearchPairs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"SearchPairs — SearchPairs","text":"indexAnchor.gnr <GRanges>: GRanges used first part pairs. indexBait.gnr <GRanges>: GRanges used second part pars. NULL replace indexAnchor.gnr (Default NULL) minDist.num <numeric>: minimal distance first second parts pairs. (Default NULL) maxDist.num <numeric>: maximal distance first second parts pairs. (Default NULL) verbose.bln <logical>: logical value. TRUE show progression console. (Default TRUE) cores.num <integer> : integer specify number cores. (Default 1)","code":""},{"path":"/reference/SearchPairs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"SearchPairs — SearchPairs","text":"GInteractions object.","code":""},{"path":"/reference/compound.html","id":null,"dir":"Reference","previous_headings":"","what":"Assignment pipe — %<>%","title":"Assignment pipe — %<>%","text":"See magrittr::%<>% details.","code":""},{"path":"/reference/compound.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assignment pipe — %<>%","text":"","code":"lhs %<>% rhs"},{"path":"/reference/compound.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assignment pipe — %<>%","text":"lhs object serves initial value target. rhs function call using magrittr semantics.","code":""},{"path":"/reference/compound.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assignment pipe — %<>%","text":"result calling `rhs(lhs)`.","code":""},{"path":"/reference/ggAPA.html","id":null,"dir":"Reference","previous_headings":"","what":"ggAPA — ggAPA","title":"ggAPA — ggAPA","text":"Create ggplot object used plot aggragation.","code":""},{"path":"/reference/ggAPA.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ggAPA — ggAPA","text":"","code":"ggAPA(   apa.mtx = NULL,   title.chr = NULL,   trimPrct.num = 0,   bounds.chr = \"both\",   minBoundary.num = NULL,   center.num = NULL,   maxBoundary.num = NULL,   colBreaks.num = NULL,   blurPass.num = 0,   blurBox.num = NULL,   blurSize.num = NULL,   blurSd.num = 0.5,   lowerTri.num = NULL,   heatmap.col = NULL,   na.col = \"#F2F2F2\",   colorScale.chr = \"linear\",   bias.num = 1,   paletteLength.num = 51 )"},{"path":"/reference/ggAPA.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ggAPA — ggAPA","text":"apa.mtx <matrix> : matrix plot. (Default NULL) title.chr <character> : title plot. (Default NULL) trimPrct.num <numeric> : number 0 100 give percentage trimming. (Default 0) bounds.chr <character> : boundary must trim, , trim half percentage inferior superior see StatTK::QtlThreshold. (Default \"\") minBoundary.num <numeric> : Minimal value Heatmap, force color range. Null automaticaly find. (Default NULL) center.num <numeric> : Center value Heatmap, force color range. Null automaticaly find. (Default NULL) maxBoundary.num <numeric> : Maximal value Heatmap, force color range. Null automaticaly find. (Default NULL) colBreaks.num <numeric> : Repartition colors. Null automaticaly find. (Default NULL) blurPass.num <numeric> : Number blur pass. (Default 0) blurBox.num <numeric> : null automaticaly compute 3 Sd. (Default NULL) blurSize.num <numeric> : Size box applied blurr null automaticaly compute 3 Sd. (Default NULL) blurSd.num <numeric> : SD gaussian smooth. (Default 0.5) lowerTri.num <numeric> : value replace value lower triangle matrice (Usefull blur apply). (Default NULL) heatmap.col <character> : Heatmap color list. null automaticaly compute. (Default NULL) na.col <character> : color NA values. (Default \"#F2F2F2\") colorScale.chr <character> :  shape color scale \"linear\" \"density\" based. (Default \"linear\") bias.num <numeric> : positive number.  Higher values give widely spaced colors high end. See ?grDevices::colorRamp details. (Default 1) paletteLength.num <numeric> : number color palette. (Default 51)","code":""},{"path":"/reference/ggAPA.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ggAPA — ggAPA","text":"ggplot object.","code":""},{"path":"/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"/reference/pipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipe operator — %>%","text":"lhs value magrittr placeholder. rhs function call using magrittr semantics.","code":""},{"path":"/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"result calling `rhs(lhs)`.","code":""}]
