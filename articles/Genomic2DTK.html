<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Here is a tutorial to learn about Genomic2DTK functions.
">
<title>Introduction to Genomic2DTK • Genomic2DTK</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to Genomic2DTK">
<meta property="og:description" content="Here is a tutorial to learn about Genomic2DTK functions.
">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">Genomic2DTK</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/Genomic2DTK.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Standard.html">Standard</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/NChanard/Genomic2DTK/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="Genomic2DTK_files/kePrint-0.0.1/kePrint.js"></script><link href="Genomic2DTK_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to Genomic2DTK</h1>
                        <h4 data-toc-skip class="author">Nicolas Chanard</h4>
            
            <h4 data-toc-skip class="date">2022-10-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/NChanard/Genomic2DTK/blob/HEAD/vignettes/Genomic2DTK.Rmd" class="external-link"><code>vignettes/Genomic2DTK.Rmd</code></a></small>
      <div class="d-none name"><code>Genomic2DTK.Rmd</code></div>
    </div>

    
    
<style>
body {
text-align: justify}
</style>
<style type="text/css">
pre {
  max-height: 300px;
  overflow-y: auto;
}

pre[class] {
  max-height: 300px;
}
</style>
<style type="text/css">
.scroll-100 {
  max-height: 100px;
  overflow-y: auto;
  background-color: inherit;
}
</style>
<div class="section level2">
<h2 id="firsts-steps">Firsts Steps<a class="anchor" aria-label="anchor" href="#firsts-steps"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"Nchanard/Genomic2DTK"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"Nchanard/GenomicED"</span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
<div class="section level2">
<h2 id="loads">Loads<a class="anchor" aria-label="anchor" href="#loads"></a>
</h2>
<div class="section level3">
<h3 id="library">Library<a class="anchor" aria-label="anchor" href="#library"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nchanard.github.io/Genomic2DTK/" class="external-link">Genomic2DTK</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nchanard.github.io/GenomicED/" class="external-link">GenomicED</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h3>
<p>Here we will load some testing data from sequencing in <em>Drosophila Melanogaster</em> on chromosomes 2L and 2R.</p>
<div class="section level4">
<h4 id="hic_ctrl-gnp">HiC_ctrl.gnp<a class="anchor" aria-label="anchor" href="#hic_ctrl-gnp"></a>
</h4>
<p>HiC data in control condition (depletion of Luc protein) in Pairs GRanges (bedpe) format and with 1KBp resolution.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"HiC_ctrl.gnp"</span><span class="op">)</span></span></code></pre></div>
<details><summary>
View
</summary><table class="table">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="4">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
First
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="4">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Second
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Metadata
</div>
</th>
</tr>
<tr>
<th style="text-align:right;">
seq
</th>
<th style="text-align:center;">
start
</th>
<th style="text-align:center;">
end
</th>
<th style="text-align:center;">
strand
</th>
<th style="text-align:right;">
seq
</th>
<th style="text-align:center;">
start
</th>
<th style="text-align:center;">
end
</th>
<th style="text-align:center;">
strand
</th>
<th style="text-align:center;">
name
</th>
<th style="text-align:center;">
score
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
73001
</td>
<td style="text-align:center;">
74000
</td>
<td style="text-align:center;">
<ul><li></ul>
</td>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
74001
</td>
<td style="text-align:center;">
75000
</td>
<td style="text-align:center;">
<ul><li></ul>
</td>
<td style="text-align:center;">
73000_74000
</td>
<td style="text-align:center;">
0.9
</td>
</tr>
<tr>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
74001
</td>
<td style="text-align:center;">
75000
</td>
<td style="text-align:center;">
<ul><li></ul>
</td>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
74001
</td>
<td style="text-align:center;">
75000
</td>
<td style="text-align:center;">
<ul><li></ul>
</td>
<td style="text-align:center;">
74000_74000
</td>
<td style="text-align:center;">
1.8
</td>
</tr>
<tr>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
75001
</td>
<td style="text-align:center;">
76000
</td>
<td style="text-align:center;">
<ul><li></ul>
</td>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
75001
</td>
<td style="text-align:center;">
76000
</td>
<td style="text-align:center;">
<ul><li></ul>
</td>
<td style="text-align:center;">
75000_75000
</td>
<td style="text-align:center;">
1.7
</td>
</tr>
</tbody>
</table></details>
</div>
<div class="section level4">
<h4 id="hic-gnp">HiC.gnp<a class="anchor" aria-label="anchor" href="#hic-gnp"></a>
</h4>
<p>HiC data under Beaf-32 depletion condition in Pairs GRanges (bedpe) format and with 1Kbp resolution.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"HiC.gnp"</span><span class="op">)</span></span></code></pre></div>
<details><summary>
View
</summary><table class="table">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="4">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
First
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="4">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Second
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Metadata
</div>
</th>
</tr>
<tr>
<th style="text-align:right;">
seq
</th>
<th style="text-align:center;">
start
</th>
<th style="text-align:center;">
end
</th>
<th style="text-align:center;">
strand
</th>
<th style="text-align:right;">
seq
</th>
<th style="text-align:center;">
start
</th>
<th style="text-align:center;">
end
</th>
<th style="text-align:center;">
strand
</th>
<th style="text-align:center;">
name
</th>
<th style="text-align:center;">
score
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
73001
</td>
<td style="text-align:center;">
74000
</td>
<td style="text-align:center;">
<ul><li></ul>
</td>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
73001
</td>
<td style="text-align:center;">
74000
</td>
<td style="text-align:center;">
<ul><li></ul>
</td>
<td style="text-align:center;">
73000_73000
</td>
<td style="text-align:center;">
2.3
</td>
</tr>
<tr>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
73001
</td>
<td style="text-align:center;">
74000
</td>
<td style="text-align:center;">
<ul><li></ul>
</td>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
74001
</td>
<td style="text-align:center;">
75000
</td>
<td style="text-align:center;">
<ul><li></ul>
</td>
<td style="text-align:center;">
73000_74000
</td>
<td style="text-align:center;">
1.1
</td>
</tr>
<tr>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
73001
</td>
<td style="text-align:center;">
74000
</td>
<td style="text-align:center;">
<ul><li></ul>
</td>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
75001
</td>
<td style="text-align:center;">
76000
</td>
<td style="text-align:center;">
<ul><li></ul>
</td>
<td style="text-align:center;">
73000_75000
</td>
<td style="text-align:center;">
2.9
</td>
</tr>
</tbody>
</table></details>
</div>
<div class="section level4">
<h4 id="anchors_peaks-gnr">anchors_Peaks.gnr<a class="anchor" aria-label="anchor" href="#anchors_peaks-gnr"></a>
</h4>
<p>ChIPseq data of Beaf-32 protein in wild type condition in GRanges format (bed).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"anchors_Peaks.gnr"</span><span class="op">)</span></span></code></pre></div>
<details><summary>
View
</summary><table class="table">
<thead><tr>
<th style="text-align:right;">
seq
</th>
<th style="text-align:center;">
start
</th>
<th style="text-align:center;">
end
</th>
<th style="text-align:center;">
strand
</th>
<th style="text-align:center;">
name
</th>
<th style="text-align:center;">
score
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
35594
</td>
<td style="text-align:center;">
35725
</td>
<td style="text-align:center;">
<ul><li></ul>
</td>
<td style="text-align:center;">
Beaf32_2
</td>
<td style="text-align:center;">
76
</td>
</tr>
<tr>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
47296
</td>
<td style="text-align:center;">
47470
</td>
<td style="text-align:center;">
<ul><li></ul>
</td>
<td style="text-align:center;">
Beaf32_3
</td>
<td style="text-align:center;">
44
</td>
</tr>
<tr>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
65770
</td>
<td style="text-align:center;">
65971
</td>
<td style="text-align:center;">
<ul><li></ul>
</td>
<td style="text-align:center;">
Beaf32_5
</td>
<td style="text-align:center;">
520
</td>
</tr>
</tbody>
</table></details>
</div>
<div class="section level4">
<h4 id="domains-gnr">domains.gnr<a class="anchor" aria-label="anchor" href="#domains-gnr"></a>
</h4>
<p>Data from TAD calling on HIC data in wild type (<a href="https://doi.org/10.1038/s41467-017-02525-w" class="external-link">F. Ramirez, 2018</a>).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"domains.gnr"</span><span class="op">)</span></span></code></pre></div>
<details><summary>
View
</summary><table class="table">
<thead><tr>
<th style="text-align:right;">
seq
</th>
<th style="text-align:center;">
start
</th>
<th style="text-align:center;">
end
</th>
<th style="text-align:center;">
strand
</th>
<th style="text-align:center;">
name
</th>
<th style="text-align:center;">
score
</th>
<th style="text-align:center;">
class
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
73104
</td>
<td style="text-align:center;">
94543
</td>
<td style="text-align:center;">
<ul><li></ul>
</td>
<td style="text-align:center;">
Tad_1
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
active
</td>
</tr>
<tr>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
94544
</td>
<td style="text-align:center;">
102930
</td>
<td style="text-align:center;">
<ul><li></ul>
</td>
<td style="text-align:center;">
Tad_2
</td>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
active
</td>
</tr>
<tr>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
102931
</td>
<td style="text-align:center;">
121473
</td>
<td style="text-align:center;">
<ul><li></ul>
</td>
<td style="text-align:center;">
Tad_3
</td>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
active
</td>
</tr>
</tbody>
</table></details>
</div>
<div class="section level4">
<h4 id="baits_peaks-gnr">baits_Peaks.gnr<a class="anchor" aria-label="anchor" href="#baits_peaks-gnr"></a>
</h4>
<p>Data from the UCSC data base.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"baits_Peaks.gnr"</span><span class="op">)</span></span></code></pre></div>
<details><summary>
View
</summary><table class="table">
<thead><tr>
<th style="text-align:right;">
seq
</th>
<th style="text-align:center;">
start
</th>
<th style="text-align:center;">
end
</th>
<th style="text-align:center;">
strand
</th>
<th style="text-align:center;">
name
</th>
<th style="text-align:center;">
class
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
71757
</td>
<td style="text-align:center;">
71757
</td>
<td style="text-align:center;">
<ul><li></ul>
</td>
<td style="text-align:center;">
FBgn0031213
</td>
<td style="text-align:center;">
active
</td>
</tr>
<tr>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
76348
</td>
<td style="text-align:center;">
76348
</td>
<td style="text-align:center;">
<ul><li></ul>
</td>
<td style="text-align:center;">
FBgn0031214
</td>
<td style="text-align:center;">
inactive
</td>
</tr>
<tr>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
106903
</td>
<td style="text-align:center;">
106903
</td>
<td style="text-align:center;">
<ul><li></ul>
</td>
<td style="text-align:center;">
FBgn0005278
</td>
<td style="text-align:center;">
active
</td>
</tr>
</tbody>
</table></details>
</div>
</div>
<div class="section level3">
<h3 id="genomic-informations">Genomic Informations<a class="anchor" aria-label="anchor" href="#genomic-informations"></a>
</h3>
<p>We complete the data with 2L and 2R chromosome sizes and HiC map resolution.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seqlengths.num</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'2L'</span><span class="op">=</span><span class="fl">23513712</span>, <span class="st">'2R'</span><span class="op">=</span><span class="fl">25286936</span><span class="op">)</span></span>
<span><span class="va">chromSize.dtf</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  seqnames   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">seqlengths.num</span> <span class="op">)</span>, </span>
<span>  seqlengths <span class="op">=</span> <span class="va">seqlengths.num</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">binSize.num</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="convert-hic-bedpe">Convert HiC bedpe<a class="anchor" aria-label="anchor" href="#convert-hic-bedpe"></a>
</h2>
<div class="section level3">
<h3 id="hic-control">HiC Control<a class="anchor" aria-label="anchor" href="#hic-control"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HiC_ctrl.cmx_lst</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GnpToCm.html">GnpToCm</a></span><span class="op">(</span></span>
<span>  hic.gnp       <span class="op">=</span> <span class="va">HiC_ctrl.gnp</span>,</span>
<span>  res.num       <span class="op">=</span> <span class="va">binSize.num</span>,</span>
<span>  chromSize.dtf <span class="op">=</span> <span class="va">chromSize.dtf</span>,</span>
<span>  cores.num     <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  verbose.bln   <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="hic-under-beaf-depletion">HiC under Beaf depletion<a class="anchor" aria-label="anchor" href="#hic-under-beaf-depletion"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HiC.cmx_lst</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GnpToCm.html">GnpToCm</a></span><span class="op">(</span></span>
<span>  hic.gnp       <span class="op">=</span> <span class="va">HiC.gnp</span>,</span>
<span>  res.num       <span class="op">=</span> <span class="va">binSize.num</span>,</span>
<span>  chromSize.dtf <span class="op">=</span> <span class="va">chromSize.dtf</span>,</span>
<span>  cores.num     <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  verbose.bln   <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="understand-results">Understand results<a class="anchor" aria-label="anchor" href="#understand-results"></a>
</h3>
<p>The result is a named list of Contactmatrix object where the matrix are dgCMatrix object (sparse matrix). Each element of the list corresponds to the interaction between two sequences (chromosomes). The name of each element corresponds to the names of the two sequences. For exemple, an element that would be named 2L_2R would correspond to the interaction of the 2L and 2R sequences.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HiC_ctrl.cmx_lst</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="co">#&gt; $`2L_2L`</span></span>
<span><span class="co">#&gt; class: ContactMatrix </span></span>
<span><span class="co">#&gt; dim: 23514 23514 </span></span>
<span><span class="co">#&gt; type: dgCMatrix </span></span>
<span><span class="co">#&gt; rownames: NULL</span></span>
<span><span class="co">#&gt; colnames: NULL</span></span>
<span><span class="co">#&gt; metadata(5): name type kind symmetric resolution</span></span>
<span><span class="co">#&gt; regions: 23514</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`2R_2R`</span></span>
<span><span class="co">#&gt; class: ContactMatrix </span></span>
<span><span class="co">#&gt; dim: 25287 25287 </span></span>
<span><span class="co">#&gt; type: dgCMatrix </span></span>
<span><span class="co">#&gt; rownames: NULL</span></span>
<span><span class="co">#&gt; colnames: NULL</span></span>
<span><span class="co">#&gt; metadata(5): name type kind symmetric resolution</span></span>
<span><span class="co">#&gt; regions: 25287</span></span>
<span><span class="co">#&gt;</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">HiC_ctrl.cmx_lst</span><span class="op">[[</span><span class="st">"2L_2L"</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">matrix</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "dgCMatrix"</span></span>
<span><span class="co">#&gt; attr(,"package")</span></span>
<span><span class="co">#&gt; [1] "Matrix"</span></span>
<span><span class="co">#&gt;</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">HiC_ctrl.cmx_lst</span><span class="op">[[</span><span class="st">"2L_2L"</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">matrix</span><span class="op">)</span></span>
<span><span class="co">#&gt; Formal class 'dgCMatrix' [package "Matrix"] with 6 slots</span></span>
<span><span class="co">#&gt;   ..@ i       : int [1:617185] 73 74 75 75 74 77 78 78 79 73 ...</span></span>
<span><span class="co">#&gt;   ..@ p       : int [1:23515] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">#&gt;   ..@ Dim     : int [1:2] 23514 23514</span></span>
<span><span class="co">#&gt;   ..@ Dimnames:List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ : NULL</span></span>
<span><span class="co">#&gt;   .. ..$ : NULL</span></span>
<span><span class="co">#&gt;   ..@ x       : num [1:617185] 0.899 1.772 1.729 2.185 2.752 ...</span></span>
<span><span class="co">#&gt;   ..@ factors : list()</span></span>
<span><span class="co">#&gt;</span></span></code></pre></div>
<p>See <a href="https://www.bioconductor.org/packages/release/bioc/vignettes/InteractionSet/inst/doc/interactions.html" class="external-link">InteractionSet</a> package for more details on ContactMatrix objects and see <a href="https://cran.r-project.org/web/packages/Matrix/Matrix.pdf" class="external-link">Matrix</a> package for more details on sparse matrices formats.<br>
If the element name is 2L_2R so, the Bin that make up the 2L and 2R sequences would be represented on the contact map (sparse matrix) by lines and columns respectively.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HiC_ctrl.cmx_lst</span><span class="op">[[</span><span class="st">"2L_2L"</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">matrix</span><span class="op">[</span><span class="fl">101</span><span class="op">:</span><span class="fl">110</span>,<span class="fl">101</span><span class="op">:</span><span class="fl">110</span><span class="op">]</span></span></code></pre></div>
<details><summary>
View
</summary><table class="table">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
bin 101
</th>
<th style="text-align:center;">
bin 102
</th>
<th style="text-align:center;">
bin 103
</th>
<th style="text-align:center;">
bin 104
</th>
<th style="text-align:center;">
bin 105
</th>
<th style="text-align:center;">
bin 106
</th>
<th style="text-align:center;">
bin 107
</th>
<th style="text-align:center;">
bin 108
</th>
<th style="text-align:center;">
bin 109
</th>
<th style="text-align:center;">
bin 110
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
bin 101
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.9
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
2.2
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;">
bin 102
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1.6
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
1.3
</td>
<td style="text-align:center;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;">
bin 103
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
2.1
</td>
<td style="text-align:center;">
2.1
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;">
bin 104
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
3.6
</td>
<td style="text-align:center;">
0.9
</td>
<td style="text-align:center;">
2.1
</td>
</tr>
<tr>
<td style="text-align:left;">
bin 105
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
2.3
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
3.3
</td>
</tr>
<tr>
<td style="text-align:left;">
bin 106
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;">
bin 107
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
2.3
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;">
bin 108
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0.6
</td>
<td style="text-align:center;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;">
bin 109
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
1.5
</td>
<td style="text-align:center;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;">
bin 110
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
1.7
</td>
</tr>
</tbody>
</table></details><p>Then the list have some attributes.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">HiC_ctrl.cmx_lst</span><span class="op">)</span></span>
<span><span class="co">#&gt; $names</span></span>
<span><span class="co">#&gt; [1] "2L_2L" "2R_2R"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $resolution</span></span>
<span><span class="co">#&gt; [1] 1000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $chromSize</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">#&gt;   seqnames seqlengths dimension</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 2L         23<span style="text-decoration: underline;">513</span>712     <span style="text-decoration: underline;">23</span>514</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 2R         25<span style="text-decoration: underline;">286</span>936     <span style="text-decoration: underline;">25</span>287</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $matricesKind</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 4</span></span></span>
<span><span class="co">#&gt;   name  type  kind  symmetric</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 2L_2L cis   U     TRUE     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 2R_2R cis   U     TRUE</span></span>
<span><span class="co">#&gt;</span></span></code></pre></div>
<p>And each element have metadata.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">S4Vectors</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Annotated-class.html" class="external-link">metadata</a></span><span class="op">(</span><span class="va">HiC_ctrl.cmx_lst</span><span class="op">[[</span><span class="st">"2L_2L"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; $name</span></span>
<span><span class="co">#&gt; [1] "2L_2L"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "cis"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $kind</span></span>
<span><span class="co">#&gt; [1] "U"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $symmetric</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $resolution</span></span>
<span><span class="co">#&gt; [1] 1000</span></span>
<span><span class="co">#&gt;</span></span></code></pre></div>
<ol style="list-style-type: decimal">
<li>
<strong>resolution</strong> : the resolution of the HiC map.<br>
</li>
<li>
<strong>chromSize</strong> : the size of the chromosomes in the tibble format.
<ul>
<li>
<em>seqnames</em> : the sequence name (chromosome name).<br>
</li>
<li>
<em>seqlengths</em> : the sequence length in base pairs.<br>
</li>
<li>
<em>dimension</em> : the sequence length in base bins<br>
</li>
</ul>
</li>
<li>
<strong>matricesKind</strong> : the kind of matrix that composes the list in the tibble format.
<ul>
<li>
<em>name</em> : the matrix name.</li>
<li>
<em>type</em> : the interaction kind. <em>“Cis”</em> for interactions on the same sequence and <em>“Trans”</em> for interactions on different sequences.<br>
</li>
<li>
<em>kind</em> : the matrix kind. U for upper triangle matrices, L for lower triangle matrices, NA for rectangular or square matrices. See<br>
</li>
<li>
<em>symmetric</em> : a boolean that indicates whether the matrix is symmetric (lower triangle identical to upper triangle).</li>
</ul>
</li>
</ol>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="genomic-features-indexing">Genomic Features Indexing<a class="anchor" aria-label="anchor" href="#genomic-features-indexing"></a>
</h2>
<div class="section level3">
<h3 id="tips">Tips<a class="anchor" aria-label="anchor" href="#tips"></a>
</h3>
<ol style="list-style-type: decimal">
<li>Put GRanges in a list allow to name the features. Here we name the feature <em>“Beaf”</em>.<br>
</li>
<li>If no regions constraint are used, chromosomes are used as constraints.<br>
</li>
<li>If multiples ranges are in a same bin you can choose variables (<code>variablesName.chr_vec</code>) that will be summary with a function (<code>method.chr</code>).</li>
</ol>
</div>
<div class="section level3">
<h3 id="indexing">Indexing<a class="anchor" aria-label="anchor" href="#indexing"></a>
</h3>
<div class="section level4">
<h4 id="anchors-beaf32">Anchors (Beaf32)<a class="anchor" aria-label="anchor" href="#anchors-beaf32"></a>
</h4>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">anchors_Index.gnr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/IndexFeatures.html">IndexFeatures</a></span><span class="op">(</span></span>
<span>  gRange.gnr_lst        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Beaf<span class="op">=</span><span class="va">anchors_Peaks.gnr</span><span class="op">)</span>, </span>
<span>  constraint.gnr        <span class="op">=</span> <span class="va">domains.gnr</span>,</span>
<span>  chromSize.dtf         <span class="op">=</span> <span class="va">chromSize.dtf</span>,</span>
<span>  binSize.int           <span class="op">=</span> <span class="va">binSize.num</span>,</span>
<span>  method.chr            <span class="op">=</span> <span class="st">"max"</span>,</span>
<span>  variablesName.chr_vec <span class="op">=</span> <span class="st">"score"</span>,</span>
<span>  <span class="co"># cores.num             = 1,</span></span>
<span>  verbose.bln           <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<details><summary>
View
</summary><table class="table">
<thead><tr>
<th style="text-align:left;">
seqnames
</th>
<th style="text-align:right;">
start
</th>
<th style="text-align:right;">
end
</th>
<th style="text-align:right;">
width
</th>
<th style="text-align:left;">
strand
</th>
<th style="text-align:left;">
name
</th>
<th style="text-align:left;">
bin
</th>
<th style="text-align:left;">
constraint
</th>
<th style="text-align:right;">
Beaf.score
</th>
<th style="text-align:left;">
Beaf.name
</th>
<th style="text-align:right;">
Beaf.bln
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
2L
</td>
<td style="text-align:right;">
73001
</td>
<td style="text-align:right;">
74000
</td>
<td style="text-align:right;">
1000
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:left;">
2L:74:Tad_1
</td>
<td style="text-align:left;">
2L:74
</td>
<td style="text-align:left;">
Tad_1
</td>
<td style="text-align:right;">
205
</td>
<td style="text-align:left;">
Beaf32_8
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
2L
</td>
<td style="text-align:right;">
74001
</td>
<td style="text-align:right;">
75000
</td>
<td style="text-align:right;">
1000
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:left;">
2L:75:Tad_1
</td>
<td style="text-align:left;">
2L:75
</td>
<td style="text-align:left;">
Tad_1
</td>
<td style="text-align:right;">
205
</td>
<td style="text-align:left;">
Beaf32_8
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
2L
</td>
<td style="text-align:right;">
102001
</td>
<td style="text-align:right;">
103000
</td>
<td style="text-align:right;">
1000
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:left;">
2L:103:Tad_2
</td>
<td style="text-align:left;">
2L:103
</td>
<td style="text-align:left;">
Tad_2
</td>
<td style="text-align:right;">
1830
</td>
<td style="text-align:left;">
Beaf32_11
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table></details>
</div>
<div class="section level4">
<h4 id="baits-transcription-starting-sites">Baits (Transcription Starting Sites)<a class="anchor" aria-label="anchor" href="#baits-transcription-starting-sites"></a>
</h4>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">baits_Index.gnr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/IndexFeatures.html">IndexFeatures</a></span><span class="op">(</span></span>
<span>  gRange.gnr_lst        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Tss<span class="op">=</span><span class="va">baits_Peaks.gnr</span><span class="op">)</span>,</span>
<span>  constraint.gnr        <span class="op">=</span> <span class="va">domains.gnr</span>,</span>
<span>  chromSize.dtf         <span class="op">=</span> <span class="va">chromSize.dtf</span>,</span>
<span>  binSize.int           <span class="op">=</span> <span class="va">binSize.num</span>,</span>
<span>  method.chr            <span class="op">=</span> <span class="st">"max"</span>,</span>
<span>  variablesName.chr_vec <span class="op">=</span> <span class="st">"score"</span>,</span>
<span>  cores.num             <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  verbose.bln           <span class="op">=</span> <span class="cn">FALSE</span> </span>
<span>  <span class="op">)</span></span></code></pre></div>
<details><summary>
View
</summary><table class="table">
<thead><tr>
<th style="text-align:left;">
seqnames
</th>
<th style="text-align:right;">
start
</th>
<th style="text-align:right;">
end
</th>
<th style="text-align:right;">
width
</th>
<th style="text-align:left;">
strand
</th>
<th style="text-align:left;">
name
</th>
<th style="text-align:left;">
bin
</th>
<th style="text-align:left;">
constraint
</th>
<th style="text-align:left;">
Tss.class
</th>
<th style="text-align:left;">
Tss.name
</th>
<th style="text-align:right;">
Tss.bln
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
2L
</td>
<td style="text-align:right;">
76001
</td>
<td style="text-align:right;">
77000
</td>
<td style="text-align:right;">
1000
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:left;">
2L:77:Tad_1
</td>
<td style="text-align:left;">
2L:77
</td>
<td style="text-align:left;">
Tad_1
</td>
<td style="text-align:left;">
inactive
</td>
<td style="text-align:left;">
FBgn0031214
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
2L
</td>
<td style="text-align:right;">
106001
</td>
<td style="text-align:right;">
107000
</td>
<td style="text-align:right;">
1000
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:left;">
2L:107:Tad_3
</td>
<td style="text-align:left;">
2L:107
</td>
<td style="text-align:left;">
Tad_3
</td>
<td style="text-align:left;">
active
</td>
<td style="text-align:left;">
FBgn0026787, FBgn0005278
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
2L
</td>
<td style="text-align:right;">
116001
</td>
<td style="text-align:right;">
117000
</td>
<td style="text-align:right;">
1000
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:left;">
2L:117:Tad_3
</td>
<td style="text-align:left;">
2L:117
</td>
<td style="text-align:left;">
Tad_3
</td>
<td style="text-align:left;">
active
</td>
<td style="text-align:left;">
FBgn0031219
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table></details>
Then we select only baits (TSS) with no anchors (Beaf) peak on same Bin.



<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">non_Overlaps.ndx</span> <span class="op">&lt;-</span> <span class="fu">SuperTK</span><span class="fu">::</span><span class="fu"><a href="https://nchanard.github.io/DevTK/reference/NotIn.html" class="external-link">NotIn</a></span><span class="op">(</span><span class="va">baits_Index.gnr</span><span class="op">$</span><span class="va">bin</span>,<span class="va">anchors_Index.gnr</span><span class="op">$</span><span class="va">bin</span><span class="op">)</span></span>
<span><span class="va">baits_Index.gnr</span> <span class="op">&lt;-</span> <span class="va">baits_Index.gnr</span><span class="op">[</span><span class="va">non_Overlaps.ndx</span>,<span class="op">]</span></span></code></pre></div>
<details><summary>
View
</summary><table class="table">
<thead><tr>
<th style="text-align:left;">
seqnames
</th>
<th style="text-align:right;">
start
</th>
<th style="text-align:right;">
end
</th>
<th style="text-align:right;">
width
</th>
<th style="text-align:left;">
strand
</th>
<th style="text-align:left;">
name
</th>
<th style="text-align:left;">
bin
</th>
<th style="text-align:left;">
constraint
</th>
<th style="text-align:left;">
Tss.class
</th>
<th style="text-align:left;">
Tss.name
</th>
<th style="text-align:right;">
Tss.bln
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
2L
</td>
<td style="text-align:right;">
76001
</td>
<td style="text-align:right;">
77000
</td>
<td style="text-align:right;">
1000
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:left;">
2L:77:Tad_1
</td>
<td style="text-align:left;">
2L:77
</td>
<td style="text-align:left;">
Tad_1
</td>
<td style="text-align:left;">
inactive
</td>
<td style="text-align:left;">
FBgn0031214
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
2L
</td>
<td style="text-align:right;">
106001
</td>
<td style="text-align:right;">
107000
</td>
<td style="text-align:right;">
1000
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:left;">
2L:107:Tad_3
</td>
<td style="text-align:left;">
2L:107
</td>
<td style="text-align:left;">
Tad_3
</td>
<td style="text-align:left;">
active
</td>
<td style="text-align:left;">
FBgn0026787, FBgn0005278
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
2L
</td>
<td style="text-align:right;">
116001
</td>
<td style="text-align:right;">
117000
</td>
<td style="text-align:right;">
1000
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:left;">
2L:117:Tad_3
</td>
<td style="text-align:left;">
2L:117
</td>
<td style="text-align:left;">
Tad_3
</td>
<td style="text-align:left;">
active
</td>
<td style="text-align:left;">
FBgn0031219
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table></details><hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="search-pairs">Search Pairs<a class="anchor" aria-label="anchor" href="#search-pairs"></a>
</h2>
<div class="section level3">
<h3 id="tips-1">Tips<a class="anchor" aria-label="anchor" href="#tips-1"></a>
</h3>
<ol style="list-style-type: decimal">
<li>if <code>indexBait.gnr</code> is NULL the function considers it to be equal to <code>indexAnchor.gnr</code>.</li>
<li>You could search pairs of feature that are between an certain distances. This selection can also be made on the resulting GInteraction object with the <code>FilterInteraction</code> function.</li>
</ol>
</div>
<div class="section level3">
<h3 id="pairing">Pairing<a class="anchor" aria-label="anchor" href="#pairing"></a>
</h3>
<p>Now we have two genomic features indexed on genome and we want search all putative Beaf-TSS pairs that share a same constraint (i.e: that are in the same Tad). The first element of the pair (beaf) is called <strong>Anchors</strong> and the second one (TSS) is called <strong>Bait</strong>. So a pair is always in order <strong>Anchors-Bait</strong> (as A is before B).</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interactions.gni</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SearchPairs.html">SearchPairs</a></span><span class="op">(</span></span>
<span>    indexAnchor.gnr <span class="op">=</span> <span class="va">anchors_Index.gnr</span>,</span>
<span>    indexBait.gnr   <span class="op">=</span> <span class="va">baits_Index.gnr</span>,</span>
<span>    minDist.num     <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>    maxDist.num     <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    cores.num       <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    verbose.bln     <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<details><summary>
View
</summary><table class="table">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="7">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Ranges
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="15">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Metadata
</div>
</th>
</tr>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Names
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
First
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Second
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="5">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Interaction
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="5">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Anchor
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="5">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Bait
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
seq
</th>
<th style="text-align:center;">
start
</th>
<th style="text-align:center;">
end
</th>
<th style="text-align:right;">
seq
</th>
<th style="text-align:center;">
start
</th>
<th style="text-align:center;">
end
</th>
<th style="text-align:center;">
name
</th>
<th style="text-align:center;">
constraint
</th>
<th style="text-align:center;">
distance
</th>
<th style="text-align:center;">
orientation
</th>
<th style="text-align:center;">
submatrix.name
</th>
<th style="text-align:center;">
name
</th>
<th style="text-align:center;">
bin
</th>
<th style="text-align:center;">
Beaf.name
</th>
<th style="text-align:center;">
Beaf.score
</th>
<th style="text-align:center;">
Beaf.bln
</th>
<th style="text-align:center;">
name
</th>
<th style="text-align:center;">
bin
</th>
<th style="text-align:center;">
Tss.name
</th>
<th style="text-align:center;">
Tss.class
</th>
<th style="text-align:center;">
Tss.bln
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
2L:74_2L:77
</td>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
73001
</td>
<td style="text-align:center;">
74000
</td>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
76001
</td>
<td style="text-align:center;">
77000
</td>
<td style="text-align:center;">
2L:74_2L:77
</td>
<td style="text-align:center;">
Tad_1
</td>
<td style="text-align:center;">
3000
</td>
<td style="text-align:center;">
TRUE
</td>
<td style="text-align:center;">
2L:74_2L:77
</td>
<td style="text-align:center;">
2L:74:Tad_1
</td>
<td style="text-align:center;">
2L:74
</td>
<td style="text-align:center;">
Beaf32_8
</td>
<td style="text-align:center;">
205
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
2L:77:Tad_1
</td>
<td style="text-align:center;">
2L:77
</td>
<td style="text-align:center;">
FBgn0031214
</td>
<td style="text-align:center;">
inactive
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
2L:75_2L:77
</td>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
74001
</td>
<td style="text-align:center;">
75000
</td>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
76001
</td>
<td style="text-align:center;">
77000
</td>
<td style="text-align:center;">
2L:75_2L:77
</td>
<td style="text-align:center;">
Tad_1
</td>
<td style="text-align:center;">
2000
</td>
<td style="text-align:center;">
TRUE
</td>
<td style="text-align:center;">
2L:75_2L:77
</td>
<td style="text-align:center;">
2L:75:Tad_1
</td>
<td style="text-align:center;">
2L:75
</td>
<td style="text-align:center;">
Beaf32_8
</td>
<td style="text-align:center;">
205
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
2L:77:Tad_1
</td>
<td style="text-align:center;">
2L:77
</td>
<td style="text-align:center;">
FBgn0031214
</td>
<td style="text-align:center;">
inactive
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
2L:115_2L:107
</td>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
114001
</td>
<td style="text-align:center;">
115000
</td>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
106001
</td>
<td style="text-align:center;">
107000
</td>
<td style="text-align:center;">
2L:115_2L:107
</td>
<td style="text-align:center;">
Tad_3
</td>
<td style="text-align:center;">
8000
</td>
<td style="text-align:center;">
FALSE
</td>
<td style="text-align:center;">
2L:107_2L:115
</td>
<td style="text-align:center;">
2L:115:Tad_3
</td>
<td style="text-align:center;">
2L:115
</td>
<td style="text-align:center;">
Beaf32_14
</td>
<td style="text-align:center;">
1707
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
2L:107:Tad_3
</td>
<td style="text-align:center;">
2L:107
</td>
<td style="text-align:center;">
FBgn0026787, FBgn0005278
</td>
<td style="text-align:center;">
active
</td>
<td style="text-align:center;">
1
</td>
</tr>
</tbody>
</table></details><hr>
</div>
</div>
<div class="section level2">
<h2 id="extractions">Extractions<a class="anchor" aria-label="anchor" href="#extractions"></a>
</h2>
<div class="section level3">
<h3 id="tips-2">Tips<a class="anchor" aria-label="anchor" href="#tips-2"></a>
</h3>
<ol style="list-style-type: decimal">
<li>If <code>res.num</code> is null, the function find it in the resolution attribute of <code>hic.cmx_lst</code>.</li>
<li>In <code>feature.gn</code> if each ranges overlap with just one Bin, i.e start and end of a GRanges or first and second element of a GInteraction (or GRanges Pairs) are in the same bin, so reference point is automatically <code>"pf"</code>.</li>
</ol>
</div>
<div class="section level3">
<h3 id="genomic-regions-or-domains">Genomic Regions or Domains<a class="anchor" aria-label="anchor" href="#genomic-regions-or-domains"></a>
</h3>
<p>On an HiC map, a genomic region is defined by a square (or a triangle if the matrice is triangular) along the diagonal of the Map, resulting in an extraction of square matrices where there diagonal are the diagonal of the HiC map. As not all regions have the same length, the extracted matrices do not have the same dimensions. These extracted matrices are therefore resized by the function.<br><img src="images/Extractions_of_Regions.png"><!-- --></p>
<div class="section level4">
<h4 id="regions-defined-with-ginteraction-object-or-pairs-granges">Regions defined with GInteraction object or Pairs GRanges<a class="anchor" aria-label="anchor" href="#regions-defined-with-ginteraction-object-or-pairs-granges"></a>
</h4>
<p>The region’s start is defined by the center of the first element and the region’s end by the center of the second element.<br><img src="images/Regions_GInteractions.png"><!-- --></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interactions_RFmatrix_ctrl.lst</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ExtractSubmatrix.html">ExtractSubmatrix</a></span><span class="op">(</span></span>
<span>  feature.gn         <span class="op">=</span> <span class="va">interactions.gni</span>,</span>
<span>  hic.cmx_lst        <span class="op">=</span> <span class="va">HiC_ctrl.cmx_lst</span>,</span>
<span>  res.num            <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  referencePoint.chr <span class="op">=</span> <span class="st">"rf"</span>,</span>
<span>  matriceDim.num     <span class="op">=</span> <span class="fl">101</span>,</span>
<span>  cores.num          <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  verbose.bln        <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="regions-defined-with-granges">Regions defined with GRanges<a class="anchor" aria-label="anchor" href="#regions-defined-with-granges"></a>
</h4>
<p>The regions are directly defined by the ranges of GRanges object.</p>
<p><img src="images/Regions_GRanges.png"><!-- --></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">domains_RFmatrix.lst</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ExtractSubmatrix.html">ExtractSubmatrix</a></span><span class="op">(</span></span>
<span>  feature.gn         <span class="op">=</span> <span class="va">domains.gnr</span>,</span>
<span>  hic.cmx_lst        <span class="op">=</span> <span class="va">HiC_ctrl.cmx_lst</span>,</span>
<span>  referencePoint.chr <span class="op">=</span> <span class="st">"rf"</span>,</span>
<span>  matriceDim.num     <span class="op">=</span> <span class="fl">101</span>,</span>
<span>  cores.num          <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  verbose.bln        <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="long-range-interactions">Long range interactions<a class="anchor" aria-label="anchor" href="#long-range-interactions"></a>
</h3>
<p>As we move away from the diagonal of the HiC map we have access to long range interactions that we can extract with more or less distant surrounding interactions resulting in an extraction of a square matrices centred on long range interactions.</p>
<p><img src="images/Extractions_of_LRI.png"><!-- --></p>
<div class="section level4">
<h4 id="interactions-defined-with-ginteraction-or-pairs-granges-">Interactions defined with GInteraction or Pairs GRanges.<a class="anchor" aria-label="anchor" href="#interactions-defined-with-ginteraction-or-pairs-granges-"></a>
</h4>
<p>In extracted matrices, the middle of Y axis correspond to the center of the first element and interact with the center of second element in the middle of X axis.</p>
<p><img src="images/LRI_GInteractions.png"><!-- --></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interactions_PFmatrix.lst</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ExtractSubmatrix.html">ExtractSubmatrix</a></span><span class="op">(</span></span>
<span>  feature.gn         <span class="op">=</span> <span class="va">interactions.gni</span>,</span>
<span>  hic.cmx_lst        <span class="op">=</span> <span class="va">HiC_ctrl.cmx_lst</span>,</span>
<span>  referencePoint.chr <span class="op">=</span> <span class="st">"pf"</span>,</span>
<span>  matriceDim.num     <span class="op">=</span> <span class="fl">41</span>,</span>
<span>  cores.num          <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  verbose.bln        <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="interactions-defined-with-granges-">Interactions defined with GRanges.<a class="anchor" aria-label="anchor" href="#interactions-defined-with-granges-"></a>
</h4>
<p>The middle of Y axis correspond to the start of the range and interact with the middle of X axis which correspond with the ends of the ranges.</p>
<p><img src="images/LRI_GRanges.png"><!-- --></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">domains_PFmatrix.lst</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ExtractSubmatrix.html">ExtractSubmatrix</a></span><span class="op">(</span></span>
<span>  feature.gn         <span class="op">=</span> <span class="va">domains.gnr</span>,</span>
<span>  hic.cmx_lst        <span class="op">=</span> <span class="va">HiC_ctrl.cmx_lst</span>,</span>
<span>  referencePoint.chr <span class="op">=</span> <span class="st">"pf"</span>,</span>
<span>  matriceDim.num     <span class="op">=</span> <span class="fl">41</span>,</span>
<span>  cores.num          <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  verbose.bln        <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="ponctual-interactions-along-diagonal-">Ponctual interactions along diagonal.<a class="anchor" aria-label="anchor" href="#ponctual-interactions-along-diagonal-"></a>
</h3>
<p>Here we want to extract fixed windows along the diagonal center on some points (Bins). <img src="images/Extractions_of_Ponctuals_Interactions.png"><!-- --></p>
<div class="section level4">
<h4 id="define-ponctual-interactions-">Define ponctual interactions.<a class="anchor" aria-label="anchor" href="#define-ponctual-interactions-"></a>
</h4>
<p>First, we want to create objects of points interaction along diagonal. For exemple and to achieve this we will take all the domains borders. The width of each ranges is put to 1 to force the start and end of ranges to be in a same bin.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">domains_Border.gnr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu">GenomicRanges</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/intra-range-methods.html" class="external-link">resize</a></span><span class="op">(</span><span class="va">domains.gnr</span>, <span class="fl">1</span>, <span class="st">"start"</span><span class="op">)</span>,</span>
<span>    <span class="fu">GenomicRanges</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/intra-range-methods.html" class="external-link">resize</a></span><span class="op">(</span><span class="va">domains.gnr</span>, <span class="fl">1</span>,  <span class="st">"end"</span> <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Probably some end of domains are found next to some beginning of other domains. In other words, these genomic locations are found on the same bin.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">domains_Border.gnr</span></span></code></pre></div>
Below ranges 2 and 3 are in this case.<br><details><summary>
View
</summary><table class="table">
<thead><tr>
<th style="text-align:right;">
seq
</th>
<th style="text-align:center;">
start
</th>
<th style="text-align:center;">
end
</th>
<th style="text-align:center;">
strand
</th>
<th style="text-align:center;">
name
</th>
<th style="text-align:center;">
score
</th>
<th style="text-align:center;">
class
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
73104
</td>
<td style="text-align:center;">
73104
</td>
<td style="text-align:center;">
<ul><li></ul>
</td>
<td style="text-align:center;">
Tad_1
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
active
</td>
</tr>
<tr>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
94543
</td>
<td style="text-align:center;">
94543
</td>
<td style="text-align:center;">
<ul><li></ul>
</td>
<td style="text-align:center;">
Tad_1
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
active
</td>
</tr>
<tr>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
94544
</td>
<td style="text-align:center;">
94544
</td>
<td style="text-align:center;">
<ul><li></ul>
</td>
<td style="text-align:center;">
Tad_2
</td>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
active
</td>
</tr>
</tbody>
</table></details>
If we use <code><a href="https://rdrr.io/pkg/IRanges/man/inter-range-methods.html" class="external-link">GenomicRanges::reduce</a></code> function we lost metadata.



<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">GenomicRanges</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/inter-range-methods.html" class="external-link">reduce</a></span><span class="op">(</span><span class="va">domains_Border.gnr</span><span class="op">)</span></span></code></pre></div>
<details><summary>
View
</summary><table class="table">
<thead><tr>
<th style="text-align:right;">
seq
</th>
<th style="text-align:center;">
start
</th>
<th style="text-align:center;">
end
</th>
<th style="text-align:center;">
strand
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
73104
</td>
<td style="text-align:center;">
73104
</td>
<td style="text-align:center;">
<ul><li></ul>
</td>
</tr>
<tr>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
94543
</td>
<td style="text-align:center;">
94544
</td>
<td style="text-align:center;">
<ul><li></ul>
</td>
</tr>
<tr>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
102930
</td>
<td style="text-align:center;">
102931
</td>
<td style="text-align:center;">
<ul><li></ul>
</td>
</tr>
</tbody>
</table></details>
So we can Bin the GRanges with the <code><a href="https://nchanard.github.io/GenomicTK/reference/BinGRanges.html" class="external-link">GenomicTK::BinGRanges</a></code> function at the HiC Resolution to keep metadata.



<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">domains_Border_Bin.gnr</span> <span class="op">&lt;-</span> <span class="fu">GenomicTK</span><span class="fu">::</span><span class="fu"><a href="https://nchanard.github.io/GenomicTK/reference/BinGRanges.html" class="external-link">BinGRanges</a></span><span class="op">(</span></span>
<span>  gRange.gnr  <span class="op">=</span> <span class="va">domains_Border.gnr</span>,</span>
<span>  binSize.int <span class="op">=</span> <span class="va">binSize.num</span>,</span>
<span>  verbose.bln <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Here we see that we conserve metadata and in Bin 2L:95 we have Tad_1 and Tad_2.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">domains_Border_Bin.gnr</span></span></code></pre></div>
<details><summary>
View
</summary><table class="table">
<thead><tr>
<th style="text-align:right;">
seq
</th>
<th style="text-align:center;">
start
</th>
<th style="text-align:center;">
end
</th>
<th style="text-align:center;">
strand
</th>
<th style="text-align:center;">
name
</th>
<th style="text-align:center;">
score
</th>
<th style="text-align:center;">
class
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
73001
</td>
<td style="text-align:center;">
74000
</td>
<td style="text-align:center;">
<ul><li></ul>
</td>
<td style="text-align:center;">
Tad_1
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
active
</td>
</tr>
<tr>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
94001
</td>
<td style="text-align:center;">
95000
</td>
<td style="text-align:center;">
<ul><li></ul>
</td>
<td style="text-align:center;">
Tad_1, Tad_2
</td>
<td style="text-align:center;">
3, 8
</td>
<td style="text-align:center;">
active
</td>
</tr>
<tr>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
102001
</td>
<td style="text-align:center;">
103000
</td>
<td style="text-align:center;">
<ul><li></ul>
</td>
<td style="text-align:center;">
Tad_2, Tad_3
</td>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
active
</td>
</tr>
</tbody>
</table></details><p>In addition, Tad_1 is in Bin 2L:74 and 2L:95, So we need to put an unique name to each ranges (=bin) and keep Tad names in a new variables.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">domains_Border_Bin.gnr</span><span class="op">$</span><span class="va">subname</span> <span class="op">&lt;-</span> <span class="va">domains_Border_Bin.gnr</span><span class="op">$</span><span class="va">name</span></span>
<span><span class="va">domains_Border_Bin.gnr</span><span class="op">$</span><span class="va">name</span>    <span class="op">&lt;-</span> <span class="va">domains_Border_Bin.gnr</span><span class="op">$</span><span class="va">bin</span></span></code></pre></div>
<details><summary>
View
</summary><table class="table">
<thead><tr>
<th style="text-align:right;">
seq
</th>
<th style="text-align:center;">
start
</th>
<th style="text-align:center;">
end
</th>
<th style="text-align:center;">
strand
</th>
<th style="text-align:center;">
name
</th>
<th style="text-align:center;">
score
</th>
<th style="text-align:center;">
class
</th>
<th style="text-align:center;">
bin
</th>
<th style="text-align:center;">
subname
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
73001
</td>
<td style="text-align:center;">
74000
</td>
<td style="text-align:center;">
<ul><li></ul>
</td>
<td style="text-align:center;">
2L:74
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
active
</td>
<td style="text-align:center;">
2L:74
</td>
<td style="text-align:center;">
Tad_1
</td>
</tr>
<tr>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
94001
</td>
<td style="text-align:center;">
95000
</td>
<td style="text-align:center;">
<ul><li></ul>
</td>
<td style="text-align:center;">
2L:95
</td>
<td style="text-align:center;">
3, 8
</td>
<td style="text-align:center;">
active
</td>
<td style="text-align:center;">
2L:95
</td>
<td style="text-align:center;">
Tad_1, Tad_2
</td>
</tr>
<tr>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
102001
</td>
<td style="text-align:center;">
103000
</td>
<td style="text-align:center;">
<ul><li></ul>
</td>
<td style="text-align:center;">
2L:103
</td>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
active
</td>
<td style="text-align:center;">
2L:103
</td>
<td style="text-align:center;">
Tad_2, Tad_3
</td>
</tr>
</tbody>
</table></details>
Now we have a GRanges object. And for the exemples below we will need the same informations but in an GInteraction object.



<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">domains_Border_Bin.gni</span> <span class="op">&lt;-</span> <span class="fu">InteractionSet</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/InteractionSet/man/GInteractions-class.html" class="external-link">GInteractions</a></span><span class="op">(</span><span class="va">domains_Border_Bin.gnr</span>,<span class="va">domains_Border_Bin.gnr</span><span class="op">)</span></span></code></pre></div>
<details><summary>
View
</summary><table class="table">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="8">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
First
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="8">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Second
</div>
</th>
</tr>
<tr>
<th style="text-align:right;">
seq
</th>
<th style="text-align:center;">
start
</th>
<th style="text-align:center;">
end
</th>
<th style="text-align:right;">
name
</th>
<th style="text-align:center;">
score
</th>
<th style="text-align:center;">
class
</th>
<th style="text-align:center;">
bin
</th>
<th style="text-align:center;">
subname
</th>
<th style="text-align:center;">
seq
</th>
<th style="text-align:center;">
start
</th>
<th style="text-align:center;">
end
</th>
<th style="text-align:center;">
name
</th>
<th style="text-align:center;">
score
</th>
<th style="text-align:center;">
class
</th>
<th style="text-align:center;">
bin
</th>
<th style="text-align:center;">
subname
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
73001
</td>
<td style="text-align:center;">
74000
</td>
<td style="text-align:right;">
2L:74
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
active
</td>
<td style="text-align:center;">
2L:74
</td>
<td style="text-align:center;">
Tad_1
</td>
<td style="text-align:center;">
2L
</td>
<td style="text-align:center;">
73001
</td>
<td style="text-align:center;">
74000
</td>
<td style="text-align:center;">
2L:74
</td>
<td style="text-align:center;">
active
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
2L:74
</td>
<td style="text-align:center;">
Tad_1
</td>
</tr>
<tr>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
94001
</td>
<td style="text-align:center;">
95000
</td>
<td style="text-align:right;">
2L:95
</td>
<td style="text-align:center;">
3, 8
</td>
<td style="text-align:center;">
active
</td>
<td style="text-align:center;">
2L:95
</td>
<td style="text-align:center;">
Tad_1, Tad_2
</td>
<td style="text-align:center;">
2L
</td>
<td style="text-align:center;">
94001
</td>
<td style="text-align:center;">
95000
</td>
<td style="text-align:center;">
2L:95
</td>
<td style="text-align:center;">
active
</td>
<td style="text-align:center;">
3, 8
</td>
<td style="text-align:center;">
2L:95
</td>
<td style="text-align:center;">
Tad_1, Tad_2
</td>
</tr>
<tr>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
102001
</td>
<td style="text-align:center;">
103000
</td>
<td style="text-align:right;">
2L:103
</td>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
active
</td>
<td style="text-align:center;">
2L:103
</td>
<td style="text-align:center;">
Tad_2, Tad_3
</td>
<td style="text-align:center;">
2L
</td>
<td style="text-align:center;">
102001
</td>
<td style="text-align:center;">
103000
</td>
<td style="text-align:center;">
2L:103
</td>
<td style="text-align:center;">
active
</td>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
2L:103
</td>
<td style="text-align:center;">
Tad_2, Tad_3
</td>
</tr>
</tbody>
</table></details>
</div>
<div class="section level4">
<h4 id="ponctual-interactions-defined-with-granges">Ponctual interactions defined with GRanges<a class="anchor" aria-label="anchor" href="#ponctual-interactions-defined-with-granges"></a>
</h4>
<p>Here the start and the end of each ranges are in a same bin.</p>
<p><img src="images/Ponctuals_Interactions_GRanges.png"><!-- --></p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">border_PFmatrix.lst</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ExtractSubmatrix.html">ExtractSubmatrix</a></span><span class="op">(</span></span>
<span>  feature.gn         <span class="op">=</span> <span class="va">domains_Border_Bin.gnr</span>,</span>
<span>  hic.cmx_lst        <span class="op">=</span> <span class="va">HiC_ctrl.cmx_lst</span>,</span>
<span>  referencePoint.chr <span class="op">=</span> <span class="st">"pf"</span>,</span>
<span>  matriceDim.num     <span class="op">=</span> <span class="fl">101</span>,</span>
<span>  verbose.bln        <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="ponctual-interactions-defined-with-ginteractions">Ponctual interactions defined with GInteractions<a class="anchor" aria-label="anchor" href="#ponctual-interactions-defined-with-ginteractions"></a>
</h4>
<p>Here the first element (blue on scheme) is in the same bin as the second (red on scheme).</p>
<p><img src="images/Ponctuals_Interactions_GInteractions.png"><!-- --></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">border_PFmatrix.lst</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ExtractSubmatrix.html">ExtractSubmatrix</a></span><span class="op">(</span></span>
<span>  feature.gn         <span class="op">=</span> <span class="va">domains_Border_Bin.gni</span>,</span>
<span>  hic.cmx_lst        <span class="op">=</span> <span class="va">HiC_ctrl.cmx_lst</span>,</span>
<span>  referencePoint.chr <span class="op">=</span> <span class="st">"pf"</span>,</span>
<span>  matriceDim.num     <span class="op">=</span> <span class="fl">101</span>,</span>
<span>  verbose.bln        <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="filtrations">Filtrations<a class="anchor" aria-label="anchor" href="#filtrations"></a>
</h2>
<p>In this section we will see how to select interactions in GInteraction object or in matrices in extracted Matrices list.</p>
<div class="section level3">
<h3 id="tips-3">Tips<a class="anchor" aria-label="anchor" href="#tips-3"></a>
</h3>
<ol style="list-style-type: decimal">
<li>Filter an GInterction object allow to cross the selection indices as you want.<br>
</li>
<li>Filter a matrices list without selection is better than filter the interaction attributes of the matrices list</li>
</ol>
</div>
<div class="section level3">
<h3 id="target-list">Target list<a class="anchor" aria-label="anchor" href="#target-list"></a>
</h3>
<p>Target list must have a particular structure. First it is a named list. Each name of each element must be the name of column in the GInteraction that you want filter (or in the attributes “interactions” of the matrices list you want filter. Then each element must be a character list to match to this column or a function that will test each row in the column and return a bolean.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">structureTarget.lst</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  first_colname_of_GInteraction  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"value"</span><span class="op">)</span>,</span>
<span>  second_colname_of_GInteraction <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">eachElement</span><span class="op">)</span><span class="op">{</span><span class="va">min_th</span><span class="op">&lt;</span><span class="va">value</span> <span class="op">&amp;&amp;</span> <span class="va">value</span><span class="op">&lt;</span><span class="va">max_th</span><span class="op">}</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>First, let’s look the GInteractions columns names (metadata of interactions attributes of our matrices list)</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu">S4Vectors</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">mcols</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">interactions_RFmatrix_ctrl.lst</span><span class="op">)</span><span class="op">$</span><span class="va">interactions</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Here a look of</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">interactions_RFmatrix_ctrl.lst</span><span class="op">)</span><span class="op">$</span><span class="va">interactions</span></span></code></pre></div>
<details><summary>
View
</summary><table class="table">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="7">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Ranges
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="15">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Metadata
</div>
</th>
</tr>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Names
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
First
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Second
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="5">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Interaction
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="5">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Anchor
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="5">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Bait
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
seq
</th>
<th style="text-align:center;">
start
</th>
<th style="text-align:center;">
end
</th>
<th style="text-align:right;">
seq
</th>
<th style="text-align:center;">
start
</th>
<th style="text-align:center;">
end
</th>
<th style="text-align:center;">
name
</th>
<th style="text-align:center;">
constraint
</th>
<th style="text-align:center;">
distance
</th>
<th style="text-align:center;">
orientation
</th>
<th style="text-align:center;">
submatrix.name
</th>
<th style="text-align:center;">
name
</th>
<th style="text-align:center;">
bin
</th>
<th style="text-align:center;">
Beaf.name
</th>
<th style="text-align:center;">
Beaf.score
</th>
<th style="text-align:center;">
Beaf.bln
</th>
<th style="text-align:center;">
name
</th>
<th style="text-align:center;">
bin
</th>
<th style="text-align:center;">
Tss.name
</th>
<th style="text-align:center;">
Tss.class
</th>
<th style="text-align:center;">
Tss.bln
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
2L:74_2L:77
</td>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
73001
</td>
<td style="text-align:center;">
74000
</td>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
76001
</td>
<td style="text-align:center;">
77000
</td>
<td style="text-align:center;">
2L:74_2L:77
</td>
<td style="text-align:center;">
Tad_1
</td>
<td style="text-align:center;">
3000
</td>
<td style="text-align:center;">
TRUE
</td>
<td style="text-align:center;">
2L:74_2L:77
</td>
<td style="text-align:center;">
2L:74:Tad_1
</td>
<td style="text-align:center;">
2L:74
</td>
<td style="text-align:center;">
Beaf32_8
</td>
<td style="text-align:center;">
205
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
2L:77:Tad_1
</td>
<td style="text-align:center;">
2L:77
</td>
<td style="text-align:center;">
FBgn0031214
</td>
<td style="text-align:center;">
inactive
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
2L:115_2L:107
</td>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
114001
</td>
<td style="text-align:center;">
115000
</td>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
106001
</td>
<td style="text-align:center;">
107000
</td>
<td style="text-align:center;">
2L:115_2L:107
</td>
<td style="text-align:center;">
Tad_3
</td>
<td style="text-align:center;">
8000
</td>
<td style="text-align:center;">
FALSE
</td>
<td style="text-align:center;">
2L:107_2L:115
</td>
<td style="text-align:center;">
2L:115:Tad_3
</td>
<td style="text-align:center;">
2L:115
</td>
<td style="text-align:center;">
Beaf32_14
</td>
<td style="text-align:center;">
1707
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
2L:107:Tad_3
</td>
<td style="text-align:center;">
2L:107
</td>
<td style="text-align:center;">
FBgn0026787, FBgn0005278
</td>
<td style="text-align:center;">
active
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
2L:121_2L:107
</td>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
120001
</td>
<td style="text-align:center;">
121000
</td>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
106001
</td>
<td style="text-align:center;">
107000
</td>
<td style="text-align:center;">
2L:121_2L:107
</td>
<td style="text-align:center;">
Tad_3
</td>
<td style="text-align:center;">
14000
</td>
<td style="text-align:center;">
FALSE
</td>
<td style="text-align:center;">
2L:107_2L:121
</td>
<td style="text-align:center;">
2L:121:Tad_3
</td>
<td style="text-align:center;">
2L:121
</td>
<td style="text-align:center;">
Beaf32_15
</td>
<td style="text-align:center;">
484
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
2L:107:Tad_3
</td>
<td style="text-align:center;">
2L:107
</td>
<td style="text-align:center;">
FBgn0026787, FBgn0005278
</td>
<td style="text-align:center;">
active
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
2L:121_2L:117
</td>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
120001
</td>
<td style="text-align:center;">
121000
</td>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
116001
</td>
<td style="text-align:center;">
117000
</td>
<td style="text-align:center;">
2L:121_2L:117
</td>
<td style="text-align:center;">
Tad_3
</td>
<td style="text-align:center;">
4000
</td>
<td style="text-align:center;">
FALSE
</td>
<td style="text-align:center;">
2L:117_2L:121
</td>
<td style="text-align:center;">
2L:121:Tad_3
</td>
<td style="text-align:center;">
2L:121
</td>
<td style="text-align:center;">
Beaf32_15
</td>
<td style="text-align:center;">
484
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
2L:117:Tad_3
</td>
<td style="text-align:center;">
2L:117
</td>
<td style="text-align:center;">
FBgn0031219
</td>
<td style="text-align:center;">
active
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
2L:274_2L:268
</td>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
273001
</td>
<td style="text-align:center;">
274000
</td>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
267001
</td>
<td style="text-align:center;">
268000
</td>
<td style="text-align:center;">
2L:274_2L:268
</td>
<td style="text-align:center;">
Tad_10
</td>
<td style="text-align:center;">
6000
</td>
<td style="text-align:center;">
FALSE
</td>
<td style="text-align:center;">
2L:268_2L:274
</td>
<td style="text-align:center;">
2L:274:Tad_10
</td>
<td style="text-align:center;">
2L:274
</td>
<td style="text-align:center;">
Beaf32_39
</td>
<td style="text-align:center;">
210
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
2L:268:Tad_10
</td>
<td style="text-align:center;">
2L:268
</td>
<td style="text-align:center;">
FBgn0031239
</td>
<td style="text-align:center;">
inactive
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
2L:278_2L:268
</td>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
277001
</td>
<td style="text-align:center;">
278000
</td>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
267001
</td>
<td style="text-align:center;">
268000
</td>
<td style="text-align:center;">
2L:278_2L:268
</td>
<td style="text-align:center;">
Tad_10
</td>
<td style="text-align:center;">
10000
</td>
<td style="text-align:center;">
FALSE
</td>
<td style="text-align:center;">
2L:268_2L:278
</td>
<td style="text-align:center;">
2L:278:Tad_10
</td>
<td style="text-align:center;">
2L:278
</td>
<td style="text-align:center;">
Beaf32_41
</td>
<td style="text-align:center;">
1641
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
2L:268:Tad_10
</td>
<td style="text-align:center;">
2L:268
</td>
<td style="text-align:center;">
FBgn0031239
</td>
<td style="text-align:center;">
inactive
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
2L:274_2L:279
</td>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
273001
</td>
<td style="text-align:center;">
274000
</td>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
278001
</td>
<td style="text-align:center;">
279000
</td>
<td style="text-align:center;">
2L:274_2L:279
</td>
<td style="text-align:center;">
Tad_10
</td>
<td style="text-align:center;">
5000
</td>
<td style="text-align:center;">
TRUE
</td>
<td style="text-align:center;">
2L:274_2L:279
</td>
<td style="text-align:center;">
2L:274:Tad_10
</td>
<td style="text-align:center;">
2L:274
</td>
<td style="text-align:center;">
Beaf32_39
</td>
<td style="text-align:center;">
210
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
2L:279:Tad_10
</td>
<td style="text-align:center;">
2L:279
</td>
<td style="text-align:center;">
FBgn0086855
</td>
<td style="text-align:center;">
active
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
2L:306_2L:320
</td>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
305001
</td>
<td style="text-align:center;">
306000
</td>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
319001
</td>
<td style="text-align:center;">
320000
</td>
<td style="text-align:center;">
2L:306_2L:320
</td>
<td style="text-align:center;">
Tad_13
</td>
<td style="text-align:center;">
14000
</td>
<td style="text-align:center;">
TRUE
</td>
<td style="text-align:center;">
2L:306_2L:320
</td>
<td style="text-align:center;">
2L:306:Tad_13
</td>
<td style="text-align:center;">
2L:306
</td>
<td style="text-align:center;">
Beaf32_48
</td>
<td style="text-align:center;">
52
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
2L:320:Tad_13
</td>
<td style="text-align:center;">
2L:320
</td>
<td style="text-align:center;">
FBgn0031248
</td>
<td style="text-align:center;">
inactive
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
2L:471_2L:422
</td>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
470001
</td>
<td style="text-align:center;">
471000
</td>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
421001
</td>
<td style="text-align:center;">
422000
</td>
<td style="text-align:center;">
2L:471_2L:422
</td>
<td style="text-align:center;">
Tad_17
</td>
<td style="text-align:center;">
49000
</td>
<td style="text-align:center;">
FALSE
</td>
<td style="text-align:center;">
2L:422_2L:471
</td>
<td style="text-align:center;">
2L:471:Tad_17
</td>
<td style="text-align:center;">
2L:471
</td>
<td style="text-align:center;">
Beaf32_62
</td>
<td style="text-align:center;">
37
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
2L:422:Tad_17
</td>
<td style="text-align:center;">
2L:422
</td>
<td style="text-align:center;">
FBgn0031253
</td>
<td style="text-align:center;">
active
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
2L:472_2L:422
</td>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
471001
</td>
<td style="text-align:center;">
472000
</td>
<td style="text-align:right;">
2L
</td>
<td style="text-align:center;">
421001
</td>
<td style="text-align:center;">
422000
</td>
<td style="text-align:center;">
2L:472_2L:422
</td>
<td style="text-align:center;">
Tad_17
</td>
<td style="text-align:center;">
50000
</td>
<td style="text-align:center;">
FALSE
</td>
<td style="text-align:center;">
2L:422_2L:472
</td>
<td style="text-align:center;">
2L:472:Tad_17
</td>
<td style="text-align:center;">
2L:472
</td>
<td style="text-align:center;">
Beaf32_62
</td>
<td style="text-align:center;">
37
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
2L:422:Tad_17
</td>
<td style="text-align:center;">
2L:422
</td>
<td style="text-align:center;">
FBgn0031253
</td>
<td style="text-align:center;">
active
</td>
<td style="text-align:center;">
1
</td>
</tr>
</tbody>
</table></details><p>Now lets create a target with:</p>
<ol style="list-style-type: decimal">
<li>“Beaf32_8” and “Beaf32_15” in <strong>anchor.Beaf.name</strong>
</li>
<li>“FBgn0031214” and “FBgn0005278” in <strong>bait.Tss.name</strong><br>
</li>
<li>“2L:74_2L:77” in <strong>name</strong><br>
</li>
<li>
<strong>distance</strong> exactly equal to 14000 or 3000</li>
</ol>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">target.lst</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  anchor.Beaf.name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Beaf32_8"</span>,<span class="st">"Beaf32_15"</span><span class="op">)</span>,</span>
<span>  bait.Tss.name    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FBgn0031214"</span>,<span class="st">"FBgn0005278"</span><span class="op">)</span>,</span>
<span>  name             <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2L:74_2L:77"</span><span class="op">)</span>,</span>
<span>  distance         <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">columnElement</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">14000</span><span class="op">==</span><span class="va">columnElement</span> <span class="op">||</span> <span class="va">columnElement</span> <span class="op">==</span> <span class="fl">3000</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="filtration-without-selection">Filtration without selection<a class="anchor" aria-label="anchor" href="#filtration-without-selection"></a>
</h3>
<p>When you don’t specify any selection ways the function will return all indices for each target in the list. That will allow you to cross the indices to select want you want in a second step.</p>
<div class="section level4">
<h4 id="ginteraction-filtration">GInteraction filtration<a class="anchor" aria-label="anchor" href="#ginteraction-filtration"></a>
</h4>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/FilterInteractions.html">FilterInteractions</a></span><span class="op">(</span></span>
<span>  interarctions.gni <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">interactions_RFmatrix_ctrl.lst</span><span class="op">)</span><span class="op">$</span><span class="va">interactions</span>,</span>
<span>  target.lst        <span class="op">=</span> <span class="va">target.lst</span>,</span>
<span>  selection.fun     <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 4</span></span>
<span><span class="co">#&gt;  $ anchor.Beaf.name: int [1:3] 1 3 4</span></span>
<span><span class="co">#&gt;  $ bait.Tss.name   : int [1:3] 1 2 3</span></span>
<span><span class="co">#&gt;  $ name            : int 1</span></span>
<span><span class="co">#&gt;  $ distance        : int [1:25] 1 3 8 24 38 49 63 65 80 102 ...</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="matrices-list-filtration">Matrices list filtration<a class="anchor" aria-label="anchor" href="#matrices-list-filtration"></a>
</h4>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/FilterInteractions.html">FilterInteractions</a></span><span class="op">(</span></span>
<span>  matrices.lst      <span class="op">=</span> <span class="va">interactions_RFmatrix_ctrl.lst</span>,</span>
<span>  target.lst        <span class="op">=</span> <span class="va">target.lst</span>,</span>
<span>  selection.fun     <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 4</span></span>
<span><span class="co">#&gt;  $ anchor.Beaf.name: int [1:3] 1 3 4</span></span>
<span><span class="co">#&gt;  $ bait.Tss.name   : int [1:3] 1 2 3</span></span>
<span><span class="co">#&gt;  $ name            : int 1</span></span>
<span><span class="co">#&gt;  $ distance        : int [1:25] 1 3 8 24 38 49 63 65 80 102 ...</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="selection-function">Selection Function<a class="anchor" aria-label="anchor" href="#selection-function"></a>
</h3>
<p>Now we will create a function to cross our target indices to select precisely what we want. In order to perform this we will need some set theory basis.</p>
<div class="section level4">
<h4 id="set-theory-functions">Set theory functions<a class="anchor" aria-label="anchor" href="#set-theory-functions"></a>
</h4>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"D"</span>,<span class="st">"G"</span><span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"E"</span>,<span class="st">"B"</span>,<span class="st">"C"</span>,<span class="st">"G"</span><span class="op">)</span></span>
<span><span class="va">c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"F"</span>,<span class="st">"C"</span>,<span class="st">"G"</span><span class="op">)</span></span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Which is common to A, B and C</li>
</ol>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="va">intersect</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span>,<span class="va">c</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "G"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">intersect</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">intersect</a></span><span class="op">(</span><span class="va">c</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "G"</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Which is in A and/or B and/or C</li>
</ol>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="va">union</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span>,<span class="va">c</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "A" "B" "C" "D" "E" "F" "G"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">union</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">union</a></span><span class="op">(</span><span class="va">c</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "A" "B" "C" "D" "E" "F" "G"</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Which is only in A</li>
</ol>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="va">setdiff</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span>,<span class="va">c</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "D"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">c</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "D"</span></span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Which is common in A with B, and not in C</li>
</ol>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">intersect</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">c</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "B"</span></span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>What is common in A with B, plus all that is present in C</li>
</ol>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">intersect</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">union</a></span><span class="op">(</span><span class="va">c</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "A" "B" "C" "F" "G"</span></span></code></pre></div>
<ol start="6" style="list-style-type: decimal">
<li>What is common in C with all elements present in A and B</li>
</ol>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">union</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">intersect</a></span><span class="op">(</span><span class="va">c</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "A" "C" "G"</span></span></code></pre></div>
<ol start="7" style="list-style-type: decimal">
<li>Everything that is present in A and B but not in C</li>
</ol>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">union</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">c</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "B" "D" "E"</span></span></code></pre></div>
<ol start="8" style="list-style-type: decimal">
<li>Which is present only once</li>
</ol>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span>,<span class="va">c</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">d</span>,<span class="va">d</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html" class="external-link">duplicated</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "D" "E" "F"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="exemple-according-to-the-above-target">Exemple according to the above target<a class="anchor" aria-label="anchor" href="#exemple-according-to-the-above-target"></a>
</h4>
<p>We will select which is in anchor.Beaf.name, bait.Tss.name and distance, but not in name</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">selection.fun</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="va">intersect</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">anchor.Beaf.name</span>, <span class="va">bait.Tss.name</span> ,<span class="va">distance</span><span class="op">)</span> <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="filtration-with-selection">Filtration with selection<a class="anchor" aria-label="anchor" href="#filtration-with-selection"></a>
</h3>
<p>When you specify a selection way the function will return:</p>
<ol style="list-style-type: decimal">
<li>The indices according to the selection if you select in interarctions.gni (That allow you to construct a vector to apply to multiple matrices list and there interaction attributes).<br>
</li>
<li>The filtred matrices list if you select in matrices list directly and update the attributes.</li>
</ol>
<div class="section level4">
<h4 id="ginteraction-filtration-1">GInteraction filtration<a class="anchor" aria-label="anchor" href="#ginteraction-filtration-1"></a>
</h4>
<p>We want to select wich is in anchor.Beaf.name, bait.Tss.name and distance criterion but not in name. So, the indices common to anchor.Beaf.name, bait.Tss.name and distance criterions are 1 and 4. But The indice 1 is in name criterion, so we select only the 4th element</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/FilterInteractions.html">FilterInteractions</a></span><span class="op">(</span></span>
<span>  interarctions.gni <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">interactions_RFmatrix_ctrl.lst</span><span class="op">)</span><span class="op">$</span><span class="va">interactions</span>,</span>
<span>  target.lst        <span class="op">=</span> <span class="va">target.lst</span>,</span>
<span>  selection.fun     <span class="op">=</span> <span class="va">selection.fun</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;  int 3</span></span></code></pre></div>
<p>names of 4th interaction is:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">interactions_RFmatrix_ctrl.lst</span><span class="op">)</span><span class="op">$</span><span class="va">interactions</span><span class="op">$</span><span class="va">name</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] "2L:121_2L:117"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="matrices-list-filtration-1">Matrices list filtration<a class="anchor" aria-label="anchor" href="#matrices-list-filtration-1"></a>
</h4>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filtred_interactions_RFmatrix_ctrl.lst</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/FilterInteractions.html">FilterInteractions</a></span><span class="op">(</span></span>
<span>  matrices.lst  <span class="op">=</span> <span class="va">interactions_RFmatrix_ctrl.lst</span>,</span>
<span>  target.lst    <span class="op">=</span> <span class="va">target.lst</span>,</span>
<span>  selection.fun <span class="op">=</span> <span class="va">selection.fun</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>names of the filtred matrice is the same than the 4th interaction:</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">filtred_interactions_RFmatrix_ctrl.lst</span><span class="op">)</span><span class="op">$</span><span class="va">names</span></span>
<span><span class="co">#&gt; [1] "2L:107_2L:121"</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="particular-case-only-one-target-and-no-selection">Particular case: Only one target and no selection<a class="anchor" aria-label="anchor" href="#particular-case-only-one-target-and-no-selection"></a>
</h3>
<p>For exemple, we want to filter the 100th first elements, so we target the 100 first names</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">first100_target.lst</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  submatrix.name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">interactions_RFmatrix_ctrl.lst</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">]</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="ginteraction-filtration-2">GInteraction filtration<a class="anchor" aria-label="anchor" href="#ginteraction-filtration-2"></a>
</h4>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/FilterInteractions.html">FilterInteractions</a></span><span class="op">(</span></span>
<span>  interarctions.gni <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">interactions_RFmatrix_ctrl.lst</span><span class="op">)</span><span class="op">$</span><span class="va">interactions</span>,</span>
<span>  target.lst        <span class="op">=</span> <span class="va">first100_target.lst</span>,</span>
<span>  selection.fun     <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Named int [1:100] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">#&gt;  - attr(*, "names")= chr [1:100] "submatrix.name1" "submatrix.name2" "submatrix.name3" "submatrix.name4" ...</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="matrices-list-filtration-2">Matrices list filtration<a class="anchor" aria-label="anchor" href="#matrices-list-filtration-2"></a>
</h4>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">first100_interactions_RFmatrix_ctrl.lst</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/FilterInteractions.html">FilterInteractions</a></span><span class="op">(</span></span>
<span>  matrices.lst  <span class="op">=</span> <span class="va">interactions_RFmatrix_ctrl.lst</span>,</span>
<span>  target.lst    <span class="op">=</span> <span class="va">first100_target.lst</span>,</span>
<span>  selection.fun <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">first100_interactions_RFmatrix_ctrl.lst</span><span class="op">)</span><span class="op">$</span><span class="va">interactions</span></span>
<span><span class="co">#&gt; GInteractions object with 100 interactions and 15 metadata columns:</span></span>
<span><span class="co">#&gt;                     seqnames1           ranges1     seqnames2           ranges2</span></span>
<span><span class="co">#&gt;                         &lt;Rle&gt;         &lt;IRanges&gt;         &lt;Rle&gt;         &lt;IRanges&gt;</span></span>
<span><span class="co">#&gt;         2L:74_2L:77        2L       73001-74000 ---        2L       76001-77000</span></span>
<span><span class="co">#&gt;       2L:115_2L:107        2L     114001-115000 ---        2L     106001-107000</span></span>
<span><span class="co">#&gt;       2L:121_2L:107        2L     120001-121000 ---        2L     106001-107000</span></span>
<span><span class="co">#&gt;       2L:121_2L:117        2L     120001-121000 ---        2L     116001-117000</span></span>
<span><span class="co">#&gt;       2L:274_2L:268        2L     273001-274000 ---        2L     267001-268000</span></span>
<span><span class="co">#&gt;                 ...       ...               ... ...       ...               ...</span></span>
<span><span class="co">#&gt;   2L:12515_2L:12498        2L 12514001-12515000 ---        2L 12497001-12498000</span></span>
<span><span class="co">#&gt;   2L:12516_2L:12498        2L 12515001-12516000 ---        2L 12497001-12498000</span></span>
<span><span class="co">#&gt;   2L:12515_2L:12508        2L 12514001-12515000 ---        2L 12507001-12508000</span></span>
<span><span class="co">#&gt;   2L:12516_2L:12508        2L 12515001-12516000 ---        2L 12507001-12508000</span></span>
<span><span class="co">#&gt;   2L:12515_2L:12509        2L 12514001-12515000 ---        2L 12508001-12509000</span></span>
<span><span class="co">#&gt;                     |              name  constraint  distance orientation</span></span>
<span><span class="co">#&gt;                     |       &lt;character&gt; &lt;character&gt; &lt;integer&gt;   &lt;logical&gt;</span></span>
<span><span class="co">#&gt;         2L:74_2L:77 |       2L:74_2L:77       Tad_1      3000        TRUE</span></span>
<span><span class="co">#&gt;       2L:115_2L:107 |     2L:115_2L:107       Tad_3      8000       FALSE</span></span>
<span><span class="co">#&gt;       2L:121_2L:107 |     2L:121_2L:107       Tad_3     14000       FALSE</span></span>
<span><span class="co">#&gt;       2L:121_2L:117 |     2L:121_2L:117       Tad_3      4000       FALSE</span></span>
<span><span class="co">#&gt;       2L:274_2L:268 |     2L:274_2L:268      Tad_10      6000       FALSE</span></span>
<span><span class="co">#&gt;                 ... .               ...         ...       ...         ...</span></span>
<span><span class="co">#&gt;   2L:12515_2L:12498 | 2L:12515_2L:12498     Tad_310     17000       FALSE</span></span>
<span><span class="co">#&gt;   2L:12516_2L:12498 | 2L:12516_2L:12498     Tad_310     18000       FALSE</span></span>
<span><span class="co">#&gt;   2L:12515_2L:12508 | 2L:12515_2L:12508     Tad_310      7000       FALSE</span></span>
<span><span class="co">#&gt;   2L:12516_2L:12508 | 2L:12516_2L:12508     Tad_310      8000       FALSE</span></span>
<span><span class="co">#&gt;   2L:12515_2L:12509 | 2L:12515_2L:12509     Tad_310      6000       FALSE</span></span>
<span><span class="co">#&gt;                        submatrix.name  anchor.bin      anchor.name    bait.bin</span></span>
<span><span class="co">#&gt;                           &lt;character&gt; &lt;character&gt;      &lt;character&gt; &lt;character&gt;</span></span>
<span><span class="co">#&gt;         2L:74_2L:77       2L:74_2L:77       2L:74      2L:74:Tad_1       2L:77</span></span>
<span><span class="co">#&gt;       2L:115_2L:107     2L:107_2L:115      2L:115     2L:115:Tad_3      2L:107</span></span>
<span><span class="co">#&gt;       2L:121_2L:107     2L:107_2L:121      2L:121     2L:121:Tad_3      2L:107</span></span>
<span><span class="co">#&gt;       2L:121_2L:117     2L:117_2L:121      2L:121     2L:121:Tad_3      2L:117</span></span>
<span><span class="co">#&gt;       2L:274_2L:268     2L:268_2L:274      2L:274    2L:274:Tad_10      2L:268</span></span>
<span><span class="co">#&gt;                 ...               ...         ...              ...         ...</span></span>
<span><span class="co">#&gt;   2L:12515_2L:12498 2L:12498_2L:12515    2L:12515 2L:12515:Tad_310    2L:12498</span></span>
<span><span class="co">#&gt;   2L:12516_2L:12498 2L:12498_2L:12516    2L:12516 2L:12516:Tad_310    2L:12498</span></span>
<span><span class="co">#&gt;   2L:12515_2L:12508 2L:12508_2L:12515    2L:12515 2L:12515:Tad_310    2L:12508</span></span>
<span><span class="co">#&gt;   2L:12516_2L:12508 2L:12508_2L:12516    2L:12516 2L:12516:Tad_310    2L:12508</span></span>
<span><span class="co">#&gt;   2L:12515_2L:12509 2L:12509_2L:12515    2L:12515 2L:12515:Tad_310    2L:12509</span></span>
<span><span class="co">#&gt;                            bait.name anchor.Beaf.score anchor.Beaf.name</span></span>
<span><span class="co">#&gt;                          &lt;character&gt;         &lt;numeric&gt;           &lt;list&gt;</span></span>
<span><span class="co">#&gt;         2L:74_2L:77      2L:77:Tad_1               205         Beaf32_8</span></span>
<span><span class="co">#&gt;       2L:115_2L:107     2L:107:Tad_3              1707        Beaf32_14</span></span>
<span><span class="co">#&gt;       2L:121_2L:107     2L:107:Tad_3               484        Beaf32_15</span></span>
<span><span class="co">#&gt;       2L:121_2L:117     2L:117:Tad_3               484        Beaf32_15</span></span>
<span><span class="co">#&gt;       2L:274_2L:268    2L:268:Tad_10               210        Beaf32_39</span></span>
<span><span class="co">#&gt;                 ...              ...               ...              ...</span></span>
<span><span class="co">#&gt;   2L:12515_2L:12498 2L:12498:Tad_310                44       Beaf32_900</span></span>
<span><span class="co">#&gt;   2L:12516_2L:12498 2L:12498:Tad_310                88       Beaf32_901</span></span>
<span><span class="co">#&gt;   2L:12515_2L:12508 2L:12508:Tad_310                44       Beaf32_900</span></span>
<span><span class="co">#&gt;   2L:12516_2L:12508 2L:12508:Tad_310                88       Beaf32_901</span></span>
<span><span class="co">#&gt;   2L:12515_2L:12509 2L:12509:Tad_310                44       Beaf32_900</span></span>
<span><span class="co">#&gt;                     anchor.Beaf.bln bait.Tss.class           bait.Tss.name</span></span>
<span><span class="co">#&gt;                           &lt;numeric&gt;    &lt;character&gt;                  &lt;list&gt;</span></span>
<span><span class="co">#&gt;         2L:74_2L:77               1       inactive             FBgn0031214</span></span>
<span><span class="co">#&gt;       2L:115_2L:107               1         active FBgn0026787,FBgn0005278</span></span>
<span><span class="co">#&gt;       2L:121_2L:107               1         active FBgn0026787,FBgn0005278</span></span>
<span><span class="co">#&gt;       2L:121_2L:117               1         active             FBgn0031219</span></span>
<span><span class="co">#&gt;       2L:274_2L:268               1       inactive             FBgn0031239</span></span>
<span><span class="co">#&gt;                 ...             ...            ...                     ...</span></span>
<span><span class="co">#&gt;   2L:12515_2L:12498               1       inactive             FBgn0051858</span></span>
<span><span class="co">#&gt;   2L:12516_2L:12498               1       inactive             FBgn0051858</span></span>
<span><span class="co">#&gt;   2L:12515_2L:12508               1       inactive             FBgn0262353</span></span>
<span><span class="co">#&gt;   2L:12516_2L:12508               1       inactive             FBgn0262353</span></span>
<span><span class="co">#&gt;   2L:12515_2L:12509               1       inactive             FBgn0263458</span></span>
<span><span class="co">#&gt;                     bait.Tss.bln</span></span>
<span><span class="co">#&gt;                        &lt;numeric&gt;</span></span>
<span><span class="co">#&gt;         2L:74_2L:77            1</span></span>
<span><span class="co">#&gt;       2L:115_2L:107            1</span></span>
<span><span class="co">#&gt;       2L:121_2L:107            1</span></span>
<span><span class="co">#&gt;       2L:121_2L:117            1</span></span>
<span><span class="co">#&gt;       2L:274_2L:268            1</span></span>
<span><span class="co">#&gt;                 ...          ...</span></span>
<span><span class="co">#&gt;   2L:12515_2L:12498            1</span></span>
<span><span class="co">#&gt;   2L:12516_2L:12498            1</span></span>
<span><span class="co">#&gt;   2L:12515_2L:12508            1</span></span>
<span><span class="co">#&gt;   2L:12516_2L:12508            1</span></span>
<span><span class="co">#&gt;   2L:12515_2L:12509            1</span></span>
<span><span class="co">#&gt;   -------</span></span>
<span><span class="co">#&gt;   regions: 429 ranges and 0 metadata columns</span></span>
<span><span class="co">#&gt;   seqinfo: 2 sequences from an unspecified genome</span></span></code></pre></div>
<p>A selection of some matrices remove attributes.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">interactions_RFmatrix_ctrl.lst</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">interactions</span></span>
<span><span class="co">#&gt; NULL</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="particular-case-sampling">Particular case: Sampling<a class="anchor" aria-label="anchor" href="#particular-case-sampling"></a>
</h3>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nSample.num</span> <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">target.lst</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>name<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">interactions_RFmatrix_ctrl.lst</span><span class="op">)</span><span class="op">$</span><span class="va">interactions</span><span class="op">$</span><span class="va">name</span>,<span class="va">nSample.num</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="ginteraction-sampling">GInteraction sampling<a class="anchor" aria-label="anchor" href="#ginteraction-sampling"></a>
</h4>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/FilterInteractions.html">FilterInteractions</a></span><span class="op">(</span></span>
<span>  interarctions.gni <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">interactions_RFmatrix_ctrl.lst</span><span class="op">)</span><span class="op">$</span><span class="va">interactions</span>,</span>
<span>  target.lst        <span class="op">=</span> <span class="va">target.lst</span>,</span>
<span>  selection.fun     <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Named int [1:3] 14 179 195</span></span>
<span><span class="co">#&gt;  - attr(*, "names")= chr [1:3] "name1" "name2" "name3"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="matrices-list-sampling">Matrices list sampling<a class="anchor" aria-label="anchor" href="#matrices-list-sampling"></a>
</h4>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sampled_interactions_RFmatrix_ctrl.lst</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/FilterInteractions.html">FilterInteractions</a></span><span class="op">(</span></span>
<span>  matrices.lst  <span class="op">=</span> <span class="va">interactions_RFmatrix_ctrl.lst</span>,</span>
<span>  target.lst    <span class="op">=</span> <span class="va">target.lst</span>,</span>
<span>  selection.fun <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">sampled_interactions_RFmatrix_ctrl.lst</span><span class="op">)</span><span class="op">$</span><span class="va">interactions</span></span>
<span><span class="co">#&gt; GInteractions object with 3 interactions and 15 metadata columns:</span></span>
<span><span class="co">#&gt;                     seqnames1           ranges1     seqnames2           ranges2</span></span>
<span><span class="co">#&gt;                         &lt;Rle&gt;         &lt;IRanges&gt;         &lt;Rle&gt;         &lt;IRanges&gt;</span></span>
<span><span class="co">#&gt;     2L:1178_2L:1174        2L   1177001-1178000 ---        2L   1173001-1174000</span></span>
<span><span class="co">#&gt;   2L:21574_2L:21492        2L 21573001-21574000 ---        2L 21491001-21492000</span></span>
<span><span class="co">#&gt;     2R:5672_2R:5653        2R   5671001-5672000 ---        2R   5652001-5653000</span></span>
<span><span class="co">#&gt;                     |              name  constraint  distance orientation</span></span>
<span><span class="co">#&gt;                     |       &lt;character&gt; &lt;character&gt; &lt;integer&gt;   &lt;logical&gt;</span></span>
<span><span class="co">#&gt;     2L:1178_2L:1174 |   2L:1178_2L:1174      Tad_35      4000       FALSE</span></span>
<span><span class="co">#&gt;   2L:21574_2L:21492 | 2L:21574_2L:21492     Tad_486     82000       FALSE</span></span>
<span><span class="co">#&gt;     2R:5672_2R:5653 |   2R:5672_2R:5653     Tad_513     19000       FALSE</span></span>
<span><span class="co">#&gt;                        submatrix.name  anchor.bin      anchor.name    bait.bin</span></span>
<span><span class="co">#&gt;                           &lt;character&gt; &lt;character&gt;      &lt;character&gt; &lt;character&gt;</span></span>
<span><span class="co">#&gt;     2L:1178_2L:1174   2L:1174_2L:1178     2L:1178   2L:1178:Tad_35     2L:1174</span></span>
<span><span class="co">#&gt;   2L:21574_2L:21492 2L:21492_2L:21574    2L:21574 2L:21574:Tad_486    2L:21492</span></span>
<span><span class="co">#&gt;     2R:5672_2R:5653   2R:5653_2R:5672     2R:5672  2R:5672:Tad_513     2R:5653</span></span>
<span><span class="co">#&gt;                            bait.name anchor.Beaf.score anchor.Beaf.name</span></span>
<span><span class="co">#&gt;                          &lt;character&gt;         &lt;numeric&gt;           &lt;list&gt;</span></span>
<span><span class="co">#&gt;     2L:1178_2L:1174   2L:1174:Tad_35               921       Beaf32_130</span></span>
<span><span class="co">#&gt;   2L:21574_2L:21492 2L:21492:Tad_486               529      Beaf32_1349</span></span>
<span><span class="co">#&gt;     2R:5672_2R:5653  2R:5653:Tad_513                99      Beaf32_1462</span></span>
<span><span class="co">#&gt;                     anchor.Beaf.bln bait.Tss.class bait.Tss.name bait.Tss.bln</span></span>
<span><span class="co">#&gt;                           &lt;numeric&gt;    &lt;character&gt;        &lt;list&gt;    &lt;numeric&gt;</span></span>
<span><span class="co">#&gt;     2L:1178_2L:1174               1         active   FBgn0031318            1</span></span>
<span><span class="co">#&gt;   2L:21574_2L:21492               1       inactive   FBgn0053837            1</span></span>
<span><span class="co">#&gt;     2R:5672_2R:5653               1         active   FBgn0033028            1</span></span>
<span><span class="co">#&gt;   -------</span></span>
<span><span class="co">#&gt;   regions: 429 ranges and 0 metadata columns</span></span>
<span><span class="co">#&gt;   seqinfo: 2 sequences from an unspecified genome</span></span></code></pre></div>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="orientation">Orientation<a class="anchor" aria-label="anchor" href="#orientation"></a>
</h2>
<div class="section level3">
<h3 id="tips-4">Tips<a class="anchor" aria-label="anchor" href="#tips-4"></a>
</h3>
<ol style="list-style-type: decimal">
<li>Use the same function to oriente matrices list or only one matrix.<br>
</li>
<li>If you want to force orientation on an matrix use orientation only on it, not on a list.</li>
</ol>
</div>
<div class="section level3">
<h3 id="understand-orientation">Understand orientation<a class="anchor" aria-label="anchor" href="#understand-orientation"></a>
</h3>
<p>First, lets look how two matrices are oriented (column orientation of metadata of the interactions attribute). Below we can see that the first matrix is correctly oriented (value is TRUE) but not the second one.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">first100_interactions_RFmatrix_ctrl.lst</span><span class="op">)</span><span class="op">$</span><span class="va">interactions</span><span class="op">$</span><span class="va">orientation</span><span class="op">[</span><span class="fl">13</span><span class="op">:</span><span class="fl">14</span><span class="op">]</span> </span>
<span><span class="co">#&gt; [1]  TRUE FALSE</span></span></code></pre></div>
<p>A matrix that is correctly oriented have an anchor before a bait (see SearchPairs for anchor-bait order), and a matrix that is not oriented have an anchor after a bait.</p>
<p>That mean that:</p>
<ol style="list-style-type: decimal">
<li>In the first matrice, the <strong>anchor Beaf is in Y axis</strong> and the <strong>bait TSS in X axis</strong><br>
</li>
<li>In the second matrice, the <strong>bait TSS is in Y axis</strong> and the <strong>anchor Beaf in X axis</strong>
</li>
</ol>
<p><img src="images/Orientation_extraction.png"><!-- --></p>
<p>So we will oriente this second matrix to put anchor on Y axis and bait on X axis and see what happens. <img src="images/Orientation.png"><!-- --></p>
</div>
<div class="section level3">
<h3 id="orientation-on-matrices-list">Orientation on matrices list<a class="anchor" aria-label="anchor" href="#orientation-on-matrices-list"></a>
</h3>
<p>We expected that the values in upper left corner (green in above scheme) will end up in the lower right corner after orientation, so let’s oriente the matrices list according to the orientation metadata.</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oriented_first100_interactions_RFmatrix_ctrl.lst</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/OrienteMatrix.html">OrienteMatrix</a></span><span class="op">(</span><span class="va">first100_interactions_RFmatrix_ctrl.lst</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="first-matrice-dont-need-orientation">First matrice (don’t need orientation)<a class="anchor" aria-label="anchor" href="#first-matrice-dont-need-orientation"></a>
</h4>
<ol style="list-style-type: decimal">
<li>upper left corner <strong>before orientation</strong>.</li>
</ol>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">first100_interactions_RFmatrix_ctrl.lst</span><span class="op">[[</span><span class="fl">13</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code></pre></div>
<details><summary>
View
</summary><table class="table">
<thead><tr>
<th style="text-align:center;">
1
</th>
<th style="text-align:center;">
2
</th>
<th style="text-align:center;">
3
</th>
<th style="text-align:center;">
4
</th>
<th style="text-align:center;">
5
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.0
</td>
</tr>
<tr>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.0
</td>
</tr>
<tr>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.1
</td>
</tr>
<tr>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.1
</td>
</tr>
<tr>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
0.1
</td>
</tr>
</tbody>
</table></details><ol start="2" style="list-style-type: decimal">
<li>upper left corner <strong>after orientation does not change</strong>.</li>
</ol>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oriented_first100_interactions_RFmatrix_ctrl.lst</span><span class="op">[[</span><span class="fl">13</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code></pre></div>
<details><summary>
View
</summary><table class="table">
<thead><tr>
<th style="text-align:center;">
1
</th>
<th style="text-align:center;">
2
</th>
<th style="text-align:center;">
3
</th>
<th style="text-align:center;">
4
</th>
<th style="text-align:center;">
5
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.0
</td>
</tr>
<tr>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.0
</td>
</tr>
<tr>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.1
</td>
</tr>
<tr>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.1
</td>
</tr>
<tr>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
0.1
</td>
</tr>
</tbody>
</table></details>
</div>
<div class="section level4">
<h4 id="second-matrice-need-orientation">Second matrice (need orientation)<a class="anchor" aria-label="anchor" href="#second-matrice-need-orientation"></a>
</h4>
<ol style="list-style-type: decimal">
<li>upper left corner <strong>before orientation</strong>
</li>
</ol>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">first100_interactions_RFmatrix_ctrl.lst</span><span class="op">[[</span><span class="fl">14</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code></pre></div>
<details><summary>
View
</summary><table class="table">
<thead><tr>
<th style="text-align:center;">
1
</th>
<th style="text-align:center;">
2
</th>
<th style="text-align:center;">
3
</th>
<th style="text-align:center;">
4
</th>
<th style="text-align:center;">
5
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.2
</td>
<td style="text-align:center;">
0.4
</td>
<td style="text-align:center;">
0.5
</td>
<td style="text-align:center;">
0.7
</td>
</tr>
<tr>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
0.2
</td>
<td style="text-align:center;">
0.3
</td>
<td style="text-align:center;">
0.5
</td>
<td style="text-align:center;">
0.6
</td>
</tr>
<tr>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
0.3
</td>
<td style="text-align:center;">
0.4
</td>
<td style="text-align:center;">
0.5
</td>
</tr>
<tr>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
0.3
</td>
<td style="text-align:center;">
0.5
</td>
</tr>
<tr>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
0.4
</td>
</tr>
</tbody>
</table></details><ol start="2" style="list-style-type: decimal">
<li><strong>transposed lower right corner after orientation correspond to the upper left corner before orientation</strong></li>
</ol>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oriented_first100_interactions_RFmatrix_ctrl.lst</span><span class="op">[[</span><span class="fl">14</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">97</span><span class="op">:</span><span class="fl">101</span>,<span class="fl">97</span><span class="op">:</span><span class="fl">101</span><span class="op">]</span></span></code></pre></div>
<details><summary>
View
</summary><table class="table">
<thead><tr>
<th style="text-align:center;">
1
</th>
<th style="text-align:center;">
2
</th>
<th style="text-align:center;">
3
</th>
<th style="text-align:center;">
4
</th>
<th style="text-align:center;">
5
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
0.4
</td>
<td style="text-align:center;">
0.5
</td>
<td style="text-align:center;">
0.5
</td>
<td style="text-align:center;">
0.6
</td>
<td style="text-align:center;">
0.7
</td>
</tr>
<tr>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
0.3
</td>
<td style="text-align:center;">
0.4
</td>
<td style="text-align:center;">
0.5
</td>
<td style="text-align:center;">
0.5
</td>
</tr>
<tr>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
0.3
</td>
<td style="text-align:center;">
0.3
</td>
<td style="text-align:center;">
0.4
</td>
</tr>
<tr>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
0.2
</td>
<td style="text-align:center;">
0.2
</td>
</tr>
<tr>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
0.0
</td>
</tr>
</tbody>
</table></details>
</div>
</div>
<div class="section level3">
<h3 id="orientation-on-only-one-matrice-">Orientation on only one matrice.<a class="anchor" aria-label="anchor" href="#orientation-on-only-one-matrice-"></a>
</h3>
<p>The function could also oriente only one matrix but in this case there is no attribute verification so you can oriente a matrix that don’t need orentation.</p>
<div class="section level4">
<h4 id="first-matrix">First matrix<a class="anchor" aria-label="anchor" href="#first-matrix"></a>
</h4>
<p>Transposed lower right corner after orientation correspond to the upper left corner before orientation.</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/OrienteMatrix.html">OrienteMatrix</a></span><span class="op">(</span><span class="va">first100_interactions_RFmatrix_ctrl.lst</span><span class="op">[[</span><span class="fl">13</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">97</span><span class="op">:</span><span class="fl">101</span>,<span class="fl">97</span><span class="op">:</span><span class="fl">101</span><span class="op">]</span></span></code></pre></div>
<details><summary>
View
</summary><table class="table">
<thead><tr>
<th style="text-align:center;">
1
</th>
<th style="text-align:center;">
2
</th>
<th style="text-align:center;">
3
</th>
<th style="text-align:center;">
4
</th>
<th style="text-align:center;">
5
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
0.1
</td>
<td style="text-align:center;">
0.1
</td>
<td style="text-align:center;">
0.1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
0
</td>
</tr>
</tbody>
</table></details>
</div>
<div class="section level4">
<h4 id="second-matrix">Second matrix<a class="anchor" aria-label="anchor" href="#second-matrix"></a>
</h4>
<p>Below we find again the orientation of the second matrix.</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/OrienteMatrix.html">OrienteMatrix</a></span><span class="op">(</span><span class="va">first100_interactions_RFmatrix_ctrl.lst</span><span class="op">[[</span><span class="fl">14</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">97</span><span class="op">:</span><span class="fl">101</span>,<span class="fl">97</span><span class="op">:</span><span class="fl">101</span><span class="op">]</span></span></code></pre></div>
<details><summary>
View
</summary><table class="table">
<thead><tr>
<th style="text-align:center;">
1
</th>
<th style="text-align:center;">
2
</th>
<th style="text-align:center;">
3
</th>
<th style="text-align:center;">
4
</th>
<th style="text-align:center;">
5
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
0.4
</td>
<td style="text-align:center;">
0.5
</td>
<td style="text-align:center;">
0.5
</td>
<td style="text-align:center;">
0.6
</td>
<td style="text-align:center;">
0.7
</td>
</tr>
<tr>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
0.3
</td>
<td style="text-align:center;">
0.4
</td>
<td style="text-align:center;">
0.5
</td>
<td style="text-align:center;">
0.5
</td>
</tr>
<tr>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
0.3
</td>
<td style="text-align:center;">
0.3
</td>
<td style="text-align:center;">
0.4
</td>
</tr>
<tr>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
0.2
</td>
<td style="text-align:center;">
0.2
</td>
</tr>
<tr>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
0.0
</td>
</tr>
</tbody>
</table></details><hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="quantifications">Quantifications<a class="anchor" aria-label="anchor" href="#quantifications"></a>
</h2>
<div class="section level3">
<h3 id="tips-5">Tips<a class="anchor" aria-label="anchor" href="#tips-5"></a>
</h3>
<ol style="list-style-type: decimal">
<li>To print quantifications use <code>c</code> function to avoid the attributes printing.<br>
</li>
<li>When you select area if is null <code>operation.fun</code> return values of the selected area without NA.</li>
</ol>
</div>
<div class="section level3">
<h3 id="preregistred-area-and-functions">Preregistred area and functions<a class="anchor" aria-label="anchor" href="#preregistred-area-and-functions"></a>
</h3>
<p>the <code>GetQuantif</code> function have some preregistred area and function (see <code><a href="../reference/GetQuantif.html">Genomic2DTK::GetQuantif</a></code>). Below we will extract centrals values. There are interactions values in a square 3x3 centred on the interactions between anchor and bait. With all extracted value we will perform an average after removing all zeros.</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">center.num</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GetQuantif.html">GetQuantif</a></span><span class="op">(</span></span>
<span>  matrices.lst  <span class="op">=</span> <span class="va">oriented_first100_interactions_RFmatrix_ctrl.lst</span>,</span>
<span>  area.fun      <span class="op">=</span> <span class="st">"center"</span>,</span>
<span>  operation.fun <span class="op">=</span> <span class="st">"mean"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Below we can see the values and the attributes of the numerical vector with a value for each matrices. There are same attributes than the matrices list with two news:</p>
<ol style="list-style-type: decimal">
<li>
<strong>area</strong> that is a function that extract an area of values in each matrices.<br>
</li>
<li>
<strong>operation</strong> that correspond to the numerical operatiion that is perform on values in the selected area.</li>
</ol>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">center.num</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`2L:74_2L:77`</span></span>
<span><span class="co">#&gt; [1] 0.002752447</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`2L:115_2L:107`</span></span>
<span><span class="co">#&gt; [1] 0.004792452</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`2L:121_2L:107`</span></span>
<span><span class="co">#&gt; [1] 1.01102</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`2L:121_2L:117`</span></span>
<span><span class="co">#&gt; [1] 0.03643152</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`2L:274_2L:268`</span></span>
<span><span class="co">#&gt; [1] 1.69169</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`2L:278_2L:268`</span></span>
<span><span class="co">#&gt; [1] 1.483054</span></span></code></pre></div>
<p>In order to print quantifications use <code>c</code> function to avoid the attributes printing.</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">center.num</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`2L:74_2L:77`</span></span>
<span><span class="co">#&gt; [1] 0.002752447</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`2L:115_2L:107`</span></span>
<span><span class="co">#&gt; [1] 0.004792452</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`2L:121_2L:107`</span></span>
<span><span class="co">#&gt; [1] 1.01102</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`2L:121_2L:117`</span></span>
<span><span class="co">#&gt; [1] 0.03643152</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`2L:274_2L:268`</span></span>
<span><span class="co">#&gt; [1] 1.69169</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`2L:278_2L:268`</span></span>
<span><span class="co">#&gt; [1] 1.483054</span></span></code></pre></div>
<p>And to reduce the printing use <code>unlist</code> function.</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">center.num</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   2L:74_2L:77 2L:115_2L:107 2L:121_2L:107 2L:121_2L:117 2L:274_2L:268 </span></span>
<span><span class="co">#&gt;   0.002752447   0.004792452   1.011020060   0.036431519   1.691689943 </span></span>
<span><span class="co">#&gt; 2L:278_2L:268 </span></span>
<span><span class="co">#&gt;   1.483054107</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="values-naming">Values naming<a class="anchor" aria-label="anchor" href="#values-naming"></a>
</h3>
<p>With this function you also could named values according to a metadata of the interactions attributes. For exemple we will take same quantification but now we want use the “anchor.Beaf.name” metadata as name.</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">namedCenter.num</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GetQuantif.html">GetQuantif</a></span><span class="op">(</span></span>
<span>  matrices.lst  <span class="op">=</span> <span class="va">oriented_first100_interactions_RFmatrix_ctrl.lst</span>,</span>
<span>  area.fun      <span class="op">=</span> <span class="st">"center"</span>,</span>
<span>  operation.fun <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  name.chr      <span class="op">=</span> <span class="st">"anchor.Beaf.name"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
The 46th matrix is related to two anchor.Beaf.name
<table class="table">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
name
</th>
<th style="text-align:center;">
anchor.Beaf.name
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
45
</td>
<td style="text-align:center;">
2L:5909_2L:5941
</td>
<td style="text-align:center;">
Beaf32_415
</td>
</tr>
<tr>
<td style="text-align:left;">
46
</td>
<td style="text-align:center;">
2L:5944_2L:5968
</td>
<td style="text-align:center;">
Beaf32_417, Beaf32_418
</td>
</tr>
<tr>
<td style="text-align:left;">
47
</td>
<td style="text-align:center;">
2L:5945_2L:5968
</td>
<td style="text-align:center;">
Beaf32_418
</td>
</tr>
<tr>
<td style="text-align:left;">
48
</td>
<td style="text-align:center;">
2L:6051_2L:6069
</td>
<td style="text-align:center;">
Beaf32_430
</td>
</tr>
<tr>
<td style="text-align:left;">
49
</td>
<td style="text-align:center;">
2L:6066_2L:6069
</td>
<td style="text-align:center;">
Beaf32_432
</td>
</tr>
<tr>
<td style="text-align:left;">
50
</td>
<td style="text-align:center;">
2L:6084_2L:6071
</td>
<td style="text-align:center;">
Beaf32_435
</td>
</tr>
</tbody>
</table>
<p>So the value in center.num is repeted in namedCenter.num</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">center.num</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">45</span><span class="op">:</span><span class="fl">50</span><span class="op">]</span></span>
<span><span class="co">#&gt; 2L:5909_2L:5941 2L:5944_2L:5968 2L:5945_2L:5968 2L:6051_2L:6069 2L:6066_2L:6069 </span></span>
<span><span class="co">#&gt;       0.1871565       0.0000000       0.0000000       0.5279512       2.1392992 </span></span>
<span><span class="co">#&gt; 2L:6084_2L:6071 </span></span>
<span><span class="co">#&gt;       0.1096642</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">namedCenter.num</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">45</span><span class="op">:</span><span class="fl">51</span><span class="op">]</span></span>
<span><span class="co">#&gt; Beaf32_415 Beaf32_417 Beaf32_418 Beaf32_418 Beaf32_430 Beaf32_432 Beaf32_435 </span></span>
<span><span class="co">#&gt;  0.1871565  0.0000000  0.0000000  0.0000000  0.5279512  2.1392992  0.1096642</span></span></code></pre></div>
<p>An attributes is add to know wich values are a duplicate. Here is the second value</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">center.num</span><span class="op">)</span><span class="op">$</span><span class="va">duplicated</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">namedCenter.num</span><span class="op">)</span><span class="op">$</span><span class="va">duplicated</span></span>
<span><span class="co">#&gt; [1] 47</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="custom-functions">Custom functions<a class="anchor" aria-label="anchor" href="#custom-functions"></a>
</h3>
<p>The <code>GetQuantif</code> function could also take custom <strong>area</strong> selection and <strong>operation</strong> in parameter. For exemple here we use the functions we see in the attributes <strong>area</strong> and <strong>operation</strong> of the center.num vector. We obtain same result with custom function in parameter.</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/GetQuantif.html">GetQuantif</a></span><span class="op">(</span></span>
<span>  matrices.lst  <span class="op">=</span> <span class="va">oriented_first100_interactions_RFmatrix_ctrl.lst</span>,</span>
<span>  area.fun      <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">matrice.mtx</span><span class="op">)</span><span class="op">{</span><span class="va">matrice.mtx</span><span class="op">[</span><span class="fl">33</span><span class="op">:</span><span class="fl">35</span>,<span class="fl">67</span><span class="op">:</span><span class="fl">69</span><span class="op">]</span><span class="op">}</span>,</span>
<span>  operation.fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">area.mtx</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">area.mtx</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">area.mtx</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">]</span><span class="op">&lt;-</span><span class="cn">NA</span>;</span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">area.mtx</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   2L:74_2L:77 2L:115_2L:107 2L:121_2L:107 2L:121_2L:117 2L:274_2L:268 </span></span>
<span><span class="co">#&gt;    0.01238601    0.04313207    1.01102006    0.03643152    1.69168994 </span></span>
<span><span class="co">#&gt; 2L:278_2L:268 </span></span>
<span><span class="co">#&gt;    1.48305411</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="particular-cases-extraction-of-values">Particular cases: Extraction of values<a class="anchor" aria-label="anchor" href="#particular-cases-extraction-of-values"></a>
</h3>
<p>The Operation.fun parameter could a custom function that just return the area selected. this allow to extract values in each matrices. ### One value extraction</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/GetQuantif.html">GetQuantif</a></span><span class="op">(</span></span>
<span>  matrices.lst  <span class="op">=</span> <span class="va">oriented_first100_interactions_RFmatrix_ctrl.lst</span>,</span>
<span>  area.fun      <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">matrice.mtx</span><span class="op">)</span><span class="op">{</span><span class="va">matrice.mtx</span><span class="op">[</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">]</span><span class="op">}</span>,</span>
<span>  operation.fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">area.mtx</span><span class="op">)</span><span class="op">{</span><span class="va">area.mtx</span><span class="op">}</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   2L:74_2L:77 2L:115_2L:107 2L:121_2L:107 2L:121_2L:117 2L:274_2L:268 </span></span>
<span><span class="co">#&gt;     0.0000000     0.0000000     0.3403983     0.4351463     0.0000000 </span></span>
<span><span class="co">#&gt; 2L:278_2L:268 </span></span>
<span><span class="co">#&gt;     0.1806280</span></span></code></pre></div>
<div class="section level4">
<h4 id="area-extraction">Area extraction<a class="anchor" aria-label="anchor" href="#area-extraction"></a>
</h4>
<p>The Operation.fun parameter could a custom function that just return the area selected. this allow to extract values in each matrices.</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/GetQuantif.html">GetQuantif</a></span><span class="op">(</span></span>
<span>  matrices.lst  <span class="op">=</span> <span class="va">oriented_first100_interactions_RFmatrix_ctrl.lst</span>,</span>
<span>  area.fun      <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">matrice.mtx</span><span class="op">)</span><span class="op">{</span><span class="va">matrice.mtx</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fl">6</span>,<span class="fl">4</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">}</span>,</span>
<span>  operation.fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">area</span><span class="op">)</span><span class="op">{</span><span class="va">area</span><span class="op">}</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`2L:74_2L:77`</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span><span class="co">#&gt; [1,]    0    0    0</span></span>
<span><span class="co">#&gt; [2,]   NA    0    0</span></span>
<span><span class="co">#&gt; [3,]   NA   NA    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`2L:115_2L:107`</span></span>
<span><span class="co">#&gt;      [,1] [,2]      [,3]</span></span>
<span><span class="co">#&gt; [1,]    0    0 0.1671591</span></span>
<span><span class="co">#&gt; [2,]   NA    0 0.2228788</span></span>
<span><span class="co">#&gt; [3,]   NA   NA 0.1857323</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`2L:121_2L:107`</span></span>
<span><span class="co">#&gt;           [,1]      [,2]      [,3]</span></span>
<span><span class="co">#&gt; [1,] 0.3009771 0.7871710 1.2376943</span></span>
<span><span class="co">#&gt; [2,]        NA 0.3403983 0.5352191</span></span>
<span><span class="co">#&gt; [3,]        NA        NA 0.0000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`2L:121_2L:117`</span></span>
<span><span class="co">#&gt;           [,1]      [,2]      [,3]</span></span>
<span><span class="co">#&gt; [1,] 0.6591566 0.5355647 0.4119729</span></span>
<span><span class="co">#&gt; [2,]        NA 0.4351463 0.3347280</span></span>
<span><span class="co">#&gt; [3,]        NA        NA 0.2574830</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`2L:274_2L:268`</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span><span class="co">#&gt; [1,]    0    0    0</span></span>
<span><span class="co">#&gt; [2,]   NA    0    0</span></span>
<span><span class="co">#&gt; [3,]   NA   NA    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`2L:278_2L:268`</span></span>
<span><span class="co">#&gt;      [,1]      [,2]      [,3]</span></span>
<span><span class="co">#&gt; [1,]    0 0.2032066 0.5080164</span></span>
<span><span class="co">#&gt; [2,]   NA 0.1806280 0.4515701</span></span>
<span><span class="co">#&gt; [3,]   NA        NA 0.2822313</span></span></code></pre></div>
<p>If is null operation.fun return values of the selected area without NA.</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/GetQuantif.html">GetQuantif</a></span><span class="op">(</span></span>
<span>  matrices.lst  <span class="op">=</span> <span class="va">oriented_first100_interactions_RFmatrix_ctrl.lst</span>,</span>
<span>  area.fun      <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">matrice.mtx</span><span class="op">)</span><span class="op">{</span><span class="va">matrice.mtx</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fl">6</span>,<span class="fl">4</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">}</span>,</span>
<span>  operation.fun <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`2L:74_2L:77`</span></span>
<span><span class="co">#&gt; [1] 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`2L:115_2L:107`</span></span>
<span><span class="co">#&gt; [1] 0.0000000 0.0000000 0.0000000 0.1671591 0.2228788 0.1857323</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`2L:121_2L:107`</span></span>
<span><span class="co">#&gt; [1] 0.3009771 0.7871710 0.3403983 1.2376943 0.5352191 0.0000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`2L:121_2L:117`</span></span>
<span><span class="co">#&gt; [1] 0.6591566 0.5355647 0.4351463 0.4119729 0.3347280 0.2574830</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`2L:274_2L:268`</span></span>
<span><span class="co">#&gt; [1] 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`2L:278_2L:268`</span></span>
<span><span class="co">#&gt; [1] 0.0000000 0.2032066 0.1806280 0.5080164 0.4515701 0.2822313</span></span></code></pre></div>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="aggregations">Aggregations<a class="anchor" aria-label="anchor" href="#aggregations"></a>
</h2>
<div class="section level3">
<h3 id="tips-6">Tips<a class="anchor" aria-label="anchor" href="#tips-6"></a>
</h3>
<ol style="list-style-type: decimal">
<li>When you perform a classical aggregation, you could use any of <code>matrices.lst</code> or <code>ctrlMatrices.lst</code> parameters</li>
<li>If <code>rm0.bln</code> is <code>TRUE</code> all zeros in matrices list are replace by NA.</li>
<li>This Function keep attributes of the matrices list and add some news:</li>
</ol>
<ul>
<li>totalMatrixNumber: The total number of matrices.<br>
</li>
<li>filteredMatrixNumber: The number of matrices that use for aggregate (after distance filtering).<br>
</li>
<li>minimalDistance: The minimal distance between anchor and bait need to keep a matrix before aggregation.<br>
</li>
<li>maximalDistance: The maximal distance between anchor and bait need to keep a matrix before aggregation.<br>
</li>
<li>aggregationMethod: The function apply to each pixel to obtain the aggregation.<br>
</li>
<li>zeroRemoved: A Boolean that indicate if zeros have been replaced by NA.</li>
</ul>
<p>When you perfomr differential aggregation there are some supplementary attributes.</p>
<ul>
<li>correctedFact: The value that is add to the condition to delete some noise. It’s compute by the median difference between condition and control in an background area (e.g upper right corner in matrices).</li>
<li>matrices: The list of matrices.
<ul>
<li>agg: Aggregation of the condition.<br>
</li>
<li>aggCtrl: Aggregation of the control.<br>
</li>
<li>aggCorrected: Aggregation of the condition corrected with correctedFact.<br>
</li>
<li>aggDelta: the difference between the aggregated matrix of the condition and the aggregated matrix of the control.<br>
</li>
<li>aggCorrectedDelta: the difference between the aggregated matrix of the condition corrected with correctedFact and the aggregated matrix of the control.</li>
</ul>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="classic-aggregations">Classic Aggregations<a class="anchor" aria-label="anchor" href="#classic-aggregations"></a>
</h3>
<div class="section level4">
<h4 id="preregistered-function">Preregistered function<a class="anchor" aria-label="anchor" href="#preregistered-function"></a>
</h4>
<p>Like the <code>GetQuantif</code> function, the aggregation have some preregistred function like <code>sum</code>, <code>mean</code> or <code>median</code>. See Genomic2DTK::Aggregation for more details.</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">agg_sum.mtx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Aggregation.html">Aggregation</a></span><span class="op">(</span></span>
<span>  matrices.lst <span class="op">=</span> <span class="va">oriented_first100_interactions_RFmatrix_ctrl.lst</span>, </span>
<span>  agg.fun      <span class="op">=</span> <span class="st">"sum"</span>,</span>
<span>  rm0.bln      <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Verification with extraction of one value</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">agg_sum.mtx</span><span class="op">[</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 21.63697</span></span></code></pre></div>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/GetQuantif.html">GetQuantif</a></span><span class="op">(</span></span>
<span>  matrices.lst <span class="op">=</span> <span class="va">oriented_first100_interactions_RFmatrix_ctrl.lst</span>,</span>
<span>  area.fun     <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">matrice.mtx</span><span class="op">)</span><span class="op">{</span><span class="va">matrice.mtx</span><span class="op">[</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">]</span><span class="op">}</span>,</span>
<span>  operation.fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">area.num</span><span class="op">)</span><span class="op">{</span><span class="va">area.num</span><span class="op">}</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span>na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 21.63697</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="custom-function">Custom function<a class="anchor" aria-label="anchor" href="#custom-function"></a>
</h4>
<p>Here we will used a custom function. This function must return an unique value for all pixels_ij of the matrices.</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">agg_mean.mtx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Aggregation.html">Aggregation</a></span><span class="op">(</span></span>
<span>  matrices.lst <span class="op">=</span> <span class="va">oriented_first100_interactions_RFmatrix_ctrl.lst</span>,</span>
<span>  agg.fun      <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">}</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Verification with extraction of one value</p>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">agg_mean.mtx</span><span class="op">[</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 0.2163697</span></span></code></pre></div>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/GetQuantif.html">GetQuantif</a></span><span class="op">(</span></span>
<span>  matrices.lst <span class="op">=</span> <span class="va">oriented_first100_interactions_RFmatrix_ctrl.lst</span>,</span>
<span>  area.fun     <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">matrice.mtx</span><span class="op">)</span><span class="op">{</span><span class="va">matrice.mtx</span><span class="op">[</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">]</span><span class="op">}</span>,</span>
<span>  operation.fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">area.num</span><span class="op">)</span><span class="op">{</span><span class="va">area.num</span><span class="op">}</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span>na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.2163697</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="distance-constraint">Distance constraint<a class="anchor" aria-label="anchor" href="#distance-constraint"></a>
</h4>
<p>You could add distance constraint, in this case the function will agregate all matrices that have a distance between anchor and bait superior or equal to the <code>minDist</code> parameter and inferior or equal to the <code>maxDist</code> parameter</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">agg_dist.mtx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Aggregation.html">Aggregation</a></span><span class="op">(</span></span>
<span>  matrices.lst <span class="op">=</span> <span class="va">oriented_first100_interactions_RFmatrix_ctrl.lst</span>,</span>
<span>  minDist      <span class="op">=</span> <span class="fl">9000</span>,</span>
<span>  maxDist      <span class="op">=</span> <span class="fl">11000</span>,</span>
<span>  agg.fun      <span class="op">=</span> <span class="st">"sum"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Verification with extraction of one value</p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">agg_dist.mtx</span><span class="op">[</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt;      V97 </span></span>
<span><span class="co">#&gt; 2.674181</span></span>
<span><span class="va">quantif.num</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GetQuantif.html">GetQuantif</a></span><span class="op">(</span></span>
<span>  matrices.lst <span class="op">=</span> <span class="va">oriented_first100_interactions_RFmatrix_ctrl.lst</span>,</span>
<span>  area.fun     <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">matrice.mtx</span><span class="op">)</span><span class="op">{</span><span class="va">matrice.mtx</span><span class="op">[</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">]</span> <span class="op">}</span>,</span>
<span>  operation.fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">area.num</span><span class="op">)</span><span class="op">{</span><span class="va">area.num</span><span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">ndx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">quantif.num</span><span class="op">)</span><span class="op">$</span><span class="va">interactions</span><span class="op">$</span><span class="va">distance</span> <span class="op">&gt;=</span> <span class="fl">9000</span> <span class="op">&amp;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">quantif.num</span><span class="op">)</span><span class="op">$</span><span class="va">interactions</span><span class="op">$</span><span class="va">distance</span> <span class="op">&lt;=</span> <span class="fl">11000</span></span>
<span>  <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">quantif.num</span><span class="op">)</span><span class="op">[</span><span class="va">ndx</span><span class="op">]</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2.674181</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="differential-aggregation">Differential Aggregation<a class="anchor" aria-label="anchor" href="#differential-aggregation"></a>
</h3>
<p>With the <code>Aggregation</code> function you also could perform differential aggregation. There is two kind of differential that the function perform:</p>
<ol style="list-style-type: decimal">
<li>The canonical differences where the difference is perform at each matrix level, i.e the function perform the difference of matrices that have the same name in the two list and then aggregate the differential matrices list.<br>
</li>
<li>The second kind of differential is at the aggregated level, i.e the function perform the aggregation of the two condition at this step it’s possible to perform a correction to avoid noise on the aggregated matrix by adding a correction factor calculated in an background area (e.g upper right corner in matrices). Then the function perform the difference of the two aggregated and possibly corrected matrices. This second kind is store in attributes and is called <strong>DeltaAggregated</strong>.</li>
</ol>
<p>When the number of matrices is not too high (few hundreds) you may want perform statistical test (Warning it’s very memmory conssuming).</p>
<div class="section level4">
<h4 id="preparation-of-matrices-list">Preparation of matrices list<a class="anchor" aria-label="anchor" href="#preparation-of-matrices-list"></a>
</h4>
<ol style="list-style-type: decimal">
<li>Preparation of Control matrices list condition<br><strong>Filtration</strong>
</li>
</ol>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">first100_target.lst</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  submatrix.name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">interactions_RFmatrix_ctrl.lst</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">]</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">first100_interactions_RFmatrix_ctrl.lst</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/FilterInteractions.html">FilterInteractions</a></span><span class="op">(</span></span>
<span>  matrices.lst  <span class="op">=</span> <span class="va">interactions_RFmatrix_ctrl.lst</span>,</span>
<span>  target.lst    <span class="op">=</span> <span class="va">first100_target.lst</span>,</span>
<span>  selection.fun <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><strong>Orientation</strong></p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oriented_first100_interactions_RFmatrix_ctrl.lst</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/OrienteMatrix.html">OrienteMatrix</a></span><span class="op">(</span><span class="va">first100_interactions_RFmatrix_ctrl.lst</span><span class="op">)</span></span></code></pre></div>
<p><strong>Quantifications for Verification</strong></p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">quantif_ctrl.num</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GetQuantif.html">GetQuantif</a></span><span class="op">(</span></span>
<span>  matrices.lst  <span class="op">=</span> <span class="va">oriented_first100_interactions_RFmatrix_ctrl.lst</span>,</span>
<span>  area.fun      <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">matrice.mtx</span><span class="op">)</span><span class="op">{</span><span class="va">matrice.mtx</span><span class="op">[</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">]</span><span class="op">}</span>,</span>
<span>  operation.fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">area.num</span><span class="op">)</span><span class="op">{</span><span class="va">area.num</span><span class="op">}</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Preparation of second matrices list in Beaf depleted condition. <strong>Extraction</strong>
</li>
</ol>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interactions_RFmatrix.lst</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ExtractSubmatrix.html">ExtractSubmatrix</a></span><span class="op">(</span></span>
<span>  feature.gn         <span class="op">=</span> <span class="va">interactions.gni</span>,</span>
<span>  hic.cmx_lst        <span class="op">=</span> <span class="va">HiC.cmx_lst</span>,</span>
<span>  referencePoint.chr <span class="op">=</span> <span class="st">"rf"</span>,</span>
<span>  matriceDim.num     <span class="op">=</span> <span class="fl">101</span>,</span>
<span>  verbose            <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><strong>Filtration</strong></p>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">first100_interactions_RFmatrix.lst</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/FilterInteractions.html">FilterInteractions</a></span><span class="op">(</span></span>
<span>  matrices.lst  <span class="op">=</span> <span class="va">interactions_RFmatrix.lst</span>,</span>
<span>  target.lst    <span class="op">=</span> <span class="va">first100_target.lst</span>,</span>
<span>  selection.fun <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><strong>Orientation</strong></p>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oriented_first100_interactions_RFmatrix.lst</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/OrienteMatrix.html">OrienteMatrix</a></span><span class="op">(</span><span class="va">first100_interactions_RFmatrix.lst</span><span class="op">)</span></span></code></pre></div>
<p><strong>Quantifications for Verification</strong></p>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">quantif.num</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GetQuantif.html">GetQuantif</a></span><span class="op">(</span></span>
<span>  matrices.lst  <span class="op">=</span> <span class="va">oriented_first100_interactions_RFmatrix.lst</span>,</span>
<span>  area.fun      <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">matrice.mtx</span><span class="op">)</span><span class="op">{</span><span class="va">matrice.mtx</span><span class="op">[</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">]</span><span class="op">}</span>,</span>
<span>  operation.fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">area.num</span><span class="op">)</span><span class="op">{</span><span class="va">area.num</span><span class="op">}</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="aggregate">Aggregate<a class="anchor" aria-label="anchor" href="#aggregate"></a>
</h4>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diffAggreg.mtx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Aggregation.html">Aggregation</a></span><span class="op">(</span></span>
<span>  ctrlMatrices.lst    <span class="op">=</span> <span class="va">oriented_first100_interactions_RFmatrix_ctrl.lst</span>,</span>
<span>  matrices.lst        <span class="op">=</span> <span class="va">oriented_first100_interactions_RFmatrix.lst</span>,</span>
<span>  minDist             <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  maxDist             <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  agg.fun             <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  rm0.bln             <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  diff.fun            <span class="op">=</span> <span class="st">"substraction"</span>,</span>
<span>  scaleCorrection.bln <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  correctionArea.lst  <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    i <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span>,</span>
<span>    j <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">72</span><span class="op">:</span><span class="fl">101</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>  statCompare.bln <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="display-aggregation">Display Aggregation<a class="anchor" aria-label="anchor" href="#display-aggregation"></a>
</h4>
<ol style="list-style-type: decimal">
<li>Print with all attributes</li>
</ol>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diffAggreg.mtx</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Print only matrice</li>
</ol>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/prmatrix.html" class="external-link">prmatrix</a></span><span class="op">(</span><span class="va">diffAggreg.mtx</span><span class="op">)</span></span>
<span><span class="va">diffAggreg.mtx</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">101</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">101</span><span class="op">]</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Differential at each submatrix level</li>
</ol>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diffAggreg.mtx</span><span class="op">[</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 0.03645583</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">quantif.num</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">quantif_ctrl.num</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.03645583</span></span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Aggregation of Control</li>
</ol>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">diffAggreg.mtx</span><span class="op">)</span><span class="op">$</span><span class="va">matrices</span><span class="op">$</span><span class="va">aggCtrl</span><span class="op">[</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 0.2163697</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">quantif_ctrl.num</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.2163697</span></span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Aggregation of Beaf depleted Condition</li>
</ol>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">diffAggreg.mtx</span><span class="op">)</span><span class="op">$</span><span class="va">matrices</span><span class="op">$</span><span class="va">agg</span><span class="op">[</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 0.2528255</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">quantif.num</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.2528255</span></span></code></pre></div>
<ol start="6" style="list-style-type: decimal">
<li>Differential at Aggregated level</li>
</ol>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">diffAggreg.mtx</span><span class="op">)</span><span class="op">$</span><span class="va">matrices</span><span class="op">$</span><span class="va">agg</span><span class="op">[</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">]</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">diffAggreg.mtx</span><span class="op">)</span><span class="op">$</span><span class="va">matrices</span><span class="op">$</span><span class="va">aggCtrl</span><span class="op">[</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 0.03645583</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">diffAggreg.mtx</span><span class="op">)</span><span class="op">$</span><span class="va">matrices</span><span class="op">$</span><span class="va">aggDelta</span><span class="op">[</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 0.03645583</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">quantif.num</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">quantif_ctrl.num</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.03645583</span></span></code></pre></div>
<ol start="7" style="list-style-type: decimal">
<li>ScaleFactor</li>
</ol>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">correctedFact.num</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">diffAggreg.mtx</span><span class="op">)</span><span class="op">$</span><span class="va">matrices</span><span class="op">$</span><span class="va">aggCtrl</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>,<span class="fl">72</span><span class="op">:</span><span class="fl">101</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">diffAggreg.mtx</span><span class="op">)</span><span class="op">$</span><span class="va">matrices</span><span class="op">$</span><span class="va">agg</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>,<span class="fl">72</span><span class="op">:</span><span class="fl">101</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">correctedFact.num</span></span>
<span><span class="co">#&gt; [1] -0.002255729</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">diffAggreg.mtx</span><span class="op">)</span><span class="op">$</span><span class="va">correctedFact</span></span>
<span><span class="co">#&gt; [1] -0.002255729</span></span></code></pre></div>
<ol start="8" style="list-style-type: decimal">
<li>Aggregation Classic Scaled</li>
</ol>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">diffAggreg.mtx</span><span class="op">)</span><span class="op">$</span><span class="va">matrices</span><span class="op">$</span><span class="va">aggCorrected</span><span class="op">[</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 0.2505698</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">diffAggreg.mtx</span><span class="op">)</span><span class="op">$</span><span class="va">matrices</span><span class="op">$</span><span class="va">agg</span><span class="op">[</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">]</span> <span class="op">+</span> <span class="va">correctedFact.num</span></span>
<span><span class="co">#&gt; [1] 0.2505698</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">quantif.num</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="va">correctedFact.num</span></span>
<span><span class="co">#&gt; [1] 0.2505698</span></span></code></pre></div>
<ol start="9" style="list-style-type: decimal">
<li>Differential at Aggregated level between Aggregation Classic Scaled and Control</li>
</ol>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">diffAggreg.mtx</span><span class="op">)</span><span class="op">$</span><span class="va">matrices</span><span class="op">$</span><span class="va">agg</span><span class="op">[</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">]</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">diffAggreg.mtx</span><span class="op">)</span><span class="op">$</span><span class="va">matrices</span><span class="op">$</span><span class="va">aggCtrl</span><span class="op">[</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">]</span> <span class="op">+</span> <span class="va">correctedFact.num</span></span>
<span><span class="co">#&gt; [1] 0.0342001</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">diffAggreg.mtx</span><span class="op">)</span><span class="op">$</span><span class="va">matrices</span><span class="op">$</span><span class="va">aggCorrectedDelta</span><span class="op">[</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 0.0342001</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">quantif.num</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">quantif_ctrl.num</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="va">correctedFact.num</span></span>
<span><span class="co">#&gt; [1] 0.0342001</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="aggregations-plots">Aggregations plots<a class="anchor" aria-label="anchor" href="#aggregations-plots"></a>
</h2>
<div class="section level3">
<h3 id="preparation-of-aggregated-matrices">Preparation of aggregated matrices<a class="anchor" aria-label="anchor" href="#preparation-of-aggregated-matrices"></a>
</h3>
<ol style="list-style-type: decimal">
<li>Control aggregation</li>
</ol>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oriented_interactions_RFmatrix_ctrl.lst</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/OrienteMatrix.html">OrienteMatrix</a></span><span class="op">(</span><span class="va">interactions_RFmatrix_ctrl.lst</span><span class="op">)</span></span>
<span><span class="va">aggreg.mtx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Aggregation.html">Aggregation</a></span><span class="op">(</span></span>
<span>    ctrlMatrices.lst<span class="op">=</span><span class="va">oriented_interactions_RFmatrix_ctrl.lst</span>,</span>
<span>    agg.fun<span class="op">=</span><span class="st">"mean"</span>,</span>
<span>    rm0.bln<span class="op">=</span><span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">aggreg.mtx</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">""</span>,<span class="fl">33</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"*"</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">""</span>,<span class="fl">31</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"*"</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">""</span>,<span class="fl">33</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">aggreg.mtx</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">""</span>,<span class="fl">33</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"*"</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">""</span>,<span class="fl">31</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"*"</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">""</span>,<span class="fl">33</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Differential aggregation</li>
</ol>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oriented_interactions_RFmatrix.lst</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/OrienteMatrix.html">OrienteMatrix</a></span><span class="op">(</span><span class="va">interactions_RFmatrix.lst</span><span class="op">)</span></span>
<span><span class="va">diffAggreg.mtx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Aggregation.html">Aggregation</a></span><span class="op">(</span></span>
<span>    ctrlMatrices.lst    <span class="op">=</span> <span class="va">oriented_interactions_RFmatrix_ctrl.lst</span>,</span>
<span>    matrices.lst        <span class="op">=</span> <span class="va">oriented_interactions_RFmatrix.lst</span>,</span>
<span>    minDist             <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    maxDist             <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    agg.fun             <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>    rm0.bln             <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    diff.fun            <span class="op">=</span> <span class="st">"log2+1"</span>,</span>
<span>    scaleCorrection.bln <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    correctionArea.lst  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> i<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span> , j<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">72</span><span class="op">:</span><span class="fl">101</span><span class="op">)</span> <span class="op">)</span>,</span>
<span>    statCompare.bln     <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">diffAggreg.mtx</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">""</span>,<span class="fl">33</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"*"</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">""</span>,<span class="fl">31</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"*"</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">""</span>,<span class="fl">33</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">diffAggreg.mtx</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">""</span>,<span class="fl">33</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"*"</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">""</span>,<span class="fl">31</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"*"</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">""</span>,<span class="fl">33</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plots">Plots<a class="anchor" aria-label="anchor" href="#plots"></a>
</h3>
<p>Below you could see the ggAPA function that create a ggplot object (ggplot2::geom_raster)</p>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggAPA.html">ggAPA</a></span><span class="op">(</span></span>
<span>    apa.mtx   <span class="op">=</span> <span class="va">aggreg.mtx</span>,</span>
<span>    title.chr <span class="op">=</span> <span class="st">"APA"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Genomic2DTK_files/figure-html/unnamed-chunk-144-1.png" width="672"></p>
<div class="section level4">
<h4 id="center">Center<a class="anchor" aria-label="anchor" href="#center"></a>
</h4>
<p>You could center the color scale.</p>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggAPA.html">ggAPA</a></span><span class="op">(</span></span>
<span>    apa.mtx    <span class="op">=</span> <span class="va">aggreg.mtx</span>,</span>
<span>    title.chr  <span class="op">=</span> <span class="st">"APA center on 0.2"</span>,</span>
<span>    center.num <span class="op">=</span> <span class="fl">0.2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Genomic2DTK_files/figure-html/unnamed-chunk-145-1.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="trimming">Trimming<a class="anchor" aria-label="anchor" href="#trimming"></a>
</h4>
<p>You could remove a percentage of value choose in upper tail, lower tail or both tails of the distribution.</p>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggAPA.html">ggAPA</a></span><span class="op">(</span></span>
<span>    apa.mtx      <span class="op">=</span> <span class="va">aggreg.mtx</span>,</span>
<span>    title.chr    <span class="op">=</span> <span class="st">"APA 30% trimmed on upper side"</span>,</span>
<span>    trimPrct.num <span class="op">=</span> <span class="fl">30</span>,</span>
<span>    bounds.chr   <span class="op">=</span> <span class="st">"upper"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in max(unlist(bounds.num_lst[1]), na.rm = TRUE): no non-missing</span></span>
<span><span class="co">#&gt; arguments to max; returning -Inf</span></span></code></pre></div>
<p><img src="Genomic2DTK_files/figure-html/unnamed-chunk-146-1.png" width="672"></p>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggAPA.html">ggAPA</a></span><span class="op">(</span></span>
<span>    apa.mtx      <span class="op">=</span> <span class="va">aggreg.mtx</span>,</span>
<span>    title.chr    <span class="op">=</span> <span class="st">"APA 30% trimmed on upper side"</span>,</span>
<span>    trimPrct.num <span class="op">=</span> <span class="fl">30</span>,</span>
<span>    bounds.chr   <span class="op">=</span> <span class="st">"lower"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in min(unlist(bounds.num_lst[2]), na.rm = TRUE): no non-missing</span></span>
<span><span class="co">#&gt; arguments to min; returning Inf</span></span></code></pre></div>
<p><img src="Genomic2DTK_files/figure-html/unnamed-chunk-146-2.png" width="672"></p>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggAPA.html">ggAPA</a></span><span class="op">(</span></span>
<span>    apa.mtx      <span class="op">=</span> <span class="va">aggreg.mtx</span>,</span>
<span>    title.chr    <span class="op">=</span> <span class="st">"APA 30% trimmed"</span>,</span>
<span>    trimPrct.num <span class="op">=</span> <span class="fl">30</span>,</span>
<span>    bounds.chr   <span class="op">=</span> <span class="st">"both"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Genomic2DTK_files/figure-html/unnamed-chunk-146-3.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="minmax">MinMax<a class="anchor" aria-label="anchor" href="#minmax"></a>
</h4>
<p>You could also define a minimal and/or a maximal value for the color scale. If you use a trimming with this options, the function will choose the more stringent options for each minimal and maximal value.</p>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggAPA.html">ggAPA</a></span><span class="op">(</span></span>
<span>    apa.mtx         <span class="op">=</span> <span class="va">aggreg.mtx</span>,</span>
<span>    title.chr       <span class="op">=</span> <span class="st">"APA [.15-.35]"</span>,</span>
<span>    minBoundary.num <span class="op">=</span> <span class="fl">0.15</span>,</span>
<span>    maxBoundary.num <span class="op">=</span> <span class="fl">0.35</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Genomic2DTK_files/figure-html/unnamed-chunk-147-1.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="colbreaks">ColBreaks<a class="anchor" aria-label="anchor" href="#colbreaks"></a>
</h4>
<p>You could define your own color breaks</p>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggAPA.html">ggAPA</a></span><span class="op">(</span></span>
<span>    apa.mtx       <span class="op">=</span> <span class="va">aggreg.mtx</span>,</span>
<span>    title.chr     <span class="op">=</span> <span class="st">"APA [.1, .2, .3, .4]"</span>,</span>
<span>    colBreaks.num <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>,<span class="fl">0.4</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Genomic2DTK_files/figure-html/unnamed-chunk-148-1.png" width="672"></p>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggAPA.html">ggAPA</a></span><span class="op">(</span></span>
<span>    apa.mtx       <span class="op">=</span> <span class="va">aggreg.mtx</span>,</span>
<span>    title.chr     <span class="op">=</span> <span class="st">"APA [.10, .13, .16, .20, .30, .40]"</span>,</span>
<span>    colBreaks.num <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.13</span>,<span class="fl">0.16</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>,<span class="fl">0.4</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Genomic2DTK_files/figure-html/unnamed-chunk-148-2.png" width="672"></p>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggAPA.html">ggAPA</a></span><span class="op">(</span></span>
<span>    apa.mtx       <span class="op">=</span> <span class="va">aggreg.mtx</span>,</span>
<span>    title.chr     <span class="op">=</span> <span class="st">"APA [.10, .20, .30, .33, .36, .40]"</span>,</span>
<span>    colBreaks.num <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>,<span class="fl">0.33</span>,<span class="fl">0.36</span>,<span class="fl">0.40</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Genomic2DTK_files/figure-html/unnamed-chunk-148-3.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="color-scale">Color Scale<a class="anchor" aria-label="anchor" href="#color-scale"></a>
</h4>
<p>Below we show the effect of the color scale biais.</p>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggAPA.html">ggAPA</a></span><span class="op">(</span></span>
<span>    apa.mtx    <span class="op">=</span> <span class="va">aggreg.mtx</span>,</span>
<span>    title.chr  <span class="op">=</span> <span class="st">"APA"</span>,</span>
<span>    colorScale <span class="op">=</span> <span class="st">"density"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Genomic2DTK_files/figure-html/unnamed-chunk-149-1.png" width="672"></p>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggAPA.html">ggAPA</a></span><span class="op">(</span></span>
<span>    apa.mtx     <span class="op">=</span> <span class="va">aggreg.mtx</span>,</span>
<span>    title.chr   <span class="op">=</span> <span class="st">"APA"</span>,</span>
<span>    bias.num    <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Genomic2DTK_files/figure-html/unnamed-chunk-149-2.png" width="672"></p>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggAPA.html">ggAPA</a></span><span class="op">(</span></span>
<span>    apa.mtx     <span class="op">=</span> <span class="va">aggreg.mtx</span>,</span>
<span>    title.chr   <span class="op">=</span> <span class="st">"APA"</span>,</span>
<span>    bias.num    <span class="op">=</span> <span class="fl">0.5</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Genomic2DTK_files/figure-html/unnamed-chunk-149-3.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="blurred">Blurred<a class="anchor" aria-label="anchor" href="#blurred"></a>
</h4>
<p>There is an option to apply a blurr on the heatmap that could remove some noise.</p>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggAPA.html">ggAPA</a></span><span class="op">(</span></span>
<span>    apa.mtx           <span class="op">=</span> <span class="va">aggreg.mtx</span>,</span>
<span>    title.chr         <span class="op">=</span> <span class="st">"APA"</span>,</span>
<span>    blurPass.num      <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    blurSd.num        <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>    lowerTri.num <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Genomic2DTK_files/figure-html/unnamed-chunk-150-1.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="changed-color">Changed color<a class="anchor" aria-label="anchor" href="#changed-color"></a>
</h4>
<p>here is an option to change the color of heatmap and color of NA values.</p>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggAPA.html">ggAPA</a></span><span class="op">(</span></span>
<span>    apa.mtx     <span class="op">=</span> <span class="va">aggreg.mtx</span>,</span>
<span>    title.chr   <span class="op">=</span> <span class="st">"APA"</span>,</span>
<span>    heatmap.col <span class="op">=</span> <span class="fu">SuperTK</span><span class="fu">::</span><span class="fu"><a href="https://nchanard.github.io/ColorTK/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span>,</span>
<span>    na.col      <span class="op">=</span> <span class="st">"black"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Genomic2DTK_files/figure-html/unnamed-chunk-151-1.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="modifications">Modifications<a class="anchor" aria-label="anchor" href="#modifications"></a>
</h4>
<p>Because the function return a ggplot object you could modify the ggplot object with ggplot2.</p>
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggAPA.html">ggAPA</a></span><span class="op">(</span></span>
<span>    apa.mtx     <span class="op">=</span> <span class="va">aggreg.mtx</span>,</span>
<span>    title.chr   <span class="op">=</span> <span class="st">"APA"</span>,</span>
<span><span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title    <span class="op">=</span> <span class="st">"New title"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"and subtitle"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Genomic2DTK_files/figure-html/unnamed-chunk-152-1.png" width="672"></p>
</div>
</div>
<div class="section level3">
<h3 id="all-in-one-function">All in one function<a class="anchor" aria-label="anchor" href="#all-in-one-function"></a>
</h3>
<p>Here is an all in one function that plot the matrix (and all matrices in attributes if it’s a differential aggregation) with different options and put it in a pdf.</p>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/PlotAPA.html">PlotAPA</a></span><span class="op">(</span></span>
<span>    apa.mtx                  <span class="op">=</span> <span class="va">diffAggreg.mtx</span>,</span>
<span>    trimPrct.num             <span class="op">=</span> <span class="fl">20</span>,</span>
<span>    minBoundary.num          <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>,</span>
<span>    center.num               <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    maxBoundary.num          <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    minConditionBoundary.num <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    maxConditionBoundary.num <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Genomic2DTK_files/figure-html/unnamed-chunk-153-1.png" width="700"><img src="Genomic2DTK_files/figure-html/unnamed-chunk-153-2.png" width="700"><img src="Genomic2DTK_files/figure-html/unnamed-chunk-153-3.png" width="700"><img src="Genomic2DTK_files/figure-html/unnamed-chunk-153-4.png" width="700"><img src="Genomic2DTK_files/figure-html/unnamed-chunk-153-5.png" width="700"><img src="Genomic2DTK_files/figure-html/unnamed-chunk-153-6.png" width="700"><img src="Genomic2DTK_files/figure-html/unnamed-chunk-153-7.png" width="700"><img src="Genomic2DTK_files/figure-html/unnamed-chunk-153-8.png" width="700"><img src="Genomic2DTK_files/figure-html/unnamed-chunk-153-9.png" width="700"><img src="Genomic2DTK_files/figure-html/unnamed-chunk-153-10.png" width="700"><img src="Genomic2DTK_files/figure-html/unnamed-chunk-153-11.png" width="700"><img src="Genomic2DTK_files/figure-html/unnamed-chunk-153-12.png" width="700"><img src="Genomic2DTK_files/figure-html/unnamed-chunk-153-13.png" width="700"><img src="Genomic2DTK_files/figure-html/unnamed-chunk-153-14.png" width="700"><img src="Genomic2DTK_files/figure-html/unnamed-chunk-153-15.png" width="700"><img src="Genomic2DTK_files/figure-html/unnamed-chunk-153-16.png" width="700"><img src="Genomic2DTK_files/figure-html/unnamed-chunk-153-17.png" width="700"><img src="Genomic2DTK_files/figure-html/unnamed-chunk-153-18.png" width="700"><img src="Genomic2DTK_files/figure-html/unnamed-chunk-153-19.png" width="700"><img src="Genomic2DTK_files/figure-html/unnamed-chunk-153-20.png" width="700"><img src="Genomic2DTK_files/figure-html/unnamed-chunk-153-21.png" width="700"><img src="Genomic2DTK_files/figure-html/unnamed-chunk-153-22.png" width="700"><img src="Genomic2DTK_files/figure-html/unnamed-chunk-153-23.png" width="700"><img src="Genomic2DTK_files/figure-html/unnamed-chunk-153-24.png" width="700"><img src="Genomic2DTK_files/figure-html/unnamed-chunk-153-25.png" width="700"><img src="Genomic2DTK_files/figure-html/unnamed-chunk-153-26.png" width="700"><img src="Genomic2DTK_files/figure-html/unnamed-chunk-153-27.png" width="700"><img src="Genomic2DTK_files/figure-html/unnamed-chunk-153-28.png" width="700"><img src="Genomic2DTK_files/figure-html/unnamed-chunk-153-29.png" width="700"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Nicolas Chanard .</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
